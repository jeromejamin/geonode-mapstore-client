(self.webpackChunkgeonode_mapstore_client=self.webpackChunkgeonode_mapstore_client||[]).push([[62933,55378,93546],{282385:(e,t,n)=>{"use strict";n.d(t,{nr:()=>r,B8:()=>o,LE:()=>i,$Z:()=>a,Cp:()=>l});var r="MAP_EDITOR:SHOW",o="MAP_EDITOR:HIDE",i="MAP_EDITOR:SAVE",a=function(e,t){return{type:r,owner:e,map:t}},l=function(e){return{type:o,owner:e}}},93848:(e,t,n)=>{"use strict";n.d(t,{Ai:()=>a,AQ:()=>l,Gl:()=>c,wd:()=>u,V9:()=>s,ih:()=>f,B8:()=>p,ww:()=>d,HP:()=>y,ri:()=>m,gd:()=>b,nr:()=>v,ty:()=>g,GZ:()=>h,O6:()=>O,Vt:()=>w,Ug:()=>S,Wp:()=>E,Ke:()=>j,Cp:()=>P,pW:()=>T,Gr:()=>C,gG:()=>k,oo:()=>I,Gh:()=>A,$G:()=>D,I5:()=>x,d8:()=>M,y5:()=>R,Az:()=>N,$Z:()=>L,Ql:()=>Z,Ul:()=>_,TU:()=>F,E0:()=>B,Yt:()=>U,Tk:()=>G});var r=n(513218),o=n.n(r),i=n(727693),a="MEDIA_EDITOR:ADDING_MEDIA",l="MEDIA_EDITOR:CHOOSE_MEDIA",c="MEDIA_EDITOR:EDITING_MEDIA",u="GEOSTORY:EDIT_MEDIA",s="MEDIA_EDITOR:LOAD_MEDIA",f="MEDIA_EDITOR:LOAD_MEDIA_SUCCESS",p="MEDIA_EDITOR:HIDE",d="MEDIA_EDITOR:SAVE_MEDIA",y="MEDIA_EDITOR:SET_MEDIA_TYPE",m="MEDIA_EDITOR:SET_MEDIA_SERVICE",b="MEDIA_EDITOR:SELECT_ITEM",v="MEDIA_EDITOR:SHOW",g="MEDIA_EDITOR:UPDATE_ITEM",h="MEDIA_EDITOR:IMPORT_IN_LOCAL",O="MEDIA_EDITOR:REMOVE_MEDIA",w="MEDIA_EDITOR:LOADING_SELECTED_MEDIA",S="MEDIA_EDITOR:LOADING_MEDIA_LIST",E="MEDIA_EDITOR:MEDIA_TYPE_DISABLE",j=function(e){return{type:l,resource:e}},P=function(){return{type:p}},T=function(e,t,n){return{type:s,params:e,mediaType:t,sourceId:n}},C=function(e){var t=e.mediaType,n=e.sourceId,r=e.params,o=e.resultData;return{type:f,mediaType:t,sourceId:n,params:r,resultData:o}},k=function(e){var t=e.type,n=e.source,r=e.data;return{type:d,mediaType:t,source:n,data:r}},I=function(e){return{type:"MEDIA_EDITOR:SAVE_MEDIA_SUCCESS",mediaType:e.mediaType,source:e.source,data:e.data,id:e.id}},A=function(e){return{type:b,id:e}},D=function(e){return{type:g,item:e,mode:arguments.length>1&&void 0!==arguments[1]?arguments[1]:"merge"}},x=function(e){return{type:a,adding:e}},M=function(e){return{type:m,id:o()(e)?e.value:e}},R=function(e,t){return{type:y,mediaType:e,selectedService:t}},N=function(e){return{type:c,editing:e}},L=function(e,t){return{type:v,owner:e,settings:t}},Z=function(e,t){var n=e.path,r=e.owner;return{type:u,path:n,owner:void 0===r?"geostory":r,sectionType:t}},_=function(e){var t=e.resource,n=e.sourceType,r=void 0===n?i.rR.GEOSTORY:n,o=e.owner;return{type:h,resource:t,sourceType:r,owner:void 0===o?"geostory":o}},F=function(e){return{type:O,mediaType:e,owner:arguments.length>1&&void 0!==arguments[1]?arguments[1]:"geostory"}},B=function(e){return{type:w,loading:e}},U=function(){return{type:S}},G=function(){return{type:E,mediaTypes:arguments.length>0&&void 0!==arguments[0]?arguments[0]:[]}}},262770:(e,t,n)=>{"use strict";n.d(t,{Z:()=>w});var r=n(124852),o=n.n(r),i=n(675263),a=n.n(i),l=n(441609),c=n.n(l),u=n(281763),s=n.n(u),f=n(490079);function p(e){return p="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},p(e)}function d(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function y(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,h(r.key),r)}}function m(e,t){return m=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},m(e,t)}function b(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function v(e){return v=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},v(e)}function g(e,t,n){return(t=h(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function h(e){var t=function(e,t){if("object"!==p(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!==p(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===p(t)?t:String(t)}var O=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&m(e,t)}(l,e);var t,n,r,i,a=(r=l,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=v(r);if(i){var n=v(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return function(e,t){if(t&&("object"===p(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return b(e)}(this,e)});function l(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,l),g(b(t=a.call(this,e)),"state",{containerWidth:0,legendContainerStyle:{overflowX:"auto"}}),g(b(t),"canShow",(function(e){return e.visibility||!t.props.showOnlyIfVisible})),g(b(t),"useLegendOptions",(function(){return!c()(t.props.node.legendOptions)&&s()(t.props.node.legendOptions.legendHeight)&&s()(t.props.node.legendOptions.legendWidth)})),g(b(t),"setOverflow",(function(){return t.useLegendOptions()&&t.props.node.legendOptions.legendWidth>t.state.containerWidth})),t.containerRef=o().createRef(),t}return t=l,n=[{key:"componentDidMount",value:function(){var e=this.containerRef.current&&this.containerRef.current.clientWidth;this.setState(function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?d(Object(n),!0).forEach((function(t){g(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):d(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({containerWidth:e},this.state))}},{key:"render",value:function(){var e=this.props.node||{},t=this.canShow(e)&&"wms"===e.type&&"background"!==e.group,n=t&&this.useLegendOptions();return t?o().createElement("div",{style:this.setOverflow()?this.state.legendContainerStyle:this.props.legendContainerStyle,ref:this.containerRef},o().createElement(f.Z,{style:this.setOverflow()?{}:this.props.legendStyle,layer:e,currentZoomLvl:this.props.currentZoomLvl,scales:this.props.scales,legendHeight:n&&this.props.node.legendOptions&&this.props.node.legendOptions.legendHeight||this.props.legendHeight||void 0,legendWidth:n&&this.props.node.legendOptions&&this.props.node.legendOptions.legendWidth||this.props.legendWidth||void 0,legendOptions:this.props.WMSLegendOptions,scaleDependent:this.props.scaleDependent,language:this.props.language})):null}}],n&&y(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),l}(o().Component);g(O,"propTypes",{node:a().object,legendContainerStyle:a().object,legendStyle:a().object,showOnlyIfVisible:a().bool,currentZoomLvl:a().number,scales:a().array,WMSLegendOptions:a().string,scaleDependent:a().bool,language:a().string,legendWidth:a().number,legendHeight:a().number}),g(O,"defaultProps",{legendContainerStyle:{},showOnlyIfVisible:!1,scaleDependent:!0});const w=O},490079:(e,t,n)=>{"use strict";n.d(t,{Z:()=>E});var r=n(472500),o=n.n(r),i=n(701469),a=n.n(i),l=n(727418),c=n.n(l),u=n(675263),s=n.n(u),f=n(124852),p=n.n(f),d=n(233044),y=n(805346);function m(e){return m="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},m(e)}function b(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,w(r.key),r)}}function v(e,t){return v=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},v(e,t)}function g(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function h(e){return h=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},h(e)}function O(e,t,n){return(t=w(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function w(e){var t=function(e,t){if("object"!==m(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!==m(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===m(t)?t:String(t)}var S=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&v(e,t)}(u,e);var t,n,r,i,l=(r=u,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=h(r);if(i){var n=h(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return function(e,t){if(t&&("object"===m(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return g(e)}(this,e)});function u(){var e;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,u);for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return O(g(e=l.call.apply(l,[this].concat(n))),"state",{error:!1}),O(g(e),"onImgError",(function(){e.setState((function(){return{error:!0}}))})),O(g(e),"getUrl",(function(e,t){if(e.layer&&"wms"===e.layer.type&&e.layer.url){var n=e.layer,r=t||a()(n.url)&&Math.floor(Math.random()*n.url.length),i=a()(n.url)?n.url[r]:n.url.replace(/[?].*$/g,""),l=o().parse(i),u=(0,d.clearNilValuesForParams)(n.params),s=c()({},{service:"WMS",request:"GetLegendGraphic",format:"image/png",height:e.legendHeight,width:e.legendWidth,layer:n.name,style:n.style||null,version:n.version||"1.3.0",SLD_VERSION:"1.1.0",LEGEND_OPTIONS:e.legendOptions},n.legendParams||{},e.language&&n.localizedLayerStyles?{LANGUAGE:e.language}:{},(0,d.addAuthenticationToSLD)(u||{},e.layer),u&&u.SLD_BODY?{SLD_BODY:u.SLD_BODY}:{},e.scales&&e.currentZoomLvl&&e.scaleDependent?{SCALE:Math.round(e.scales[e.currentZoomLvl])}:{});return(0,d.addAuthenticationParameter)(i,s),o().format({host:l.host,protocol:l.protocol,pathname:l.pathname,query:s})}return""})),O(g(e),"validateImg",(function(t){t.height<=1&&t.width<=2&&e.onImgError()})),e}return t=u,(n=[{key:"UNSAFE_componentWillReceiveProps",value:function(e){this.state.error&&this.getUrl(e,0)!==this.getUrl(this.props,0)&&this.setState((function(){return{error:!1}}))}},{key:"render",value:function(){var e=this;return!this.state.error&&this.props.layer&&"wms"===this.props.layer.type&&this.props.layer.url?p().createElement("img",{onError:this.onImgError,onLoad:function(t){return e.validateImg(t.target)},src:this.getUrl(this.props),style:this.props.style}):p().createElement(y.Z,{msgId:"layerProperties.legenderror"})}}])&&b(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),u}(p().Component);O(S,"propTypes",{layer:s().object,legendHeight:s().number,legendWidth:s().number,legendOptions:s().string,style:s().object,currentZoomLvl:s().number,scales:s().array,scaleDependent:s().bool,language:s().string}),O(S,"defaultProps",{legendHeight:12,legendWidth:12,legendOptions:"forceLabels:on",style:{maxWidth:"100%"},scaleDependent:!0});const E=S},542872:(e,t,n)=>{"use strict";n.d(t,{Z:()=>N});var r=n(124852),o=n.n(r),i=n(675263),a=n.n(i),l=n(107412),c=n(615402),u=n(805346),s=n(757588);function f(e){return f="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},f(e)}function p(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,v(r.key),r)}}function d(e,t){return d=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},d(e,t)}function y(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function m(e){return m=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},m(e)}function b(e,t,n){return(t=v(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function v(e){var t=function(e,t){if("object"!==f(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!==f(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===f(t)?t:String(t)}var g=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&d(e,t)}(l,e);var t,n,r,i,a=(r=l,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=m(r);if(i){var n=m(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return function(e,t){if(t&&("object"===f(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return y(e)}(this,e)});function l(){var e;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,l);for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return b(y(e=a.call.apply(a,[this].concat(n))),"onTouchStart",(function(t){var n=t.touches[0];e.startX=n.pageX,e.startY=n.pageY,e.setState({scrolling:!1})})),b(y(e),"onTouchMove",(function(t){var n=t.touches[0],r=t.currentTarget;if(e.state.scrolling)t.stopPropagation();else if(Math.abs(e.startY-n.pageY)>Math.abs(e.startX-n.pageX))t.stopPropagation();else{var o=e.startX<n.pageX?"left":"right";(r&&"left"===o&&r.clientWidth<r.scrollWidth&&0!==r.scrollLeft||r&&"right"===o&&r.clientWidth+r.scrollLeft!==r.scrollWidth)&&(e.setState({scrolling:!0}),t.stopPropagation())}})),b(y(e),"onTouchEnd",(function(){e.setState({scrolling:!1})})),b(y(e),"renderPage",(function(){var t="function"==typeof e.props.viewers?e.props.viewers:e.props.viewers[e.props.format];return t?o().createElement(t,{response:e.props.response,layer:e.props.layer}):null})),e}return t=l,(n=[{key:"render",value:function(){return o().createElement("div",{style:{width:"100%",height:"100%",overflowX:"auto"},onTouchMove:this.onTouchMove,onTouchStart:this.onTouchStart,onTouchEnd:this.onTouchEnd},this.renderPage())}}])&&p(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),l}(o().Component);b(g,"propTypes",{format:a().string,viewers:a().oneOfType([a().func,a().object]),response:a().oneOfType([a().string,a().object,a().node]),layer:a().object});var h=n(441609),O=n.n(h),w=n(531351),S=n.n(w),E=n(410240),j=n.n(E),P=n(902870);function T(e){return T="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},T(e)}function C(){return C=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},C.apply(this,arguments)}function k(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,M(r.key),r)}}function I(e,t){return I=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},I(e,t)}function A(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function D(e){return D=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},D(e)}function x(e,t,n){return(t=M(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function M(e){var t=function(e,t){if("object"!==T(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!==T(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===T(t)?t:String(t)}var R=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&I(e,t)}(f,e);var t,n,r,i,a=(r=f,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=D(r);if(i){var n=D(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return function(e,t){if(t&&("object"===T(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return A(e)}(this,e)});function f(){var e;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,f);for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return x(A(e=a.call.apply(a,[this].concat(n))),"getResponseProperties",(function(){var t=e.props.validator(e.props.format),n=e.props.responses.map((function(e){return void 0===e?{}:e})),r=e.props.renderValidOnly?t.getValidResponses(n):n,o=t.getNoValidResponses(e.props.responses),i=e.props.requests.length===o.length;return{validResponses:r,currResponse:e.getCurrentResponse(r[e.props.index]),emptyResponses:i,invalidResponses:o}})),x(A(e),"getCurrentResponse",(function(t){return e.props.validator(e.props.format).getValidResponses([t])})),x(A(e),"renderEmptyLayers",(function(){var t=e.getResponseProperties(),n=t.invalidResponses,r=t.emptyResponses;if(0===e.props.missingResponses&&r)return null;var i=0!==n.length;if(e.props.renderValidOnly||(i=i&&0===e.props.missingResponses),i){var a=n.map((function(e){return e.layerMetadata.title}));return e.props.showEmptyMessageGFI&&!e.props.disableInfoAlert?o().createElement(s.Alert,{bsStyle:"info"},o().createElement(u.Z,{msgId:"noInfoForLayers"}),o().createElement("b",null,a.join(", "))):null}return null})),x(A(e),"renderPage",(function(t){var n=e.props.viewers[e.props.format];return n?o().createElement(n,{response:t}):null})),x(A(e),"renderEmptyPages",(function(){var t=e.getResponseProperties().emptyResponses;return 0===e.props.missingResponses&&t?o().createElement(s.Alert,{bsStyle:"danger"},o().createElement("h4",null,o().createElement(c.Z,{msgId:"noFeatureInfo"}))):null})),x(A(e),"renderPages",(function(){var t=e.getResponseProperties().validResponses;return t.map((function(n,r){var i,a,c=n.response,u=n.layerMetadata,f=(0,P.Qo)(n,e.props),p=e.props.header;null!=u&&null!==(i=u.viewer)&&void 0!==i&&i.type&&(a=(0,l.gA)(u.viewer.type));var d=t.filter((function(e){return!j()(e.response,"no features were found")})).length;return o().createElement(s.Panel,{eventKey:r,key:r,collapsible:e.props.collapsible,header:p?o().createElement("span",null,o().createElement(p,C({size:d},e.props.headerOptions,u,{index:e.props.index,onNext:function(){return e.props.onNext()},onPrevious:function(){return e.props.onPrevious()}}))):null,style:e.props.style},o().createElement(g,{response:c,format:f,viewers:a||e.props.viewers,layer:u}))}))})),x(A(e),"containerStyle",(function(t){return O()(t)&&e.props.isMobile?{height:"100%"}:{display:O()(t)?"none":"block"}})),e}return t=f,(n=[{key:"shouldComponentUpdate",value:function(e){return e.responses!==this.props.responses||e.missingResponses!==this.props.missingResponses||e.index!==this.props.index}},{key:"render",value:function(){var e=this,t=this.props.container,n=this.getResponseProperties(),r=n.currResponse,i=n.emptyResponses,a=[this.renderEmptyLayers(),o().createElement(t,C({},this.props.containerProps,{onChangeIndex:function(t){e.props.setIndex(t)},ref:"container",index:this.props.index||0,key:"swiper",style:this.containerStyle(r),className:"swipeable-view"}),this.renderPages())];return a=this.props.isMobile?a:S()(a),o().createElement("div",{className:"mapstore-identify-viewer"},i?this.renderEmptyPages():a.map((function(e){return e})))}}])&&k(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),f}(o().Component);x(R,"propTypes",{format:a().string,collapsible:a().bool,requests:a().array,responses:a().array,missingResponses:a().number,container:a().oneOfType([a().object,a().func]),header:a().oneOfType([a().object,a().func]),headerOptions:a().object,validator:a().func,viewers:a().object,style:a().object,containerProps:a().object,index:a().number,onNext:a().func,onPrevious:a().func,onUpdateIndex:a().func,setIndex:a().func,showEmptyMessageGFI:a().bool,renderValidOnly:a().bool,loaded:a().bool,isMobile:a().bool,disableInfoAlert:a().bool}),x(R,"defaultProps",{format:(0,l.wR)(),responses:[],requests:[],missingResponses:0,collapsible:!1,headerOptions:{},container:s.Accordion,validator:l.Te,viewers:(0,l.Qm)(),style:{position:"relative",marginBottom:0},containerProps:{},showEmptyMessageGFI:!0,renderValidOnly:!1,onNext:function(){},onPrevious:function(){},setIndex:function(){},isMobile:!1,disableInfoAlert:!1});const N=R},11196:(e,t,n)=>{"use strict";n.d(t,{mI:()=>i,Yy:()=>a});var r=n(867076),o=n(107412),i=(0,r.withHandlers)({onNext:function(e){var t=e.index,n=void 0===t?0:t,r=e.setIndex,o=void 0===r?function(){}:r,i=e.validResponses,a=void 0===i?[]:i;return function(){o(Math.min(a.length-1,n+1))}},onPrevious:function(e){var t=e.index,n=e.setIndex,r=void 0===n?function(){}:n;return function(){r(Math.max(0,t-1))}}}),a=(0,r.defaultProps)({format:(0,o.wR)(),validator:o.Te})},81593:(e,t,n)=>{"use strict";n.d(t,{Z:()=>p});var r=n(124852),o=n(945338);function i(e){return i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i(e)}function a(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function l(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?a(Object(n),!0).forEach((function(t){c(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):a(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function c(e,t,n){return(t=function(e){var t=function(e,t){if("object"!==i(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!==i(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===i(t)?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function u(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i,a,l=[],c=!0,u=!1;try{if(i=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=i.call(n)).done)&&(l.push(r.value),l.length!==t);c=!0);}catch(e){u=!0,o=e}finally{try{if(!c&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}(e,t)||s(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function s(e,t){if(e){if("string"==typeof e)return f(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?f(e,t):void 0}}function f(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}const p=function(e){var t,n=e.direction,i=void 0===n?"horizontal":n,a=e.deltaScroll,p=e.width,d=e.height,y=e.transition,m=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],b=u((0,r.useState)(0),2),v=b[0],g=b[1],h=u((0,r.useState)(0),2),O=h[0],w=h[1],S=(0,r.useRef)({x:0,y:0}),E=u((0,r.useState)(!1),2),j=E[0],P=E[1],T=u((0,r.useState)("start"),2),C=T[0],k=T[1],I=u((0,r.useState)(),2),A=I[0],D=I[1],x=(0,r.useRef)(),M=(0,r.useRef)({});function R(e,t){D("move:start");var n=x.current,r=n.parentNode,o=n.getBoundingClientRect(),a=r.getBoundingClientRect();if("horizontal"===i){var l=e+o.width;e<0&&l>a.width?(g(e),S.current.x=e,k("center")):e>=0?(g(0),S.current.x=0,k("start")):l<=a.width&&(g(a.width-o.width),S.current.x=a.width-o.width,k("end"))}if("vertical"===i){var c=t+o.height;t<0&&c>a.height?(w(t),S.current.y=t,k("center")):t>=0?(w(0),S.current.y=0,k("start")):c<=a.height&&(w(a.height-o.height),S.current.y=a.height-o.height,k("end"))}setTimeout((function(){D("move:end")}),y)}function N(){var e=x.current,t=e.parentNode,n=e.getBoundingClientRect(),r=t.getBoundingClientRect();return!("horizontal"===i&&r.width>=n.width||"vertical"===i&&r.height>=n.height)}(0,r.useEffect)((function(){function e(e){e.preventDefault();var t=N();return P(N()),t?R(S.current.x-(e.deltaY>0?a:-a),S.current.y-(e.deltaY>0?a:-a)):null}var t=N();P(t);var n=x.current.parentNode;return t&&R(S.current.x,S.current.y),t&&n&&n.addEventListener&&n.addEventListener("wheel",e),function(){t&&n&&n.removeEventListener&&n.removeEventListener("wheel",e)}}),[p,d].concat(function(e){if(Array.isArray(e))return f(e)}(t=m)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(t)||s(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()));var L=(0,o.QS)({onSwiping:function(e){e.event.stopPropagation();var t=N();return P(N()),t?R(v-e.deltaX*e.velocity,O-e.deltaY*e.velocity):null},trackTouch:!0,trackMouse:!0});function Z(e){var t=M.current[e];if(t){var n=x.current,r=(n&&n.parentNode).getBoundingClientRect(),o=t.getBoundingClientRect();if("horizontal"===i){var a=r.width,l=r.left,c=o.width,u=o.left,s=l+a,f=u+c;return l<=u&&s>=u||l<=f&&s>=f}}return!1}return{status:A,canSwipe:j,isStartControlActive:j&&("end"===C||"center"===C),isEndControlActive:j&&("start"===C||"center"===C),positionLabel:C,coordinates:{x:v,y:O},containerPropsHandlers:function(){var e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).style,t=void 0===e?{}:e;return l(l({},L),{},{style:l({position:"relative",overflow:"hidden",width:"100%",height:"100%"},t)})},contentPropsHandlers:function(){var e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).style,t=void 0===e?{}:e;return{ref:x,style:l(l(l(l({position:"absolute",display:"flex"},y&&{transition:"transform ".concat(y,"ms ease 0s")}),{},{flexDirection:"horizontal"===i?"row":"column"},j&&"horizontal"===i&&{transform:"translateX(".concat(v,"px)")}),j&&"vertical"===i&&{transform:"translateY(".concat(O,"px)")}),t)}},itemPropsHandlers:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.id,n=e.onClick;return l({key:t,ref:function(e){return e&&function(e,t){M.current=l(l({},M.current),{},c({},e,t))}(t,e)}},n?{onClick:n,tabindex:Z(t)?0:-1,onKeyDown:function(e){"Enter"===e.key&&n()}}:{tabindex:-1})},updateCoordinates:R,moveItemInViewById:function(e){var t=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}).margin,n=void 0===t?0:t,r=M.current[e];if(r){var o=x.current,a=(o&&o.parentNode).getBoundingClientRect(),l=r.getBoundingClientRect();if("horizontal"===i){var c=a.width,u=a.left,s=l.width,f=l.left;u<=f&&u+c>=f+s||R(-(f-o.getBoundingClientRect().left)+n,void 0)}}},moveToDeltaSize:function(e){R(v+e,O+e)}}}},240986:(e,t,n)=>{"use strict";n.d(t,{Z:()=>f});var r=n(124852),o=n(675263),i=n.n(o),a=n(986267),l=n(752043);function c(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var u={openlayers:{fit:function(e){var t,n=e.map,r=e.geometry,o=e.padding,i=e.geometryProjection,c=e.fixedZoom,u=e.maxZoom,s=e.duration,f=n.getView(),p=f.getProjection().getCode();if(2===r.length){var d=(0,a.reproject)(r,i,p),y=d.x,m=d.y;t=new l.Z([y,m])}else t=(0,a.reprojectBbox)(r,i,p);var b=o||{},v=b.top,g=void 0===v?0:v,h=b.right,O=void 0===h?0:h,w=b.bottom,S=void 0===w?0:w,E=b.left,j=void 0===E?0:E;f.fit(t,{padding:[g,O,S,j],maxZoom:c?f.getZoom():u,duration:s})}},leaflet:{fit:function(e){var t,n,r,o=e.map,i=e.geometry,l=e.padding,u=e.geometryProjection,s=e.fixedZoom,f=e.maxZoom,p=e.duration,d=s?o.getZoom():f,y=l.top,m=void 0===y?0:y,b=l.right,v=void 0===b?0:b,g=l.bottom,h=void 0===g?0:g,O=l.left,w=void 0===O?0:O;if(2===i.length){var S=(0,a.reproject)(i,u,"EPSG:4326"),E=S.x,j=S.y;t=[[j,E],[j,E]]}else{var P=(n=(0,a.reprojectBbox)(i,u,"EPSG:4326"),r=4,function(e){if(Array.isArray(e))return e}(n)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i,a,l=[],c=!0,u=!1;try{if(i=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=i.call(n)).done)&&(l.push(r.value),l.length!==t);c=!0);}catch(e){u=!0,o=e}finally{try{if(!c&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}(n,r)||function(e,t){if(e){if("string"==typeof e)return c(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?c(e,t):void 0}}(n,r)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),T=P[0],C=P[1],k=P[2];t=[[C,T],[P[3],k]]}o.flyToBounds(t,{paddingTopLeft:[w,m],paddingBottomRight:[v,h],maxZoom:d,animate:!!p,duration:p/1e3})}}};function s(e){var t=e.map,n=e.mapType,o=e.active,i=e.geometry,a=e.geometryProjection,l=void 0===a?"EPSG:4326":a,c=e.padding,s=e.maxZoom,f=e.fixedZoom,p=e.duration,d=(0,r.useRef)();return d.current=function(){t&&u[n]&&u[n].fit({map:t,geometry:i,padding:c,geometryProjection:l,maxZoom:s,fixedZoom:f,duration:p})},(0,r.useEffect)((function(){o&&i&&d.current()}),[i,o]),null}s.propTypes={id:i().string,map:i().object,mapType:i().string,active:i().bool,geometry:i().array,geometryProjection:i().string,padding:i().object,maxZoom:i().number,fixedZoom:i().bool,duration:i().number},s.defaultProps={geometryProjection:"EPSG:4326",padding:{top:0,right:0,bottom:0,left:0}};const f=s},743837:(e,t,n)=>{"use strict";n.d(t,{Z:()=>b});var r=n(124852),o=n.n(r),i=n(675263),a=n.n(i),l=n(706909);function c(e){return c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},c(e)}var u=["map","active","method","mapId","mapType","features","options","onChange"];function s(){return s=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},s.apply(this,arguments)}function f(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function p(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?f(Object(n),!0).forEach((function(t){d(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):f(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function d(e,t,n){return(t=function(e){var t=function(e,t){if("object"!==c(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!==c(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===c(t)?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function y(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function m(e){var t,n,i=e.map,a=e.active,c=e.method,f=e.mapId,d=e.mapType,m=e.features,b=e.options,v=e.onChange,g=function(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}(e,u),h=(t=(0,r.useState)(null),n=2,function(e){if(Array.isArray(e))return e}(t)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i,a,l=[],c=!0,u=!1;try{if(i=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=i.call(n)).done)&&(l.push(r.value),l.length!==t);c=!0);}catch(e){u=!0,o=e}finally{try{if(!c&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}(t,n)||function(e,t){if(e){if("string"==typeof e)return y(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?y(e,t):void 0}}(t,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),O=h[0],w=h[1];return(0,r.useEffect)((function(){w(a?"drawOrEdit":"clean")}),[a]),"openlayers"!==d?null:o().createElement(l.Z,s({},g,{map:i,drawOwner:f,drawStatus:O,drawMethod:c,features:m,options:p({drawEnabled:a,addClickCallback:!0,editEnabled:!0,featureProjection:"EPSG:4326",geodesic:!1,stopAfterDrawing:!1,transformToFeatureCollection:!0,translateEnabled:!1,useSelectedStyle:!0},b),onDrawingFeatures:v.bind(null,f)}))}m.propTypes={active:a().bool,method:a().string,features:a().array,onChange:a().func,options:a().object},m.defaultProps={active:!1,method:"Point",features:[],onChange:function(){},options:{}};const b=m},507848:(e,t,n)=>{"use strict";n.d(t,{Z:()=>a});var r=n(171703),o=n(22222),i=n(93152);const a=(0,r.connect)((0,o.P1)(i.$v,(function(e){return{mapType:e}})))},819983:(e,t,n)=>{"use strict";n.d(t,{Z:()=>d});var r=n(124852),o=n.n(r),i=n(675263),a=n.n(i),l=n(552259);function c(e){return c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},c(e)}function u(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function s(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?u(Object(n),!0).forEach((function(t){f(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):u(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function f(e,t,n){return(t=function(e){var t=function(e,t){if("object"!==c(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!==c(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===c(t)?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var p=function(e){return function(t){var n,i,a,c,u,f,p,d=(null==t||null===(n=t.map)||void 0===n?void 0:n.projection)||"EPSG:3857",y=(null==t||null===(i=t.map)||void 0===i||null===(a=i.mapOptions)||void 0===a||null===(c=a.view)||void 0===c?void 0:c.DPI)||null,m=null==t||null===(u=t.map)||void 0===u||null===(f=u.mapOptions)||void 0===f||null===(p=f.view)||void 0===p?void 0:p.scales,b=(0,r.useMemo)((function(){return m?(0,l.getResolutionsForScales)(m,d,y):null}),[m,d,y]),v=b?s(s({},t),{},{map:s(s({},t.map),{},{mapOptions:s(s({},t.map.mapOptions),{},{view:s(s({},t.map.mapOptions.view),{},{resolutions:b})})})}):t;return o().createElement(e,v)}};p.propTypes={Component:a().element};const d=p},393546:(e,t,n)=>{"use strict";n.d(t,{jF:()=>Ze,Fc:()=>Ae,EC:()=>Ne,C2:()=>Re,Cw:()=>Me,rm:()=>Le});var r=n(414293),o=n.n(r),i=n(92742),a=n.n(i),l=n(747037),c=n.n(l),u=n(701469),s=n.n(u),f=n(984596),p=n.n(f),d=n(91175),y=n.n(d),m=n(610928),b=n.n(m),v=n(313311),g=n.n(v),h=n(513218),O=n.n(h),w=n(421915),S=n(443143),E=n(986267),j=n(433506),P=n(281763),T=n.n(P),C=n(831219),k=n(162875),I=n(315565),A=n(898185),D=n(438097),x=n.n(D),M=j.Z.markers.extra,R=M.icons[0],N=M.icons[1],L=M.size[1],Z=j.Z.getGlyphs("fontawesome"),_=function(e,t){var n=e.highlight,r=e.rotation,o=void 0===r?0:r;return n?[new C.default({image:new k.default({anchor:[.5,t],rotation:o,anchorXUnits:"fraction",anchorYUnits:"pixels",src:x(),scale:.5})})]:[]},F=function(e,t){var n,r,o=null==Z?void 0:Z[null==e||null===(n=e.style)||void 0===n?void 0:n.iconGlyph],i="FontAwesome",a=2;return null!=e&&null!==(r=e.style)&&void 0!==r&&r.iconText&&(o=e.style.iconText,i="sans-serif",a=1.6),new I.default({rotation:t,text:o,font:"14px ".concat(i),offsetY:-L*a/3,fill:new A.default({color:"#FFFFFF"})})};const B={extra:{getIcon:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=o()(e.style&&e.style.rotation)?0:e.style.rotation;return[new C.default({image:new k.default({rotation:t,anchor:[12,12],anchorXUnits:"pixels",anchorYUnits:"pixels",src:N})}),new C.default({image:new k.default({rotation:t,src:R,anchor:[M.size[0]/2,M.size[1]],anchorXUnits:"pixels",anchorYUnits:"pixels",size:M.size,offset:[M.colors.indexOf(e.style.iconColor||"blue")*M.size[0],M.shapes.indexOf(e.style.iconShape||"circle")*M.size[1]]}),text:F(e,t)})].concat(_(e.style,2*(L+15)))}},standard:{getIcon:function(e){var t=e.style,n=e.iconAnchor,r=o()(t&&t.rotation)?0:t.rotation,i=t.iconAnchor||n,a=[new C.default({image:new k.default({anchor:i||[.5,1],anchorXUnits:t.anchorXUnits||(i||0===i?"pixels":"fraction"),anchorYUnits:t.anchorYUnits||(i||0===i?"pixels":"fraction"),size:s()(t.size)?t.size:T()(t.size)?[t.size,t.size]:void 0,rotation:r,anchorOrigin:t.anchorOrigin||"top-left",src:t.iconUrl||t.symbolUrlCustomized||t.symbolUrl})})];t.shadowUrl&&(a=[new C.default({image:new k.default({anchor:[12,41],anchorXUnits:"pixels",anchorYUnits:"pixels",src:t.shadowUrl})}),a[0]]);var l=s()(t.size)?t.size[1]:T()(t.size)?t.size:0;return l=l>32?l+.75*l:L+10,a.concat(_(t,l))}},html:{getIcon:function(){return null}}};var U=n(166287),G=n(409371),W=n(120767),z=n(752043),H=n(944538),V=n(882702),q=n(375875),Y=n.n(q),Q=n(903918),X=n.n(Q),K=n(51205),$=n.n(K),J=n(727418),ee=n.n(J),te=n(761868);function ne(e){return ne="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ne(e)}function re(e){return function(e){if(Array.isArray(e))return oe(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return oe(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?oe(e,t):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function oe(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function ie(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function ae(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ie(Object(n),!0).forEach((function(t){le(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ie(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function le(e,t,n){return(t=function(e){var t=function(e,t){if("object"!==ne(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!==ne(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===ne(t)?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var ce=[0,153,255,1],ue=new G.default({radius:5,fill:null,stroke:new W.default({color:"red",width:1})}),se=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.radius,n=void 0===t?5:t,r=e.fillColor,o=void 0===r?"green":r,i=e.applyToPolygon,a=void 0!==i&&i;return new C.default({image:new G.default({radius:n,fill:new A.default({color:o})}),geometry:function(e){var t=e.getGeometry(),n=t.getType();if(!a&&"Polygon"===n)return null;var r="Polygon"===n?t.getCoordinates()[0]:t.getCoordinates();return r.length>1?new z.Z(y()(r)):null}})},fe=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.radius,n=void 0===t?5:t,r=e.fillColor,o=void 0===r?"red":r,i=e.applyToPolygon,a=void 0!==i&&i;return new C.default({image:new G.default({radius:n,fill:new A.default({color:o})}),geometry:function(e){var t=e.getGeometry(),n=t.getType();if(!a&&"Polygon"===n)return null;var r="Polygon"===n?t.getCoordinates()[0]:t.getCoordinates();return new z.Z(r.length>3?r[r.length-("Polygon"===n?2:1)]:b()(r))}})},pe=function(){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return[se(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}),fe(e)]},de=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return new C.default({text:new I.default({offsetY:void 0!==e.offsetY?e.offsetY:-4*Math.sqrt(e.fontSize),textAlign:e.textAlign||"center",textBaseline:e.verticalAlign||"middle",text:t||"",font:e.font,fill:new A.default({color:(0,S.qq)(e.stroke||e.color||"#000000",e.opacity||1)}),stroke:e.labelOutlineColor?new W.default({color:(0,S.qq)(e.labelOutlineColor,e.labelOutlineOpacity||1),width:e.labelOutlineWidth||1}):n?new W.default({color:[255,255,255,1],width:2}):null,rotation:e.rotation?e.rotation*Math.PI/180:0}),image:n?new G.default({radius:5,fill:null,stroke:new W.default({color:(0,S.qq)(e.color||"#0000FF",e.opacity||1),width:e.weight||1})}):null})},ye={color:"#ffcc33",opacity:1,weight:3,fillColor:"#ffffff",fillOpacity:.2,radius:10},me={color:"#ffcc33",opacity:1,weight:3,fillColor:"#ffffff",fillOpacity:.2,editing:{fill:1}},be={color:"#ffcc33",opacity:1,weight:3,fillColor:"#ffffff",fillOpacity:.2,editing:{fill:1}},ve={Marker:{iconColor:"orange",iconShape:"circle",iconGlyph:"comment"},Text:{fontStyle:"normal",fontSize:"14",fontSizeUom:"px",fontFamily:"Arial",fontWeight:"normal",font:"14px Arial",textAlign:"center",color:"#000000",opacity:1},Circle:{color:"#ffcc33",opacity:1,weight:3,fillColor:"#ffffff",fillOpacity:.2},Point:ye,MultiPoint:ye,LineString:me,MultiLineString:me,Polygon:be,MultiPolygon:be},ge=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{color:"blue",width:3,lineDash:[6]};return{stroke:new W.default(e.style?e.style.stroke||{color:e.style.color||t.color,lineDash:c()(e.style.dashArray)&&a()(e.style.dashArray).split(" ")||t.lineDash,width:e.style.weight||t.width,lineCap:e.style.lineCap||"round",lineJoin:e.style.lineJoin||"round",lineDashOffset:e.style.dashOffset||0}:ae({},t))}},he=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{color:"rgba(0, 0, 255, 0.1)"};return{fill:new A.default(e.style?e.style.fill||{color:(0,S.qq)(e.style.fillColor,e.style.fillOpacity)||t.color}:ae({},t))}},Oe={Point:function(){return[new C.default({image:ue})]},LineString:function(e){return[new C.default(ee()({},ge(e,{color:"blue",width:3})))]},MultiLineString:function(e){return[new C.default(ee()({},ge(e,{color:"blue",width:3})))]},MultiPoint:function(){return[new C.default({image:ue})]},MultiPolygon:function(e){return[new C.default(ee()({},ge(e),he(e)))]},Polygon:function(e){return[new C.default(ee()({},ge(e),he(e)))]},GeometryCollection:function(e){return[new C.default(ee()({},ge(e),he(e),{image:new G.default({radius:10,fill:null,stroke:new W.default({color:"magenta"})})}))]},Circle:function(){return[new C.default({stroke:new W.default({color:"red",width:2}),fill:new A.default({color:"rgba(255,0,0,0.2)"})})]},marker:function(e){return[new C.default({image:new k.default({anchor:[14,41],anchorXUnits:"pixels",anchorYUnits:"pixels",src:$()})}),new C.default({image:new k.default({anchor:[.5,1],anchorXUnits:"fraction",anchorYUnits:"fraction",src:X()}),text:new I.default({text:e.label,scale:1.25,offsetY:8,fill:new A.default({color:"#000000"}),stroke:new W.default({color:"#FFFFFF",width:2})})})]}},we=function(e,t){var n=e.getGeometry().getType();return Oe[n](t&&t.style&&t.style[n]&&{style:ae({},t.style[n])}||t||{})};function Se(e){if(e.style.iconUrl)return B.standard.getIcon(e);var t=e.style.iconLibrary||"extra";return B[t]?B[t].getIcon(e):null}var Ee=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{style:ve},n=arguments.length>2?arguments[2]:void 0,r=arguments.length>3?arguments[3]:void 0,i=arguments.length>4?arguments[4]:void 0,a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,l=t.style[e]||t.style;if("MultiLineString"===e||"LineString"===e){var c=[new C.default({stroke:t.style.useSelectedStyle?new W.default({color:[255,255,255,1],width:l.weight+2}):null}),new C.default(l?{stroke:new W.default(l&&l.stroke?l.stroke:{color:(0,S.qq)(t.style&&l.color||"#0000FF",l.opacity||1),lineDash:t.style.highlight?[10]:[0],width:l.weight||1}),image:n?ue:null}:{stroke:new W.default(ve[e]&&ve[e].stroke?ve[e].stroke:{color:(0,S.qq)(t.style&&ve[e].color||"#0000FF",ve[e].opacity||1),lineDash:t.style.highlight?[10]:[0],width:ve[e].weight||1})})],u=t.style.useSelectedStyle?pe({radius:l.weight,applyToPolygon:!0},{radius:l.weight,applyToPolygon:!0}):[];return[].concat(re(u),c)}if(("MultiPoint"===e||"Point"===e)&&(l.iconUrl||l.iconGlyph))return n?new C.default({image:ue}):Se({style:ae(ae({},l),{},{highlight:t.style.highlight||t.style.useSelectedStyle})});if("Circle"===e&&a)return[new C.default({stroke:t.style.useSelectedStyle?new W.default({color:[255,255,255,1],width:l.weight+4}):null}),new C.default({stroke:new W.default(l&&l.stroke?l.stroke:{color:t.style.useSelectedStyle?ce:(0,S.qq)(t.style&&l.color||"#0000FF",l.opacity||1),lineDash:t.style.highlight?[10]:[0],width:l.weight||1}),fill:new A.default(l.fill?l.fill:{color:(0,S.qq)(t.style&&l.fillColor||"#0000FF",l.fillOpacity||.2)})}),new C.default({image:t.style.useSelectedStyle?new G.default({radius:3,fill:new A.default(l.fill?l.fill:{color:ce})}):null,geometry:function(e){var t=e.getGeometry();if("Circle"===t.getType()){var n=t.getCenter();return new z.Z(n)}return null}})];if("Text"===e&&l.font)return[de(l,r[0],t.style.useSelectedStyle||t.style.highlight)];if("MultiPolygon"===e||"Polygon"===e){var s=[new C.default({stroke:t.style.useSelectedStyle?new W.default({color:[255,255,255,1],width:l.weight+2}):null}),new C.default({stroke:new W.default(l.stroke?l.stroke:{color:t.style.useSelectedStyle?ce:(0,S.qq)(t.style&&l.color||"#0000FF",o()(l.opacity)?1:l.opacity),lineDash:t.style.highlight?[10]:[0],width:l.weight||1}),image:n?ue:null,fill:new A.default(l.fill?l.fill:{color:(0,S.qq)(t.style&&l.fillColor||"#0000FF",o()(l.fillOpacity)?1:l.fillOpacity)})})],f=t.style.useSelectedStyle?pe({radius:l.weight,applyToPolygon:!0},{radius:l.weight,applyToPolygon:!0}):[];return[].concat(s,re(f))}return i};function je(e){return je="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},je(e)}function Pe(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Te(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Ce(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Te(Object(n),!0).forEach((function(t){ke(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Te(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function ke(e,t,n){return(t=function(e){var t=function(e,t){if("object"!==je(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!==je(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===je(t)?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Ie={white:[255,255,255,1],blue:[0,153,255,1],width:3},Ae=function(e){if((0,U.isMarkerStyle)(e)){if(e.iconUrl)return B.standard.getIcon({style:e});var t=e.iconLibrary||"extra";if(B[t])return B[t].getIcon({style:e})}return null};(0,U.registerGeometryFunctions)("centerPoint",(function(e){var t=e.getGeometry(),n=e.getProperties().isGeodesic,r=void 0!==n&&n,o=t.getExtent(),i=r?(0,w.qg)(o):t.getCenter&&t.getCenter()||[o[2]-o[0],o[3]-o[1]];return new z.Z(i)}),"Point"),(0,U.registerGeometryFunctions)("lineToArc",(function(e){var t=e.getGeometry().getType();if("LineString"===t||"MultiPoint"===t){var n=e.getGeometry().getCoordinates();return n=(0,E.transformLineToArcs)(n.map((function(e){var t=(0,E.reproject)(e,"EPSG:3857","EPSG:4326");return[t.x,t.y]}))),new H.Z(n.map((function(e){var t=(0,E.reproject)(e,"EPSG:4326","EPSG:3857");return[t.x,t.y]})))}return e.getGeometry()}),"LineString"),(0,U.registerGeometryFunctions)("startPoint",(function(e){var t=e.getGeometry(),n="Polygon"===t.getType()?t.getCoordinates()[0]:t.getCoordinates();return n.length>1?new z.Z(y()(n)):null}),"Point"),(0,U.registerGeometryFunctions)("endPoint",(function(e){var t=e.getGeometry(),n=t.getType(),r="Polygon"===n?t.getCoordinates()[0]:t.getCoordinates();return new z.Z(r.length>3?r[r.length-("Polygon"===n?2:1)]:b()(r))}),"Point");var De=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return e.geometry?function(t){var n=e.geometry||"centerPoint";return U.geometryFunctions[n].func(t)}:function(e){return e.getGeometry()}},xe=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{properties:{}},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],r=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return!!o()(e.filtering)||e.filtering}(t,e);if(r){var i=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,U.isStrokeStyle)(e)?new W.default(e.stroke&&O()(e.stroke)?e.stroke:{color:e.highlight?Ie.blue:(0,S.qq)(e.color||e.stroke||"#0000FF",o()(e.opacity)?1:e.opacity),width:o()(e.weight)?1:e.weight,lineDash:c()(e.dashArray)&&a()(e.dashArray).split(" ")||s()(e.dashArray)&&e.dashArray||[0],lineCap:e.lineCap||"round",lineJoin:e.lineJoin||"round",lineDashOffset:e.dashOffset||0}):null}(t),l=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,U.isFillStyle)(e)?new A.default(e.fill&&O()(e.fill)?e.fill:{color:(0,S.qq)(e.fillColor||"#0000FF",o()(e.fillOpacity)?1:e.fillOpacity)}):null}(t),u=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return(0,U.isCircleStyle)(e)?new G.default({stroke:t,fill:n,radius:e.radius||5}):null}(t,i,l);if((0,U.isMarkerStyle)(t))return Ae(t).map((function(e){return e.setGeometry(De(t)),e}));if((0,U.isSymbolStyle)(t))return B.standard.getIcon({style:t}).map((function(e){return e.setGeometry(De(t)),e}));var f=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=arguments.length>3?arguments[3]:void 0;return(0,U.isTextStyle)(e)?new I.default({fill:n,offsetY:e.offsetY||-4*Math.sqrt(e.fontSize),rotation:e.textRotationDeg?e.textRotationDeg/180*Math.PI:0,textAlign:e.textAlign||"center",text:e.label||r&&r.properties&&r.properties.valueText||"New",font:e.font||"Arial",stroke:e.highlight?new W.default({color:[255,255,255,1],width:2}):t,image:e.highlight?new G.default({radius:5,fill:null,stroke:new W.default({color:(0,S.qq)(e.color||"#0000FF",e.opacity||1),width:e.weight||1})}):null}):null}(t,i,l,e),p=t.zIndex;return[new C.default({geometry:De(t),image:u,text:f,stroke:!f&&!u&&i||null,fill:!f&&!u&&l||null,zIndex:p})].concat(e&&e.properties&&e.properties.canEdit&&!e.properties.isCircle?function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{radius:3,fillColor:"green",applyToPolygon:!0},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{radius:3,fillColor:"red",applyToPolygon:!0},r=[];return g()(e,(function(e){return"startPoint"===e.geometry&&e.filtering}))||r.push(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.radius,n=void 0===t?5:t,r=e.fillColor,o=void 0===r?"green":r,i=e.applyToPolygon,a=void 0!==i&&i;return new C.default({image:new G.default({radius:n,fill:new A.default({color:o})}),geometry:function(e){var t=e.getGeometry(),n=t.getType();if(!a&&"Polygon"===n)return null;var r="Polygon"===n?t.getCoordinates()[0]:t.getCoordinates();return r.length>1?new z.Z(y()(r)):null}})}(Ce({},t))),g()(e,(function(e){return"endPoint"===e.geometry&&e.filtering}))||r.push(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.radius,n=void 0===t?5:t,r=e.fillColor,o=void 0===r?"red":r,i=e.applyToPolygon,a=void 0!==i&&i;return new C.default({image:new G.default({radius:n,fill:new A.default({color:o})}),geometry:function(e){var t=e.getGeometry(),n=t.getType();if(!a&&"Polygon"===n)return null;var r="Polygon"===n?t.getCoordinates()[0]:t.getCoordinates();return new z.Z(r.length>3?r[r.length-("Polygon"===n?2:1)]:b()(r))}})}(Ce({},n))),r}(n):[])}return new C.default({})},Me=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{properties:{}},t=e.style;if(t){var n=s()(t)?t:p()(t);return n.reduce((function(t,r){return t.concat(xe(e,r,n))}),[])}return[]},Re=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];if(e.style&&e.style.url)return Y().get(e.style.url).then((function(t){return V.Promise.all([(0,U.getStyleParser)(e.style.format),(0,U.getStyleParser)("openlayers")]).then((function(e){var n,r,o=(r=2,function(e){if(Array.isArray(e))return e}(n=e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i,a,l=[],c=!0,u=!1;try{if(i=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=i.call(n)).done)&&(l.push(r.value),l.length!==t);c=!0);}catch(e){u=!0,o=e}finally{try{if(!c&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}(n,r)||function(e,t){if(e){if("string"==typeof e)return Pe(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Pe(e,t):void 0}}(n,r)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),i=o[0],a=o[1];return i.readStyle(t.data).then((function(e){return a.writeStyle(e)}))}))}));if(e.style&&"geostyler"===e.style.format)return(0,U.getStyleParser)("openlayers").then((function(t){return t.writeStyle(e.style.styleObj)}));var r=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];if(e.styleName&&!e.overrideOLStyle)return function(t){if("marker"===e.styleName)switch(t.getGeometry().getType()){case"Point":case"MultiPoint":return Oe.marker(e)}return Oe[e.styleName](e)};var r,i=e.nativeStyle,a=n,l=0,c=e.style&&e.style.type||(e.features&&e.features[0]&&e.features[0].geometry?e.features[0].geometry.type:void 0);if("FeatureCollection"===c||e.features&&e.features[0]&&"FeatureCollection"===e.features[0].type)return function(n){var o=this||n;r=o.getGeometry()&&o.getGeometry().getType();var i=o&&o.getProperties();i&&i.isCircle&&(r="Circle",l=i.radius),i&&i.isText&&(r="Text",a=[i.valueText]);var c=(0,te.t8)("style.useSelectedStyle",i.canEdit,e);return Ee(r,c,t,a,null,l)};if(e&&e.properties&&e.properties.isText)return r="Text",a=[e.properties.valueText],Ee(r,e,t,a,null,l);if(e&&e.properties&&e.properties.isCircle)return r="Circle",l=e.properties.radius,Ee(r,e,t,a,null,l);if(!i&&e.style){if(i={stroke:new W.default(e.style.stroke?e.style.stroke:{color:(0,S.qq)(e.style&&e.style.color||"#0000FF",o()(e.style.opacity)?1:e.style.opacity),lineDash:e.style.lineDash||(e.style.highlight?[10]:[0]),width:e.style.weight||1}),fill:new A.default(e.style.fill?e.style.fill:{color:(0,S.qq)(e.style&&e.style.fillColor||"#0000FF",o()(e.style.fillOpacity)?1:e.style.fillOpacity)})},"Point"!==c&&"MultiPoint"!==c||(i={image:new G.default(ee()({},i,{radius:e.style.radius||5}))}),e.style.iconUrl||e.style.iconGlyph){var u=Se(e);return function(t){var n=this||t;switch(r=n.getGeometry().getType()){case"Point":case"MultiPoint":return u;default:return we(n,e)}}}return i=new C.default(i),"GeometryCollection"===c?i=function(o){var i,a=this||o;r=a.getGeometry().getType();var l=a.get("textGeometriesIndexes")||[],c=a.get("circles")||[],u=a.get("textValues");return"GeometryCollection"===a.getGeometry().getType()?a.getGeometry().getGeometries().reduce((function(o,a,f){if(("Point"===(r=a.getType())||"MultiPoint"===r)&&l.length&&-1!==l.indexOf(f)){var p=Ee("Text",e,t,[u[l.indexOf(f)]]);return p.setGeometry(a),o.concat([p])}if("Polygon"===r&&c.length&&-1!==c.indexOf(f)){var d=Ee("Circle",e,t,[]);return d.setGeometry(a),o.concat([d])}if("Point"===r||"MultiPoint"===r)return i=Se({style:ae(ae({},e.style[r]),{},{highlight:e.style.highlight})}),o.concat(i.map((function(e){return e.setGeometry(a),e})));var y=Ee(r,e,t,n);return s()(y)?y.forEach((function(e){return e.setGeometry(a)})):y.setGeometry(a),o.concat([y])}),[]):"Point"===r||"MultiPoint"===r?(i=Se({style:ae(ae({},e.style[r]),{},{highlight:e.style.highlight})}),t?new C.default({image:ue,geometry:a.getGeometry()}):i.map((function(e){return e.setGeometry(a.getGeometry()),e}))):Ee(r,e,t,n)}:("Circle"===c&&(l=e.features&&e.features.length&&e.features[0].properties&&e.features[0].properties.radius||10),Ee(c,e,t,n,i,l))}return i||we}(e,t,n);return e.asPromise?new V.Promise((function(e){e(r)})):r},Ne=Se,Le=pe,Ze=ve},771335:(e,t,n)=>{"use strict";n.d(t,{Z:()=>h});var r=n(124852),o=n.n(r),i=n(675263),a=n.n(i),l=n(805346),c=n(913718),u=n(314068);function s(e){return s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},s(e)}function f(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,b(r.key),r)}}function p(e,t){return p=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},p(e,t)}function d(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function y(e){return y=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},y(e)}function m(e,t,n){return(t=b(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function b(e){var t=function(e,t){if("object"!==s(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!==s(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===s(t)?t:String(t)}var v={FORMAT:o().createElement(l.Z,{msgId:"map.errorFormat"}),SIZE:o().createElement(l.Z,{msgId:"map.errorSize"})},g=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&p(e,t)}(b,e);var t,n,r,i,a=(r=b,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=y(r);if(i){var n=y(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return function(e,t){if(t&&("object"===s(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return d(e)}(this,e)});function b(){var e;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,b);for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return m(d(e=a.call.apply(a,[this].concat(n))),"state",{}),m(d(e),"getThumbnailUrl",(function(){return e.props.map&&e.props.map.newThumbnail&&"NODATA"!==e.props.map.newThumbnail?decodeURIComponent(e.props.map.newThumbnail):null})),m(d(e),"getDataUri",(function(e,t){var n=e;if(n&&n.length>0){var r=n[0],o=new FileReader;return o.onload=function(e){return t(e.target.result,r.size)},o.readAsDataURL(r)}return t(null)})),m(d(e),"getThumbnailDataUri",(function(t){e.getDataUri(e.files,t)})),m(d(e),"generateUUID",(function(){var e=(new Date).getTime();return window.performance&&"function"==typeof window.performance.now&&(e+=performance.now()),"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(t){var n=(e+16*Math.random())%16|0;return e=Math.floor(e/16),("x"===t?n:3&n|8).toString(16)}))})),m(d(e),"processUpdateThumbnail",(function(t,n,r){var o=e.generateUUID(),i="THUMBNAIL";!e.props.map||r||!e.props.map.thumbnail||e.refs.imgThumbnail||n||e.deleteThumbnail(e.props.map.thumbnail,e.props.map.id,!0),e.props.map&&!r&&e.props.map.newThumbnail&&!e.refs.imgThumbnail&&n&&(e.deleteThumbnail(e.props.map.thumbnail,e.props.map.id,!1),e.props.onSaveAll(t,n,o,r,i,e.props.map.id)),e.props.map.newThumbnail&&r&&e.refs.imgThumbnail&&(e.deleteThumbnail(e.props.map.thumbnail,null,!1),e.props.onSaveAll(t,n,o,r,i,e.props.map.id)),e.props.map.newThumbnail&&!r&&e.refs.imgThumbnail&&e.props.onSaveAll(t,n,o,r,i,e.props.map.id),e.props.map.newThumbnail||r||e.refs.imgThumbnail||(e.props.map.thumbnail&&n&&e.deleteThumbnail(e.props.map.thumbnail,e.props.map.id,!1),e.props.onSaveAll(t,n,o,r,i,e.props.map.id))})),m(d(e),"updateThumbnail",(function(t,n){e.props.map.errors&&e.props.map.errors.length||e.getDataUri(e.files,(function(r){return e.processUpdateThumbnail(t,n,r),r}))})),m(d(e),"deleteThumbnail",(function(t,n){if(t&&-1!==t.indexOf("geostore")){var r=(0,c.C)(t);r&&e.props.onDeleteThumbnail(r,n)}})),e}return t=b,(n=[{key:"renderThumbnailErrors",value:function(){return this.props.thumbnailErrors&&this.props.thumbnailErrors.length>0?o().createElement("div",{className:"dropzone-errorBox alert-danger"},o().createElement("p",null,o().createElement(l.Z,{msgId:"map.error"})),this.props.thumbnailErrors.map((function(e){return o().createElement("div",{id:"error"+e,key:"error"+e,className:"error"+e},v[e])}))):null}},{key:"render",value:function(){var e=this;return o().createElement(u.Z,{ref:"imgThumbnail",thumbnail:this.getThumbnailUrl(),className:null,dropZoneProps:{className:"dropzone alert alert-info",rejectClassName:"alert-danger"},loading:this.props.loading,maxFileSize:this.props.maxFileSize,style:{pointerEvents:this.props.map.saving?"none":"auto"},label:this.props.withLabel&&o().createElement("label",{className:"control-label"},o().createElement(l.Z,{msgId:"map.thumbnail"})),ù:!0,message:o().createElement(o().Fragment,null,this.props.message,o().createElement("br",null),this.props.suggestion),error:this.renderThumbnailErrors(),onUpdate:function(t,n){var r;e.props.onError([],e.props.map.id),e.files=n,e.props.onUpdate(t,null==n||null===(r=n[0])||void 0===r?void 0:r.preview)},onError:function(t,n){e.props.onError(t,e.props.map.id),e.files=n,e.props.onUpdate(null,null)},onRemove:function(){e.files=null,e.props.onUpdate(null,null),e.props.onRemoveThumbnail(),e.props.onError([],e.props.map.id)}})}}])&&f(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),b}(o().Component);m(g,"propTypes",{glyphiconRemove:a().string,style:a().object,thumbnailErrors:a().array,loading:a().bool,withLabel:a().bool,map:a().object,maxFileSize:a().number,onDrop:a().func,onError:a().func,onUpdate:a().func,onSaveAll:a().func,onCreateThumbnail:a().func,onDeleteThumbnail:a().func,onRemoveThumbnail:a().func,message:a().oneOfType([a().string,a().element]),suggestion:a().oneOfType([a().string,a().element])}),m(g,"contextTypes",{messages:a().object}),m(g,"defaultProps",{loading:!1,withLabel:!0,glyphiconRemove:"remove-circle",maxFileSize:5e5,onDrop:function(){},onError:function(){},onUpdate:function(){},onSaveAll:function(){},onRemoveThumbnail:function(){},onCreateThumbnail:function(){},onDeleteThumbnail:function(){},message:o().createElement(l.Z,{msgId:"map.message"}),suggestion:o().createElement(l.Z,{msgId:"map.suggestion"}),map:{},thumbnailErrors:[]});const h=g},487320:(e,t,n)=>{"use strict";n.d(t,{Z:()=>w});var r=n(124852),o=n.n(r),i=n(675263),a=n.n(i),l=n(107412),c=n(743129),u=n(757588),s=n(352595);function f(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var p=function(e){var t,n,i=e.text,a=e.placement,l=e.bsStyle,c=e.left,p=e.top,d=e.title,y=e.glyph,m=e.id,b=(0,r.useRef)(),v=(t=(0,r.useState)(!1),n=2,function(e){if(Array.isArray(e))return e}(t)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i,a,l=[],c=!0,u=!1;try{if(i=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=i.call(n)).done)&&(l.push(r.value),l.length!==t);c=!0);}catch(e){u=!0,o=e}finally{try{if(!c&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}(t,n)||function(e,t){if(e){if("string"==typeof e)return f(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?f(e,t):void 0}}(t,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),g=v[0],h=v[1];return o().createElement("span",{className:"mapstore-info-popover",onMouseLeave:function(){return h(!1)}},o().createElement(u.Glyphicon,{onMouseEnter:function(){h(!0)},ref:function(e){b.current=e},className:"text-".concat(l),glyph:y}),o().createElement(s.Z,{placement:a,show:g,target:function(){return b.current}},o().createElement(u.Popover,{id:m,placement:a,positionLeft:c,positionTop:p,title:d},o().createElement("div",{style:{display:"flex"}},i))))};p.propTypes={id:a().string,title:a().string,text:a().string,glyph:a().string,bsStyle:a().string,placement:a().string,left:a().number,top:a().number,trigger:a().oneOfType([a().array,a().bool])},p.defaultProps={id:"",title:"",text:"",placement:"right",left:200,top:50,glyph:"question-sign",bsStyle:"info"};const d=p;var y=n(615402);function m(e){return m="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},m(e)}function b(){return b=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},b.apply(this,arguments)}function v(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function g(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?v(Object(n),!0).forEach((function(t){h(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):v(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function h(e,t,n){return(t=function(e){var t=function(e,t){if("object"!==m(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!==m(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===m(t)?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function O(e){var t=e.id,n=e.label,r=e.infoFormat,i=e.availableInfoFormat,a=e.popoverMessage,l=e.disabled,s=e.onInfoFormatChange,f=e.selectProps,p=Object.keys(i).reduce((function(e,t){return Object.keys(e).map((function(t){return e[t]})).some((function(e){return e===i[t]}))?e:g(g({},e),{},h({},t,i[t]))}),{}),m=Object.keys(p).map((function(e){return{value:p[e],label:e}})),v=o().createElement(o().Fragment,null,"   ",a&&o().createElement(d,{text:o().createElement(y.Z,{msgId:a})}),o().createElement(c.ZP,b({},f,{id:t,value:r,clearable:!1,disabled:l,options:m,onChange:function(e){return s(null==e?void 0:e.value)}})));return n?o().createElement(u.FormGroup,{bsSize:"small"},o().createElement(u.ControlLabel,null,n),v):v}O.propTypes={id:a().string,label:a().oneOfType([a().func,a().string,a().object]),availableInfoFormat:a().object,infoFormat:a().string,popoverMessage:a().string,onInfoFormatChange:a().func,disabled:a().bool,selectProps:a().object},O.defaultProps={id:"mapstore-feature-format-selector",availableInfoFormat:(0,l.eq)(),infoFormat:(0,l.wR)(),popoverMessage:"",onInfoFormatChange:function(){},selectProps:{}};const w=O},975480:(e,t,n)=>{"use strict";n.d(t,{Z:()=>i});var r=n(124852),o=n.n(r);const i=function(){var e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).style,t=void 0===e?{display:"inline-block"}:e;return o().createElement("div",{style:t,className:"mapstore-inline-loader"})}},82110:(e,t,n)=>{"use strict";n.d(t,{Z:()=>f});var r=n(124852),o=n.n(r),i=n(496259),a=n(532425);function l(e){return l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},l(e)}function c(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function u(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?c(Object(n),!0).forEach((function(t){s(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):c(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function s(e,t,n){return(t=function(e){var t=function(e,t){if("object"!==l(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!==l(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===l(t)?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const f=function(e){var t=e.width,n=e.height,r=e.className,l=void 0===r?"loader-container":r,c=e.contentStyle,s=void 0===c?{}:c;return o().createElement("div",{className:l},o().createElement(i.Z,null,(function(e){var r=e.width,i=void 0===r?200:r,l=e.height,c=void 0===l?200:l,f=t||(c>0?Math.min(i,c):i),p=n||(c>0?Math.min(i,c):i),d=Math.min(f,p);return o().createElement(a.Z,{size:d,style:u({padding:d/10,margin:"auto",display:"flex"},s)})})))}},352595:(e,t,n)=>{"use strict";n.d(t,{Z:()=>r});const r=(0,n(461365).Z)(n(757588).Overlay)},694745:(e,t,n)=>{"use strict";n.d(t,{Z:()=>b});var r=n(124852),o=n.n(r),i=n(294184),a=n.n(i),l=n(757588),c=n(807472),u=n(80717),s=n(867076),f=n(819081),p=n.n(f),d=n(975480),y={xs:" ms-xs",sm:" ms-sm",md:"",lg:" ms-lg"},m={className:{vertical:" ms-fullscreen-v",horizontal:" ms-fullscreen-h",full:" ms-fullscreen"},glyph:{expanded:{vertical:"resize-vertical",horizontal:"resize-horizontal",full:"resize-small"},collapsed:{vertical:"resize-vertical",horizontal:"resize-horizontal",full:"resize-full"}}};const b=(0,s.withState)("fullscreenState","onFullscreen",(function(e){var t=e.initialFullscreenState;return void 0===t?"collapsed":t}))((function(e){var t=e.show,n=void 0!==t&&t,r=e.loading,i=e.loadingText,s=e.onClose,f=void 0===s?function(){}:s,b=e.title,v=void 0===b?"":b,g=e.clickOutEnabled,h=void 0===g||g,O=e.showClose,w=void 0===O||O,S=e.disabledClose,E=void 0!==S&&S,j=e.showFullscreen,P=void 0!==j&&j,T=e.fullscreenType,C=void 0===T?"full":T,k=e.buttons,I=void 0===k?[]:k,A=e.size,D=void 0===A?"":A,x=e.bodyClassName,M=void 0===x?"":x,R=e.children,N=e.draggable,L=void 0!==N&&N,Z=e.fullscreenState,_=e.onFullscreen,F=e.fade,B=void 0!==F&&F,U=e.fitContent,G=e.modalClassName,W=void 0===G?"":G,z=e.dialogClassName,H=void 0===z?"":z,V=e.enableFooter,q=void 0===V||V,Y=y[D]||"",Q=P&&"expanded"===Z&&m.className[C]||"",X=n?o().createElement("div",{className:"modal-fixed ".concat(W," ")+(L?"ms-draggable":"")},o().createElement(c.Z,{id:"ms-resizable-modal",style:{display:"flex"},onClickOut:h?f:function(){},containerClassName:"ms-resizable-modal",draggable:L,modal:!0,className:a()("modal-dialog modal-content",Y,Q,H,{"ms-fit-content":U})},o().createElement("span",{role:"header"},o().createElement("h4",{className:"modal-title"},o().createElement("div",{className:"ms-title"},v),P&&m.className[C]&&o().createElement(l.Glyphicon,{className:"ms-header-btn",onClick:function(){return _("expanded"===Z?"collapsed":"expanded")},glyph:m.glyph[Z][C]}),w&&f&&o().createElement(l.Glyphicon,{glyph:"1-close",className:"ms-header-btn",onClick:f,disabled:E}))),o().createElement("div",{role:"body",className:M},R),q&&o().createElement("div",{style:{display:"flex"},role:"footer"},o().createElement("div",{className:"ms-resizable-modal-loading-spinner-container"},r?o().createElement(d.Z,null):null),o().createElement("div",{className:"ms-resizable-modal-loading-text"},r?i:null),o().createElement(u.Z,{buttons:I})))):null;return B?o().createElement(p(),{transitionName:"ms-resizable-modal-fade",transitionEnterTimeout:300,transitionLeaveTimeout:300},X):X}))},1036:(e,t,n)=>{"use strict";n.d(t,{Z:()=>i});var r=n(618446),o=n.n(r);const i=(0,n(867076).shouldUpdate)((function(e,t){return!o()(e.start,t.start)||e.disabled!==t.disabled}))(n(185552))},173014:(e,t,n)=>{"use strict";n.d(t,{Z:()=>u});var r=n(124852),o=n.n(r),i=n(867076),a=n(82110);function l(){return l=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},l.apply(this,arguments)}var c=function(e){var t=e.loading,n=e.isLoading;return t||n&&("function"==typeof n?n():!0===n)};const u=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:c,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:a.Z;return(0,i.branch)(e,(function(){return function(e){var r=e.loaderProps;return o().createElement(n,l({},t,r))}}))}},5993:(e,t,n)=>{"use strict";n.d(t,{Z:()=>y});var r=n(675263),o=n.n(r),i=n(984596),a=n.n(i),l=n(867076),c=n(86638),u=["locale"];function s(e){return s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},s(e)}function f(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function p(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?f(Object(n),!0).forEach((function(t){d(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):f(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function d(e,t,n){return(t=function(e){var t=function(e,t){if("object"!==s(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!==s(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===s(t)?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const y=function(e){return(0,l.compose)((0,l.getContext)({locale:o().string}),(0,l.mapProps)((function(t){var n=t.locale,r=function(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}(t,u);return p(p({},r),a()(e).reduce(function(e,t){return function(){var n=arguments.length>1?arguments[1]:void 0;return p(p({},arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}),{},d({},n,e[n]&&(0,c.MZ)(t,e[n])))}}(r,n),{}))})))}},979105:(e,t,n)=>{"use strict";n.d(t,{Z:()=>o});var r=n(867076);const o=function(e,t,n){return(0,r.branch)((function(){return!(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{})[t]}),(0,r.withState)(e,t,n))}},145869:(e,t,n)=>{"use strict";n.d(t,{Z:()=>y});var r=n(124852),o=n.n(r),i=n(675263),a=n.n(i);function l(e){return l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},l(e)}function c(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,p(r.key),r)}}function u(e,t){return u=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},u(e,t)}function s(e){return s=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},s(e)}function f(e,t,n){return(t=p(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function p(e){var t=function(e,t){if("object"!==l(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!==l(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===l(t)?t:String(t)}var d=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&u(e,t)}(f,e);var t,n,r,i,a=(r=f,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=s(r);if(i){var n=s(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return function(e,t){if(t&&("object"===l(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,e)});function f(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,f),a.apply(this,arguments)}return t=f,(n=[{key:"render",value:function(){var e=this;return o().createElement("label",{className:"mapstore-switch-btn ".concat(this.props.className)},o().createElement("input",{type:"checkbox",disabled:this.props.disabled,checked:this.props.checked,onChange:function(){return e.props.onChange(!e.props.checked)}}),o().createElement("span",{onClick:function(){return e.props.onClick(!e.props.checked)},className:"m-slider"}))}}])&&c(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),f}(o().Component);f(d,"propTypes",{disabled:a().bool,className:a().string,checked:a().bool,onChange:a().func,onClick:a().func}),f(d,"defaultProps",{className:"",checked:!1,onChange:function(){},onClick:function(){}});const y=d},857037:(e,t,n)=>{"use strict";n.d(t,{Z:()=>y});var r=n(124852),o=n.n(r),i=n(675263),a=n.n(i),l=n(24198),c=n(717621),u=n.n(c),s=n(290702);function f(){return f=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},f.apply(this,arguments)}function p(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function d(e){var t,n,i=e.value,a=e.format,c=e.onChangeColor,d=e.text,y=e.line,m=e.disabled,b=e.pickerProps,v=e.containerNode,g=e.onOpen,h=e.placement,O=(t=(0,r.useState)(),n=2,function(e){if(Array.isArray(e))return e}(t)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i,a,l=[],c=!0,u=!1;try{if(i=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=i.call(n)).done)&&(l.push(r.value),l.length!==t);c=!0);}catch(e){u=!0,o=e}finally{try{if(!c&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}(t,n)||function(e,t){if(e){if("string"==typeof e)return p(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?p(e,t):void 0}}(t,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),w=O[0],S=O[1],E=u()(i).toString();(0,r.useEffect)((function(){var e=w&&u()(w).toString();e&&E&&E!==e&&S(i)}),[E]);var j=(0,r.useRef)();j.current=function(e){g(e),e||m||!w||c(a?u()(w).toString(a):w)};var P,T,C=m?" ms-disabled":"";return o().createElement(s.Z,{disabled:m,onOpen:function(e){return j.current(e)},placement:h,containerNode:v,content:o().createElement(l.xS,f({},b,{className:"ms-sketch-picker",styles:{picker:{width:200,padding:"10px 10px 0",boxSizing:"initial"}},color:u()(w||i).toRgb(),onChange:function(e){return S(e.rgb)}}))},o().createElement("div",{className:"ms-color-picker".concat(C)},o().createElement("div",{className:"ms-color-picker-swatch",style:(P=w||i||"transparent",T=u()(P).toRgbString(),y?{boxSizing:"border-box",border:"4px solid ".concat(T),backgroundColor:"transparent"}:{color:"transparent"===P?"#000000":u().mostReadable(T,["#000000"],{includeFallbackColors:!0}).toHexString(),backgroundColor:T})},d)))}d.propTypes={value:a().oneOfType([a().string,a().shape({r:a().number,g:a().number,b:a().number,a:a().number})]),format:a().string,onChangeColor:a().func,text:a().string,line:a().bool,disabled:a().bool,pickerProps:a().object,containerNode:a().oneOfType([a().node,a().func]),onOpen:a().function,placement:a().string},d.defaultProps={disabled:!1,line:!1,onChangeColor:function(){},pickerProps:{},onOpen:function(){}};const y=d},212961:(e,t,n)=>{"use strict";n.d(t,{Z:()=>s});var r=n(124852),o=n.n(r),i=n(675263),a=n.n(i),l=n(757588),c=n(857037);function u(e){var t=e.color,n=e.format,r=e.line,i=e.onChangeColor,a=e.disableAlpha,u=e.containerNode,s=e.onOpen,f=e.disabled,p=e.presetColors,d=e.placement;return o().createElement("div",{className:"ms-color-selector"},o().createElement(c.Z,{text:o().createElement(l.Glyphicon,{glyph:"dropper"}),format:n,line:r,value:t,onChangeColor:i,pickerProps:{disableAlpha:a,presetColors:p},containerNode:u,disabled:f,onOpen:s,placement:d}))}u.propTypes={color:a().oneOfType([a().string,a().shape({r:a().number,g:a().number,b:a().number,a:a().number})]),format:a().string,line:a().bool,onChangeColor:a().func,disableAlpha:a().bool,containerNode:a().node,disabled:a().bool,onOpen:a().func,presetColors:a().array,placement:a().string},u.defaultProps={line:!1,onChangeColor:function(){},onOpen:function(){}};const s=u},290702:(e,t,n)=>{"use strict";n.d(t,{Z:()=>O});var r=n(124852),o=n.n(r),i=n(180307),a=n(974691),l=n.n(a),c=n(737275),u=n(623560),s=n.n(u);function f(e){return f="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},f(e)}var p=["open","onOpen"];function d(){return d=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},d.apply(this,arguments)}function y(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function m(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?y(Object(n),!0).forEach((function(t){b(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):y(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function b(e,t,n){return(t=function(e){var t=function(e,t){if("object"!==f(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!==f(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===f(t)?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function v(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i,a,l=[],c=!0,u=!1;try{if(i=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=i.call(n)).done)&&(l.push(r.value),l.length!==t);c=!0);}catch(e){u=!0,o=e}finally{try{if(!c&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}(e,t)||function(e,t){if(e){if("string"==typeof e)return g(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?g(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function g(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function h(e){var t=e.containerNode,n=void 0===t?function(){return document.querySelector("."+((0,c.u8)("themePrefix")||"ms2")+" > div")||document.body}:t,a=e.placement,u=e.content,f=e.children,p=e.open,d=e.onOpen,y=void 0===d?function(){}:d,b=e.disabled,g=10,h=s()(n)?n():n,O=(0,r.useRef)({picker:{opacity:0},arrow:{opacity:0},overlay:{}}),w=v((0,r.useState)(O.current),2),S=w[0],E=w[1],j=(0,r.useRef)(),P=(0,r.useRef)(),T=(0,r.useRef)(),C=(0,r.useCallback)((function(){var e,t,n,r,o,i;if(!p)return O.current;var c={picker:{},overlay:{backgroundColor:"rgba(0, 0, 0, 0.4)"},arrow:{opacity:0}};if("center"===a)return c;var u=null==j||null===(e=j.current)||void 0===e||null===(t=e.getBoundingClientRect)||void 0===t?void 0:t.call(e),s=null==P||null===(n=P.current)||void 0===n||null===(r=n.getBoundingClientRect)||void 0===r?void 0:r.call(n),f=null==T||null===(o=T.current)||void 0===o||null===(i=o.getBoundingClientRect)||void 0===i?void 0:i.call(o);if(u&&s&&f){var d,y,m,b,v=f.width,h=f.height,w=s.top,S=s.left,E=s.width,C=s.height,k=u.top,I=u.left,A=u.width,D=u.height,x=v+20<E,M=h+20<C,R={top:{filter:function(){return x&&k-w>h+g},styles:function(){var e=I+A/2-v/2-S;return{picker:{position:"absolute",top:k-h-g-w,left:l()(e,S+g,S+E-v-g)},overlay:{},arrow:{top:k+2,left:I+A/2,transform:"translate(-50%, -50%) rotateZ(270deg) translateX(50%)"}}}},right:{filter:function(){return M&&S+E-(I+A)>v+g},styles:function(){var e=k-h/2-w+D/2,t=I+A+g-S;return{picker:{position:"absolute",top:l()(e,w+g,w+C-h-g),left:t},overlay:{},arrow:{top:k+D/2,left:I+A-2,transform:"translate(-50%, -50%) rotateZ(0deg) translateX(50%)"}}}},bottom:{filter:function(){return x&&w+C-(k+D)>h+g},styles:function(){var e=I+A/2-v/2-S;return{picker:{position:"absolute",top:k+D+g-w,left:l()(e,S+g,S+E-v-g)},overlay:{},arrow:{top:k+D-2,left:I+A/2,transform:"translate(-50%, -50%) rotateZ(90deg) translateX(50%)"}}}},left:{filter:function(){return M&&I-S>v+g},styles:function(){var e=k-h/2-w+D/2,t=I-v-g-S;return{picker:{position:"absolute",top:l()(e,w+g,w+C-h-g),left:t},overlay:{},arrow:{top:k+D/2,left:I+2,transform:"translate(-50%, -50%) rotateZ(180deg) translateX(50%)"}}}}};if(null!=R&&null!==(d=R[a])&&void 0!==d&&null!==(y=d.filter)&&void 0!==y&&y.call(d))return null==R||null===(m=R[a])||void 0===m||null===(b=m.styles)||void 0===b?void 0:b.call(m);if("top"!==a&&R.top.filter())return R.top.styles();if("right"!==a&&R.right.filter())return R.right.styles();if("bottom"!==a&&R.bottom.filter())return R.bottom.styles();if("left"!==a&&R.left.filter())return R.left.styles()}return c}),[a,p]);(0,r.useEffect)((function(){E(C());var e=function(){return E(C())};return window.addEventListener("resize",e),function(){window.removeEventListener("resize",e)}}),[C]);var k=(0,r.useRef)();return k.current={open:p},(0,r.useEffect)((function(){function e(e){var t=T.current,n=j.current,r=e.target&&(t&&t.contains(e.target)||n&&n.contains(e.target));if(k.current.open&&!r){var o,i,a=e.clientX,l=e.clientY,c=(null==T||null===(o=T.current)||void 0===o||null===(i=o.getBoundingClientRect)||void 0===i?void 0:i.call(o))||{},u=c.left,s=c.top,f=c.width,p=c.height;void 0!==a&&void 0!==l&&!(a>=u&&a<=u+f&&l>=s&&l<=s+p)&&y(!1)}}return window.addEventListener("click",e,!0),window.addEventListener("wheel",e,!0),window.addEventListener("scroll",e,!0),function(){window.removeEventListener("click",e,!0),window.removeEventListener("wheel",e,!0),window.removeEventListener("scroll",e,!0)}}),[]),o().createElement(o().Fragment,null,o().createElement("div",{className:"ms-popover",ref:j},(0,r.cloneElement)(f,{onClick:function(e){b||(e.stopPropagation(),y(!p))}})),h&&p?(0,i.createPortal)(o().createElement("div",{className:"ms-popover-overlay",ref:P,style:m({position:"fixed",display:"flex",alignItems:"center",justifyContent:"center",width:"100%",height:"100%",top:0,left:0,pointerEvents:"none"},null==S?void 0:S.overlay)},o().createElement("div",{style:{position:"absolute",width:"100%",height:"100%",top:0,left:0}}),o().createElement("div",{ref:T,style:m({pointerEvents:"auto"},null==S?void 0:S.picker)},u),o().createElement("div",{className:"ms-popover-arrow",style:m({position:"absolute",borderTop:"".concat(12,"px solid transparent"),borderBottom:"".concat(12,"px solid transparent"),borderRight:"".concat(12,"px solid #ffffff"),filter:"drop-shadow(-4px 2px 4px rgba(0, 0, 0, 0.2))"},null==S?void 0:S.arrow)})),h):null)}const O=function(e){var t=e.open,n=e.onOpen,i=void 0===n?function(){}:n,a=function(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}(e,p),l=v((0,r.useState)(t),2),c=l[0],u=l[1];return o().createElement(h,d({},a,{open:c,onOpen:function(e){u(e),i(e)}}))}},75927:(e,t,n)=>{"use strict";n.d(t,{Z:()=>y});var r=n(513218),o=n.n(r),i=n(124852),a=n.n(i),l=n(757588),c=n(805346),u=n(815135);function s(e){return s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},s(e)}var f=["settings","element","tabs","activeTab","width","groups","isLocalizedLayerStylesEnabled","setActiveTab","onUpdateParams","onRetrieveLayerData","realtimeUpdate"];function p(){return p=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},p.apply(this,arguments)}var d=(0,u.Z)(l.NavItem);const y=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.settings,n=e.element,r=void 0===n?{}:n,i=e.tabs,u=void 0===i?[]:i,y=e.activeTab,m=e.width,b=e.groups,v=e.isLocalizedLayerStylesEnabled,g=e.setActiveTab,h=void 0===g?function(){}:g,O=e.onUpdateParams,w=void 0===O?function(){}:O,S=e.onRetrieveLayerData,E=void 0===S?function(){}:S,j=e.realtimeUpdate,P=function(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}(e,f);return a().createElement(l.Row,{key:"ms-toc-settings-navbar",className:"ms-row-tab"},a().createElement(l.Col,{xs:12},a().createElement(l.Nav,{bsStyle:"tabs",activeKey:y,justified:!0},u.map((function(e){return a().createElement(d,{key:"ms-tab-settings-"+e.id,tooltip:a().createElement(c.Z,{msgId:e.tooltipId}),eventKey:e.id,onClick:function(){return h(e.id)}},a().createElement(l.Glyphicon,{glyph:e.glyph}))})))),a().createElement(l.Col,{xs:12},u.filter((function(e){return e.id&&e.id===y})).filter((function(e){return e.Component})).map((function(e){return a().createElement(e.Component,p({},P,{key:"ms-tab-settings-body-"+e.id,containerWidth:m,element:r,groups:b,nodeType:t.nodeType,settings:t,retrieveLayerData:E,isLocalizedLayerStylesEnabled:v,onChange:function(e,t){return o()(e)?w(e,j):w(function(e,t,n){return(t=function(e){var t=function(e,t){if("object"!==s(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!==s(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===s(t)?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}({},e,t),j)}}))}))))}},616701:(e,t,n)=>{"use strict";n.d(t,{Z:()=>w});var r=n(124852),o=n.n(r),i=n(867076),a=n(581859),l=n(590690),c=n(229423),u=n(221338),s=n(91175),f=n.n(s);function p(e){return p="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},p(e)}function d(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function y(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?d(Object(n),!0).forEach((function(t){m(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):d(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function m(e,t,n){return(t=function(e){var t=function(e,t){if("object"!==p(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!==p(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===p(t)?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var b=function e(t,n){return t.reduce((function(t,r){var o=y({},r);return o.nodes&&(o=y(y({},o),{},{nodes:e(o.nodes,n)})),n.forEach((function(e){o.nodes&&e.func(o)?o=y(y({},o),e.options):o.nodes&&(o=y({},o))})),t.push(o),t}),[])},v=function(e){var t=e.nodes,n=e.filterText;return e.currentLocale,b(t,[{options:{showComponent:!0},func:function(){return!n}},{options:{loadingError:!0},func:function(e){return f()(e.nodes.filter((function(e){return e.loadingError&&"Warning"!==e.loadingError})))}},{options:{expanded:!0,showComponent:!0},func:function(e){return n&&f()(e.nodes.filter((function(e){return!0})))}}])};const g=(0,i.withProps)((function(e){return{nodes:v(e)}}));var h=n(803307),O=n(117802);const w=(0,i.compose)(O.Z,g,h.Z)((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.changeLayerPropertyByGroup,n=void 0===t?function(){}:t,r=e.changeLayerProperty,i=void 0===r?function(){}:r,s=e.changeGroupProperty,f=void 0===s?function(){}:s,p=e.onSort,d=e.onSelect,y=e.selectedNodes,m=e.nodes,b=void 0===m?[]:m;return o().createElement(u.Z,{onSort:p,selectedNodes:y,onSelect:d,nodes:b},o().createElement(c.Z,{groupElement:o().createElement(a.Z,{onSort:p,selectedNodes:y,onSelect:d,propertiesChangeHandler:function(e,t){return Object.keys(t).map((function(r){return n(e,r,t[r])}))},onToggle:function(e,t){return f(e,"expanded",!t)},groupVisibilityCheckbox:!0}),layerElement:o().createElement(l.Z,{selectedNodes:y,onSelect:d,titleTooltip:!0,propertiesChangeHandler:function(e,t){return Object.keys(t).map((function(n){return i(e,n,t[n])}))},onUpdateNode:function(e,t,n){return Object.keys(n).map((function(t){return i(e,t,n[t])}))},onToggle:function(e,t){return i(e,"expanded",!t)}})}))}))},803307:(e,t,n)=>{"use strict";n.d(t,{Z:()=>u});var r=n(984596),o=n.n(r),i=n(630998),a=n.n(i),l=n(867076),c=n(624262);const u=(0,l.withHandlers)({changeLayerProperty:function(e){var t=e.onChange,n=void 0===t?function(){}:t,r=e.map,o=void 0===r?{}:r;return function(e,t,r){var i=a()(o.layers||[],{id:e});n("map.layers[".concat(i,"].").concat(t),r)}},changeLayerPropertyByGroup:function(e){var t=e.onChange,n=void 0===t?function(){}:t,r=e.map,o=void 0===r?{}:r;return function(e,t,r){return o.layers.filter((0,c.CK)(e)).map((function(){var e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).id;return a()(o.layers||[],{id:e})})).filter((function(e){return e>=0})).map((function(e){return n("map.layers[".concat(e,"].").concat(t),r)}))}},changeGroupProperty:function(e){var t=e.onChange,n=void 0===t?function(){}:t,r=e.map,i=void 0===r?[]:r;return function(e,t,r){var l,c=i.groups?o()(i.groups):[],u=a()(c,(function(t){return e===t.id})),s=-1===u?c.length:u;"expanded"!==t||null!=c&&null!==(l=c[s])&&void 0!==l&&l.id||n("map.groups[".concat(s,"].id"),e),n("map.groups[".concat(s,"].").concat(t),r)}},updateMapEntries:function(e){var t=e.onChange,n=void 0===t?function(){}:t;return function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object.keys(e).map((function(t){return n("map[".concat(t,"]"),e[t])}))}}})},648860:(e,t,n)=>{"use strict";n.d(t,{Z:()=>u});var r=n(630998),o=n.n(r),i=n(867076);function a(e){return function(e){if(Array.isArray(e))return l(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return l(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?l(e,t):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function l(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var c=function(e,t){return(t.layers||[]).filter((function(){var t=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).group;return(void 0===t?"Default":t)===e})).map((function(){return(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).id}))};const u=(0,i.compose)((0,i.withStateHandlers)((function(){return{selectedLayers:[],selectedGroups:[]}}),{onNodeSelect:function(e,t){var n=e.selectedLayers,r=void 0===n?[]:n,i=e.selectedGroups,l=void 0===i?[]:i,u=t.map,s=void 0===u?{}:u;return function(e,t,n){return{selectedLayers:"group"===t?o()(l,(function(t){return t===e}))>=0?r.filter((function(t){return o()(c(e,s),(function(e){return e===t}))<0})):n?[].concat(a(r),a(c(e,s))):a(c(e,s)):o()(r,(function(t){return t===e}))>=0?r.filter((function(t){return t!==e})):n?[].concat(a(r),[e]):[e],selectedGroups:"group"===t?o()(l,(function(t){return t===e}))>=0?l.filter((function(t){return t!==e})):n?[].concat(a(l),[e]):[e]:n?l:[]}}}}),(0,i.withProps)((function(e){var t=e.selectedLayers,n=e.selectedGroups;return{selectedNodes:[].concat(a(t),a(n))}})))},117802:(e,t,n)=>{"use strict";n.d(t,{Z:()=>i});var r=n(867076),o=n(624262);const i=(0,r.withProps)((function(e){var t,n,r,i=e.map;return{nodes:(t=(0,o.DN)(i),n=t.layers,r=void 0===n?{}:n,(0,o.C1)(r.flat||[],r.groups||[]).groups)}}))},651768:(e,t,n)=>{"use strict";n.d(t,{Z:()=>K});var r=n(227361),o=n.n(r),i=n(867076),a=n(624262),l=n(979105),c=n(487427),u=n(518842),s=n(363209),f=n(630998),p=n.n(f),d=n(675263),y=n.n(d),m=n(124852),b=n.n(m),v=n(757588),g=n(743129),h=n(282467),O=n(805346);function w(e){return w="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},w(e)}function S(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,C(r.key),r)}}function E(e,t){return E=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},E(e,t)}function j(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function P(e){return P=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},P(e)}function T(e,t,n){return(t=C(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function C(e){var t=function(e,t){if("object"!==w(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!==w(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===w(t)?t:String(t)}var k=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&E(e,t)}(a,e);var t,n,r,o,i=(r=a,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=P(r);if(o){var n=P(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return function(e,t){if(t&&("object"===w(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return j(e)}(this,e)});function a(){var e;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a);for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return T(j(e=i.call.apply(i,[this].concat(n))),"renderLegend",(function(){return null})),T(j(e),"renderItemLabel",(function(e){return b().createElement("div",null,b().createElement("div",{key:"item-title"},e.title||e.name),b().createElement("div",null,b().createElement("small",{className:"text-muted",key:"item-key-description"},e.name)))})),T(j(e),"renderError",(function(){return e.props.element&&e.props.element.capabilities&&e.props.element&&e.props.element.capabilities.error?b().createElement(v.Alert,{bsStyle:"danger"},b().createElement(O.Z,{msgId:"layerProperties.styleListLoadError"})):null})),T(j(e),"updateEntry",(function(t,n){var r=n.target.value;e.props.onChange(t,r)})),e}return t=a,(n=[{key:"render",value:function(){var e=this,t=[{label:"Default Style",value:""}].concat((this.props.element.availableStyles||[]).map((function(t){return{label:e.renderItemLabel(t),value:t.name}})));return(this.props.element.style&&this.props.element.availableStyles&&p()(this.props.element.availableStyles,(function(t){return t.name===e.props.element.style})))>=0||!this.props.element.style||t.push({label:this.props.element.style,value:this.props.element.style}),b().createElement(v.Grid,{fluid:!0,style:{paddingTop:15,paddingBottom:15}},b().createElement("form",{ref:"style"},b().createElement(g.ZP.Creatable,{key:"styles-dropdown",options:t,isLoading:this.props.element&&this.props.element.capabilitiesLoading,value:this.props.element.style||"",onOpen:function(){!e.props.element||e.props.element.capabilities&&e.props.element.availableStyles||e.props.retrieveLayerData(e.props.element)},promptTextCreator:function(e){return b().createElement(O.Z,{msgId:"layerProperties.styleCustom",msgParams:{value:e}})},onChange:function(t){e.updateEntry("style",{target:{value:t&&t.value||""}})}}),b().createElement("br",null),this.renderLegend(),this.renderError(),b().createElement(h.Z,{bsStyle:"primary",style:{float:"right"},onClick:function(){return e.props.retrieveLayerData(e.props.element)}},b().createElement(v.Glyphicon,{glyph:"refresh"})," ",b().createElement(O.Z,{msgId:"layerProperties.stylesRefreshList"})),b().createElement("br",null)))}}])&&S(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),a}(b().Component);T(k,"propTypes",{retrieveLayerData:y().func,onChange:y().func,element:y().object,groups:y().array}),T(k,"defaultProps",{element:{},retrieveLayerData:function(){},onChange:function(){}});const I=k;var A=n(803307),D=n(117802),x=n(49977),M=n.n(x),R=n(680833);function N(e){return N="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},N(e)}function L(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Z(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?L(Object(n),!0).forEach((function(t){_(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):L(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function _(e,t,n){return(t=function(e){var t=function(e,t){if("object"!==N(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!==N(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===N(t)?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const F=(0,i.mapPropsStream)((function(e){var t=(0,i.createEventHandler)(),n=t.stream,r=t.handler;return e.pluck("element").distinctUntilChanged((function(){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).id===e.id})).switchMap((function(){return n.switchMap((function(e){return(0,R.kB)(e).map((function(e){return{capabilities:e,capabilitiesLoading:null,description:e._abstract,boundingBox:e.latLonBoundingBox,availableStyles:e.style&&(Array.isArray(e.style)?e.style:[e.style])}})).startWith({capabilitiesLoading:!0})})).catch((function(e){return M().Observable.of({capabilitiesLoading:null,capabilities:{error:"error getting capabilities",details:e},description:null})}))})).startWith({}).combineLatest(e,(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return Z(Z({},t),{},{retrieveLayerData:r,element:Z(Z({},t.element),e)})}))}));var B=n(666379),U=n.n(B);function G(e){return G="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},G(e)}var W=function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],n=arguments.length>1?arguments[1]:void 0,r=arguments.length>2?arguments[2]:void 0;for(var o in t)null!==t[o]&&"object"===G(t[o])&&(U()(t[o],n)&&r.apply(void 0,[t[o]]),e(t[o],n,r))};const z=(0,i.withProps)((function(e){var t=e.nodes,n=void 0===t?{}:t,r=e.editNode,o={};return r&&W(n,{id:r},(function(e){o=e})),{selectedNode:o}}));function H(e){return H="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},H(e)}function V(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function q(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?V(Object(n),!0).forEach((function(t){Y(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):V(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Y(e,t,n){return(t=function(e){var t=function(e,t){if("object"!==H(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!==H(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===H(t)?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Q=F(I),X=(0,i.withProps)((function(e){return{tabs:e.tabs||[{id:"general",titleId:"layerProperties.general",tooltipId:"layerProperties.general",glyph:"wrench",visible:!0,Component:s.Z},{id:"display",titleId:"layerProperties.display",tooltipId:"layerProperties.display",glyph:"eye-open",visible:e.settings&&"layers"===e.settings.nodeType,Component:u.Z},{id:"style",titleId:"layerProperties.style",tooltipId:"layerProperties.style",glyph:"dropper",visible:e.settings&&"layers"===e.settings.nodeType&&e.element&&"wms"===e.element.type,Component:Q}]}}));const K=(0,i.compose)(D.Z,z,(0,i.withState)("settings","onUpdateSettings",{}),(0,i.withProps)((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.map,n=void 0===t?{}:t,r=e.selectedNode,i=e.settings,l=void 0===i?{}:i;return{element:r,settings:q(q({},l),{},{nodeType:r&&r.nodes?"groups":"layers",options:{opacity:l.opacity>=0?l.opacity:r.opacity>=0?r.opacity:1}}),groups:o()((0,a.DN)(n),"layers.groups")}})),(0,i.compose)(A.Z,(0,i.withHandlers)({onUpdateNode:function(e){var t=e.changeLayerProperty,n=void 0===t?function(){}:t,r=e.changeGroupProperty,o=void 0===r?function(){}:r,i=e.editNode;return function(e,t,r){"layers"===t&&Object.keys(r).map((function(e){return n(i,e,r[e])})),"groups"===t&&Object.keys(r).map((function(e){return o(i,e,r[e])}))}}}),(0,i.withHandlers)({onUpdateParams:function(e){var t=e.settings,n=void 0===t?{}:t,r=e.onUpdateNode,o=void 0===r?function(){}:r;return function(e){(!(arguments.length>1&&void 0!==arguments[1])||arguments[1])&&o(n.node,n.nodeType,q(q({},n.props),e))}}})),c.kZ,(0,l.Z)("activeTab","setActiveTab","general"),X)},202576:(e,t,n)=>{"use strict";n.d(t,{Z:()=>h});var r=n(124852),o=n.n(r),i=n(180307),a=n.n(i),l=n(675263),c=n.n(l),u=n(757588),s=n(352595),f=n(950966);function p(e){return p="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},p(e)}function d(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,v(r.key),r)}}function y(e,t){return y=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},y(e,t)}function m(e){return m=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},m(e)}function b(e,t,n){return(t=v(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function v(e){var t=function(e,t){if("object"!==p(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!==p(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===p(t)?t:String(t)}var g=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&y(e,t)}(c,e);var t,n,r,i,l=(r=c,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=m(r);if(i){var n=m(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return function(e,t){if(t&&("object"===p(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,e)});function c(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,c),l.apply(this,arguments)}return t=c,(n=[{key:"renderPopover",value:function(){return o().createElement(u.Popover,{id:this.props.id,placement:this.props.placement,positionLeft:this.props.left,positionTop:this.props.top,title:this.props.title},this.props.text)}},{key:"renderContent",value:function(){var e=this;return o().createElement(u.Glyphicon,{ref:function(t){e.target=t},className:"text-".concat(this.props.bsStyle),glyph:this.props.glyph})}},{key:"render",value:function(){var e=this,t=!0===this.props.trigger?["hover","focus"]:this.props.trigger;return o().createElement("span",{className:"mapstore-info-popover"},this.props.trigger?o().createElement(f.Z,{trigger:t,placement:this.props.placement,overlay:this.renderPopover()},this.renderContent()):[this.renderContent(),o().createElement(s.Z,{placement:this.props.placement,show:!0,target:function(){return a().findDOMNode(e.target)}},this.renderPopover())])}}])&&d(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),c}(o().Component);b(g,"propTypes",{id:c().string,title:c().string,text:c().string,glyph:c().string,bsStyle:c().string,placement:c().string,left:c().number,top:c().number,trigger:c().oneOfType([c().array,c().bool])}),b(g,"defaultProps",{id:"",title:"",text:"",placement:"right",left:200,top:50,glyph:"question-sign",bsStyle:"info",trigger:["hover","focus"]});const h=g},589919:(e,t,n)=>{"use strict";n.d(t,{hP:()=>u});var r=n(984596),o=n.n(r),i=n(49977),a=n.n(i);function l(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var c=function(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return e.startWith.apply(e,function(e){if(Array.isArray(e))return l(e)}(t=n)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(t)||function(e,t){if(e){if("string"==typeof e)return l(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?l(e,t):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}())},u=function(e,t,n){return function(r){return(n?c(r,o()(e)).catch(n):c(r,o()(e))).concat(a().Observable.from(o()(t)))}}},680833:(e,t,n)=>{"use strict";n.d(t,{kB:()=>v,HI:()=>g});var r=n(472500),o=n.n(r),i=(n(91175),n(490173)),a=n(49977),l=n(501157),c=n(375875),u=n.n(c),s=(n(986267),n(624262)),f=n(510284),p=n(233044);function d(e){return d="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},d(e)}function y(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function m(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?y(Object(n),!0).forEach((function(t){b(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):y(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function b(e,t,n){return(t=function(e){var t=function(e,t){if("object"!==d(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!==d(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===d(t)?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}i.default;var v=function(e){return a.Observable.defer((function(){return l.ZP.getCapabilities((0,s.Fh)(e))})).let(f.oB).map((function(t){return l.ZP.parseLayerCapabilities(t,e)}))},g=function(e){return function(e){return a.Observable.defer((function(){return u().get(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.name,n=e.search,r=void 0===n?{}:n,i=e.url,a=o().parse(r.url||i,!0);return o().format(m(m({},a),{},{search:void 0,query:m(m({},a.query),{},{service:"WMS",version:"1.1.1",layers:t,outputFormat:"application/json",request:"DescribeLayer"})}))}(e))})).let(f.oB)}(e).map((function(e){var t=e.data,n=void 0===t?{}:t;return n&&n.layerDescriptions[0]})).map((function(){var t=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).owsURL;return m(m({},e),{},{params:{},search:t?{type:"wfs",url:(0,p.cleanAuthParamsFromURL)(t)}:void 0})}))}},488216:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>Ul});var r={};n.r(r),n.d(r,{cleanUpEmptyStoryContainers:()=>ve,closeShareOnGeostoryChangeMode:()=>Se,editMediaForBackgroundEpic:()=>ye,editWebPageComponent:()=>fe,handlePendingGeoStoryChanges:()=>Ee,hideCarouselItemsOnUpdateCurrentPage:()=>Oe,inlineEditorEditMap:()=>we,loadGeostoryEpic:()=>me,loadStoryOnHistoryPop:()=>Te,openMediaEditorForNewMedia:()=>ce,openWebPageComponentCreator:()=>se,reloadGeoStoryOnLoginLogout:()=>be,saveGeoStoryResource:()=>pe,scrollOnLoad:()=>Pe,scrollSideBar:()=>Ce,scrollToContentEpic:()=>de,setFocusOnMapEditing:()=>he,sortContentEpic:()=>ge,urlUpdateOnScroll:()=>je});var o=n(124852),i=n.n(o),a=n(171703),l=n(22222),c=n(375933),u=n.n(c),s=n(322843),f=n(192579),p=n(86638),d=n(531398),y=n(134990),m=n(93848),b=n(49977),v=n(91175),g=n.n(v),h=n(807654),O=n.n(h),w=n(747037),S=n.n(w),E=n(414293),j=n.n(E),P=n(595825),T=n.n(P),C=n(158748),k=n.n(C),I=n(227361),A=n.n(I),D=n(701469),x=n.n(D),M=n(441609),R=n.n(M),N=n(275982),L=n(423570),Z=n.n(L),_=n(375875),F=n.n(_),B=n(291312),U=n(782904),G=n(197395),W=n(263516),z=n(274621),H=n(866113),V=n(107501),q=n(589919),Y=n(727693),Q=n(282385);function X(e){return X="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},X(e)}var K=["status","statusText","data","message"],$=["data","isStatic"];function J(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i,a,l=[],c=!0,u=!1;try{if(i=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=i.call(n)).done)&&(l.push(r.value),l.length!==t);c=!0);}catch(e){u=!0,o=e}finally{try{if(!c&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}(e,t)||ie(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ee(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function te(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ee(Object(n),!0).forEach((function(t){ne(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ee(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function ne(e,t,n){return(t=function(e){var t=function(e,t){if("object"!==X(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!==X(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===X(t)?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function re(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}function oe(e){return function(e){if(Array.isArray(e))return ae(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||ie(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ie(e,t){if(e){if("string"==typeof e)return ae(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?ae(e,t):void 0}}function ae(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var le=function(e,t,n){return function(r){return r.ofType(m.AQ).switchMap((function(r){var o=r.resource,i=void 0===o?{}:o,a=[],l=e.getState(),c=(0,V.hb)(l),u=(0,V.IQ)(l),s=g()((0,H.jq)(l).filter((function(e){return e.data&&(u!==Y.rR.GEOSTORY&&e.data.id||e.id)===i.id}))),p=i.id;s?p=s.id:R()(i)?a=[].concat(oe(a),[(0,y.Od)("".concat(t)),(0,m.Cp)()]):(p=i.id||Z()(),a=[].concat(oe(a),[(0,y.rp)(p,c,i.data?i.data:i)]));var d=c===f.Tr.MAP?{resourceId:p,type:c,map:void 0}:{resourceId:p,type:c},v=[(0,y.Vx)("".concat(t),d,"merge")];return n===f.ID.CAROUSEL&&v.push((0,y.Vx)("".concat(t,".map"),{mapInfoControl:!0},"merge")),a=[].concat(oe(a),v,[(0,m.Cp)()]),b.Observable.from(a)}))}},ce=function(e,t){return e.ofType(y.D7).filter((function(e){var t=e.element,n=void 0===t?{}:t;return n.type===f.bT.MEDIA||(0,f.lt)(n)})).switchMap((function(n){var r=n.path,o=n.element,i="";(0,f.lt)(o)&&"sections"===r&&(i=".contents[0].contents[0]");var a="".concat(r,'[{"id":"').concat(o.id,'"}]').concat(i),l=(0,H.X6)(t.getState());return b.Observable.of((0,m.$Z)("geostory",l)).merge(e.let(le(t,a)),e.ofType(m.B8).switchMap((function(){return b.Observable.of((0,y.Od)(a))})).takeUntil(e.ofType(y.wb))).takeUntil(e.ofType(m.wd))}))},ue=function(e){return function(t){return t.ofType(y.Hb).switchMap((function(t){var n=t.src;return b.Observable.of((0,y.Vx)("".concat(e),{src:n,editURL:!1},"merge"))}))}},se=function(e){return e.ofType(y.D7).filter((function(e){var t=e.element,n=void 0===t?{}:t;return n.type===f.bT.WEBPAGE&&!1!==n.editURL||(0,f.NC)(n)})).switchMap((function(t){var n=t.path,r=t.element,o="";(0,f.NC)(r)&&"sections"===n&&(o=".contents[0].contents[0]");var i="".concat(n,'[{"id":"').concat(r.id,'"}]').concat(o);return b.Observable.of((0,y.Vx)(i,{editURL:!0},"merge")).merge(e.let(ue(i))).takeUntil(e.ofType(y.cc))}))},fe=function(e){return e.ofType(y.cc).switchMap((function(t){var n=t.path;return b.Observable.of((0,y.Vx)(n,{editURL:!0},"merge")).merge(e.let(ue(n))).takeUntil(e.ofType(y.D7))}))},pe=function(e){return e.ofType(y.LE).exhaustMap((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.resource,n=e.delay,r=void 0===n?1e3:n;return(t.id?(0,B.id)(t):(0,B.SN)(t)).switchMap((function(e){return b.Observable.of((0,y.GD)(e),(0,y.g5)(f.ZX.SHOW_SAVE,!1),t.id?(0,y.wJ)(e):(0,N.VF)("/geostory/".concat(e))).merge(b.Observable.of((0,G.$Z)({id:"STORY_SAVE_SUCCESS",title:"saveDialog.saveSuccessTitle",message:"saveDialog.saveSuccessMessage"})).delay(t.id?0:r))})).let((0,q.hP)((0,y.YP)(!0,"loading"),(0,y.YP)(!1,"loading"))).catch((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.status,n=e.statusText,r=e.data,o=e.message,i=re(e,K);return b.Observable.of((0,y.y6)(t?{status:t,statusText:n,data:r}:o||i),(0,y.YP)(!1,"loading"))}))}))},de=function(e){var t=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}).getState,n=void 0===t?function(){}:t;return e.ofType(y.D7).switchMap((function(e){var t=e.path,r=e.element;return b.Observable.of(r).switchMap((function(){if(document.getElementById(r.id)){var e=(0,f.u0)(t).sectionId,o=(0,H.I0)(e)(n())?e:r.id;return(0,f.M1)(o,{behavior:"auto",block:"center"}),b.Observable.empty()}throw new Error("Item not mounted yet")})).retryWhen((function(e){return e.delay(200).take(10)}))}))},ye=function(e,t){return e.ofType(m.wd).switchMap((function(n){var r=n.path,o=n.owner,i=n.sectionType,a=(0,H.vv)(r)(t.getState()),l=(0,H.Tr)(a)(t.getState());return b.Observable.of((0,V.hb)(t.getState())).filter((function(e){return l&&l.type!==e})).map((function(){return(0,m.y5)(l.type)})).merge(b.Observable.of((0,m.$Z)(o,(0,H.X6)(t.getState())),(0,m.Gh)(a),(0,m.Tk)(i===f.ID.CAROUSEL?["image","video"]:[])).merge(e.let(le(t,r,i)).takeUntil(e.ofType(m.B8,y.D7))))}))},me=function(e,t){var n=t.getState,r=void 0===n?function(){}:n;return e.ofType(y.XH).switchMap((function(e){var t=e.id;return b.Observable.defer((function(){return t&&O()(parseInt(t,10))?F().get("configs/".concat(t,".json")).then((function(e){var t=e.data,n=t.sections,r=x()(n)&&n.map((function(e){return te(te({},e),{},{id:Z()()})}));return{data:r.length?te(te({},t),{},{sections:r}):t,isStatic:!0,canEdit:!0}})):(0,B.RX)(t)})).do((function(e){if(!e.data)throw Error("Wrong data format");return!0})).switchMap((function(e){var n=e.data,o=e.isStatic,i=void 0!==o&&o,a=re(e,$),l=r(),c=(0,z.qg)(l),u=(0,z.jl)(l),s=S()(n)?JSON.parse(n):n;if(!u&&O()(parseInt(t,10)))return b.Observable.of((0,y.Ct)({status:403}));var p=(0,H.eK)(l)===f.nl.EDIT;return b.Observable.from([].concat(oe(i||p?[(0,y.D_)(a&&a.canEdit||c)]:[]),[(0,y.OS)(t),(0,y.K0)(s),(0,y.DF)(a)]))})).let((0,q.hP)((0,y.YP)(!0,"loading"),(0,y.YP)(!1,"loading"),(function(e){var t=(0,f.of)(),n=t+".errors.loading.unknownError";return 403===e.status?(n=t+".errors.loading.pleaseLogin",((0,z.jl)(r())||(0,H.JM)(r()))&&(n=t+".errors.loading.geostoryNotAccessible")):404===e.status?n=t+".errors.loading.geostoryDoesNotExist":j()(e.status)&&(n=e.message),b.Observable.of((0,G.vU)({title:t+".errors.loading.title",message:n}),(0,y.K0)({}),(0,y.Ct)(te(te({},e),{},{messageId:n})))}))).startWith((0,y.K0)({}))}))},be=function(e){return e.ofType(y.XH).switchMap((function(t){var n=t.id;return e.ofType(W.XP,W.Nv).switchMap((function(){return b.Observable.of((0,y.wJ)(n)).delay(500)})).takeUntil(e.ofType(N.nk))}))},ve=function(e,t){var n=t.getState,r=void 0===n?function(){}:n;return e.ofType(y.Dq).switchMap((function(e){var t=e.path,n=(0,f.Ll)(t,(0,H.Kg)(r())),o=T()(n,"contents");if(o>0){var i=n.splice(0,o),a=(0,H.$F)(i.join("."))(r());if(a&&a.contents&&0===a.contents.length)return b.Observable.of((0,y.Od)(i.join(".")))}return b.Observable.empty()}))},ge=function(e,t){var n=t.getState,r=void 0===n?function(){}:n;return e.ofType(y.tP).switchMap((function(e){var t=e.source,n=e.target,o=e.position,i=r(),a=(0,H.$F)(t)(i);return b.Observable.from([(0,y.Od)(t),(0,y.IH)(n,o,a)])}))},he=function(e,t){var n=t.getState,r=void 0===n?function(){}:n;return e.ofType(y.wb).filter((function(e){var t=e.path;return(void 0===t?"":t).endsWith("editMap")})).switchMap((function(e){var t=e.path,n=e.element,o=(0,f.ln)(t,(0,H.Kg)(r())),i=o.flatPath,a=o.path,l=1===i.length,c=l?i[0]:i.pop(),u=l?i[0]:i.shift(),s="background"===a[a.length-2],p=s&&"#".concat(u.id," .ms-section-background-container")||"#".concat(c.id);return(0,f.M1)(c.id),b.Observable.from([(0,y.$A)(n,c,p,s,t.replace(".editMap",""))])}))},Oe=function(e,t){var n=t.getState;return e.ofType(y.wb).filter((function(e){var t=e.path,n=e.element;return t&&t.endsWith("carouselToggle")&&n})).switchMap((function(e){var t=e.path,r=(0,f.u0)(t)||{},o=r.sectionId,i=r.contentId,a=(0,H.eB)(o)(n())||[];return i&&!R()(a)?b.Observable.from([(0,y.fD)(o,i)]).concat(b.Observable.of((0,y.Vx)(t,!1))):b.Observable.empty()}))},we=function(e,t){var n=t.getState;return e.ofType(Q.nr).filter((function(e){var t=e.owner,n=e.map;return"inlineEditor"===t&&!!n})).switchMap((function(){return e.ofType(Q.LE).switchMap((function(t){var r=t.map,o=(0,H.FW)(n()).path;return b.Observable.of((0,y.Vx)("".concat(o,".map"),r,"merge"),(0,y.Vx)("".concat(o,".editMap"),!1),(0,Q.Cp)()).takeUntil(e.ofType(Q.B8))}))}))},Se=function(e){return e.ofType(y.vb).switchMap((function(){return b.Observable.of((0,U.Xg)("share","enabled",!1))}))},Ee=function(e){return b.Observable.merge(e.ofType(y.XH).switchMap((function(){return e.ofType(y.Zf)}))).switchMap((function(){return e.ofType(y.D7,y.wb,y.Dq,y.mN,y.QK,y.km).take(1).switchMap((function(){return b.Observable.of((0,y.c0)(!0)).concat(e.ofType(y.si,N.nk,W.Nv).take(1).switchMap((function(){return b.Observable.of((0,y.c0)(!1))})))}))}))},je=function(e,t){var n=t.getState;return e.ofType(y.un).let(function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(e){return e};return function(r){return r.withLatestFrom(e.startWith(t)).filter((function(e){var t=J(e,2)[1];return n(t)})).map((function(e){return J(e,1)[0]}))}}(e.ofType(y.Gx).map((function(e){return!e.status})).startWith(!0))).debounceTime(50).switchMap((function(e){var t=e.sectionId,r=e.columnId;if("edit"!==(0,H.eK)(n())&&(r||t)&&(0,H.bU)(n())){var o,i,a=A()(n(),"geostory.resource.id"),l=(0,f.NP)(window.location.href,null===(o=window)||void 0===o||null===(i=o.location)||void 0===i?void 0:i.hash,a,t,r);l&&history.pushState(null,"",l)}return b.Observable.empty()}))},Pe=function(e){return e.ofType(y.ij).switchMap((function(e){var t,n,r,o=e.delay,i=void 0===o?2e3:o,a=null===(t=window)||void 0===t||null===(n=t.location)||void 0===n||null===(r=n.hash)||void 0===r?void 0:r.split("/");return b.Observable.of(a).do((function(){var e,t,n;null!==(e=window)&&void 0!==e&&null!==(t=e.location)&&void 0!==t&&null!==(n=t.hash)&&void 0!==n&&n.includes("shared")?(0,f.M1)(a[7]||a[5],{block:"start",behavior:"auto"}):a.length>5?(0,f.M1)(a[6],{block:"start",behavior:"auto"}):5===a.length&&(0,f.M1)(a[4],{block:"start",behavior:"auto"})})).ignoreElements().startWith((0,y.WE)(!0)).concat(b.Observable.of((0,y.WE)(!1)).delay(i))}))},Te=function(e){return e.ofType(N.nk).switchMap((function(e){var t,n=e.payload;if((null==n||null===(t=n.location)||void 0===t?void 0:t.pathname.includes("/geostory/"))&&"POP"===n.action&&!n.isFirstRendering){var r,o=k()(null==n||null===(r=n.location)||void 0===r?void 0:r.pathname);return o.find((function(e){return"shared"===e}))?b.Observable.of((0,y.wJ)(o[2])).delay(500):b.Observable.of((0,y.wJ)(o[1])).delay(500)}return b.Observable.empty()}))},Ce=function(e,t){var n=t.getState;return e.ofType(y.un).filter((function(e){var t=e.columnId,r=e.sectionId;return!("edit"!==(0,H.eK)(n())||!t&&!r)})).debounceTime(50).switchMap((function(){return b.Observable.of(Array.from(document.querySelectorAll(".ms-geostory-builder .mapstore-side-card.ms-highlight")).pop()).filter((function(e){return!!e})).withLatestFrom(b.Observable.of(document.querySelector(".ms-geostory-builder .ms2-border-layout-body")).filter((function(e){return!!e}))).map((function(e){var t=J(e,2),n=t[0],r=t[1];return function(){var e=n.getBoundingClientRect(),t=e.top,o=e.bottom,i=r.getBoundingClientRect(),a=i.top,l=i.bottom;t<a?r.scrollBy({top:t-a-10,behavior:"smooth"}):o>l&&r.scrollBy({top:o-l+10,behavior:"smooth"})}})).do((function(e){return window.requestAnimationFrame(e)})).ignoreElements()}))},ke=n(308316),Ie=n(166190),Ae=n(965539),De=n(496259),xe=n(867076),Me=n(828878);function Re(e){return Re="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Re(e)}function Ne(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Le(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ne(Object(n),!0).forEach((function(t){Ze(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ne(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Ze(e,t,n){return(t=function(e){var t=function(e,t){if("object"!==Re(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!==Re(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===Re(t)?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function _e(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}(0,xe.setObservableConfig)(Me.Z);var Fe=(0,xe.compose)((0,xe.mapPropsStream)((function(e){var t=(0,xe.createEventHandler)(),n=t.handler,r=t.stream,o="EMPTY",i="EMPTY";return b.Observable.combineLatest(e,r.filter((function(e){var t=e.columnId,n=e.sectionId;return t&&o!==t?(o=t,!0):!(!n||i===n||(i=n,0))})).withLatestFrom(e.pluck("updateCurrentPage")).do((function(e){var t,n,r=(n=2,function(e){if(Array.isArray(e))return e}(t=e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i,a,l=[],c=!0,u=!1;try{if(i=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=i.call(n)).done)&&(l.push(r.value),l.length!==t);c=!0);}catch(e){u=!0,o=e}finally{try{if(!c&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}(t,n)||function(e,t){if(e){if("string"==typeof e)return _e(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?_e(e,t):void 0}}(t,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),o=r[0],i=r[1];return i&&i(o)})).ignoreElements().startWith({}),(function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return Le(Le({},t.reduce((function(){var e=arguments.length>1?arguments[1]:void 0;return Le(Le({},arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}),e)}),{})),{},{updateCurrentPage:n})}))}))),Be=n(982030),Ue=n(322762),Ge=n.n(Ue);function We(e){return We="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},We(e)}function ze(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function He(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ze(Object(n),!0).forEach((function(t){Ve(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ze(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Ve(e,t,n){return(t=function(e){var t=function(e,t){if("object"!==We(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!==We(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===We(t)?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}(0,xe.setObservableConfig)(Me.Z);const qe=(0,xe.compose)((0,xe.mapPropsStream)((function(e){var t=(0,xe.createEventHandler)(),n=t.handler,r=t.stream;return b.Observable.combineLatest(e,function(e,t){return t.map((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{interceptorTime:e.interceptorTime,updateCurrentPage:e.updateCurrentPage}})).distinctUntilKeyChanged("interceptorTime").switchMap((function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.interceptorTime,r=void 0===n?100:n,o=t.updateCurrentPage;return e.scan((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0,n=t.id,r=t.visible,o=t.entry;return He(He({},e),{},Ve({},n,{visible:r,entry:o}))}),{}).debounceTime(r).map((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Ge()(Object.keys(e),(function(t){return e[t].visible?A()(e[t],"entry.boundingClientRect.top"):1/0}))})).do((function(e){o&&o({sectionId:e})})).ignoreElements()}))}(r,e).startWith({}),(function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return He(He({},t.reduce((function(){var e=arguments.length>1?arguments[1]:void 0;return He(He({},arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}),e)}),{})),{},{onVisibilityChange:n})}))})));var Ye=n(675263),Qe=n.n(Ye),Xe=n(993451),Ke=(n(707169),n(909041)),$e=n(967134),Je=n(294184),et=n.n(Je);function tt(e){return tt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},tt(e)}function nt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function rt(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,ft(r.key),r)}}function ot(e,t,n){return t&&rt(e.prototype,t),n&&rt(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function it(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&at(e,t)}function at(e,t){return at=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},at(e,t)}function lt(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=ut(e);if(t){var o=ut(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return function(e,t){if(t&&("object"===tt(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return ct(e)}(this,n)}}function ct(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function ut(e){return ut=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},ut(e)}function st(e,t,n){return(t=ft(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function ft(e){var t=function(e,t){if("object"!==tt(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!==tt(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===tt(t)?t:String(t)}var pt="External Link",dt=function(e){it(n,e);var t=lt(n);function n(){var e;nt(this,n);for(var r=arguments.length,o=new Array(r),i=0;i<r;i++)o[i]=arguments[i];return st(ct(e=t.call.apply(t,[this].concat(o))),"state",{expanded:!1}),st(ct(e),"toggle",(function(){e.setState((function(e){return{expanded:!e.expanded}}))})),e}return ot(n,[{key:"render",value:function(){var e=this.state.expanded,t=this.props,n=t.externalLinkOption,r=t.onSelectionChange,o=t.currentSelectOption,a=t.availableStorySections;return i().createElement("div",{className:"rdw-block-wrapper","aria-label":"rdw-block-control"},i().createElement($e.Dropdown,{className:"ms-rdw-link-options-dropdown",onChange:r,expanded:e,doExpand:this.toggle,doCollapse:this.toggle,onExpandEvent:this.toggle,title:"MSLinks"},i().createElement("span",null,o),i().createElement($e.DropdownOption,{active:!0,value:{value:n,label:n},key:n},"External Link"),a&&a.map((function(e){return i().createElement($e.DropdownOption,{active:e.id===o,value:{value:e.id,label:e.title||e.type||e.id},key:e.id},e.title||e.type||e.id)}))))}}]),n}(o.Component);st(dt,"propTypes",{externalLinkOption:Qe().string,onSelectionChange:Qe().func,currentSelectOption:Qe().string,availableStorySections:Qe().array});var yt=function(e){it(n,e);var t=lt(n);function n(){var e;nt(this,n);for(var r=arguments.length,o=new Array(r),i=0;i<r;i++)o[i]=arguments[i];return st(ct(e=t.call.apply(t,[this].concat(o))),"state",{showModal:!1,linkTarget:"",linkTitle:"",attributes:{},linkTargetOption:e.props.config.defaultTargetOption,currentSelectOption:"Select link target"}),st(ct(e),"removeLink",(function(){(0,e.props.onChange)("unlink")})),st(ct(e),"addLink",(function(){var t=e.props.onChange,n=e.state;t("link",n.linkTitle,n.linkTarget,n.linkTargetOption,n.attributes)})),st(ct(e),"updateValue",(function(t){e.setState(st({},"".concat(t.target.name),t.target.value))})),st(ct(e),"onSelectionChange",(function(t){t.value===pt?e.setState({linkTarget:"",attributes:{},currentSelectOption:t.label}):e.setState({linkTarget:t.value,attributes:{"data-geostory-interaction-type":"scrollTo","data-geostory-interaction-params":"".concat(t.value),"data-geostory-interaction-name":t.label},currentSelectOption:t.label})})),st(ct(e),"updateTargetOption",(function(t){e.setState({linkTargetOption:t.target.checked?"_blank":"_self"})})),st(ct(e),"hideModal",(function(){e.setState({showModal:!1})})),st(ct(e),"signalExpandShowModal",(function(){var t=e.props,n=t.onExpandEvent,r=t.currentState,o=r.link,i=r.selectionText,a=e.state.linkTargetOption;n();var l="Select link target";null!=o&&o.target&&o.target.length>0&&(l=pt),null!=o&&o.attributes["data-geostory-interaction-name"]&&(l=o.attributes["data-geostory-interaction-name"]),e.setState({showModal:!0,linkTarget:o&&o.target||"",linkTargetOption:o&&o.targetOption||a,linkTitle:o&&o.title||i,attributes:o&&o.attributes||{},currentSelectOption:l})})),st(ct(e),"forceExpandAndShowModal",(function(){var t=e.props,n=t.doExpand,r=t.currentState,o=r.link,i=r.selectionText,a=e.state.linkTargetOption;n();var l="Select link target";null!=o&&o.target&&o.target.length>0&&(l=pt),null!=o&&o.attributes["data-geostory-interaction-name"]&&(l=o.attributes["data-geostory-interaction-name"]),e.setState({showModal:!0,linkTarget:o&&o.target,linkTargetOption:o&&o.targetOption||a,linkTitle:o&&o.title||i,attributes:o&&o.attributes||{},currentSelectOption:l})})),e}return ot(n,[{key:"componentDidUpdate",value:function(e){e.expanded&&!this.props.expanded&&this.setState({showModal:!1,linkTarget:"",linkTitle:"",attributes:{},linkTargetOption:this.props.config.defaultTargetOption,currentSelectOption:"Select link target"})}},{key:"renderAddLinkModal",value:function(){var e=this.props,t=e.config.popupClassName,n=e.doCollapse,r=e.translations,o=e.availableStorySections,a=this.state,l=a.linkTitle,c=a.linkTarget,u=a.linkTargetOption,s=a.currentSelectOption;return i().createElement("div",{className:et()("rdw-link-modal",t),onClick:$e.stopPropagation},i().createElement("label",{className:"rdw-link-modal-label",htmlFor:"linkTitle"},r["components.controls.link.linkTitle"]),i().createElement("input",{id:"linkTitle",className:"rdw-link-modal-input",onChange:this.updateValue,onBlur:this.updateValue,name:"linkTitle",value:l}),i().createElement("label",{className:"rdw-link-modal-label",htmlFor:"linkTarget"},r["components.controls.link.linkTarget"]),i().createElement(dt,{externalLinkOption:pt,currentSelectOption:s,onSelectionChange:this.onSelectionChange,availableStorySections:o}),s===pt&&i().createElement(i().Fragment,null,i().createElement("input",{id:"linkTarget",className:"rdw-link-modal-input",onChange:this.updateValue,onBlur:this.updateValue,name:"linkTarget",value:c}),i().createElement("label",{className:"rdw-link-modal-target-option",htmlFor:"openLinkInNewWindow"},i().createElement("input",{id:"openLinkInNewWindow",type:"checkbox",defaultChecked:"_blank"===u,value:"_blank",onChange:this.updateTargetOption}),i().createElement("span",null,r["components.controls.link.linkTargetOption"]))),i().createElement("span",{className:"rdw-link-modal-buttonsection"},i().createElement("button",{className:"rdw-link-modal-btn",onClick:this.addLink,disabled:!c||!l},r["generic.add"]),i().createElement("button",{className:"rdw-link-modal-btn",onClick:n},r["generic.cancel"])))}},{key:"renderInFlatList",value:function(){var e=this.props,t=e.config,n=t.options,r=t.link,o=t.unlink,a=t.className,l=e.currentState,c=e.expanded,u=e.translations,s=this.state.showModal;return i().createElement("div",{className:et()("rdw-link-wrapper",a),"aria-label":"rdw-link-control"},n.indexOf("link")>=0&&i().createElement($e.Option,{value:"unordered-list-item",className:et()(r.className),onClick:this.signalExpandShowModal,"aria-haspopup":"true","aria-expanded":s,title:r.title||u["components.controls.link.link"]},i().createElement("img",{src:r.icon,alt:""})),n.indexOf("unlink")>=0&&i().createElement($e.Option,{disabled:!l.link,value:"ordered-list-item",className:et()(o.className),onClick:this.removeLink,title:o.title||u["components.controls.link.unlink"]},i().createElement("img",{src:o.icon,alt:""})),c&&s?this.renderAddLinkModal():void 0)}},{key:"renderInDropDown",value:function(){var e=this.props,t=e.expanded,n=e.onExpandEvent,r=e.doCollapse,o=e.doExpand,a=e.onChange,l=e.config,c=e.currentState,u=e.translations,s=l.options,f=l.link,p=l.unlink,d=l.className,y=l.dropdownClassName,m=l.title,b=this.state.showModal;return i().createElement("div",{className:"rdw-link-wrapper","aria-haspopup":"true","aria-label":"rdw-link-control","aria-expanded":t,title:m},i().createElement($e.Dropdown,{className:et()("rdw-link-dropdown",d),optionWrapperClassName:et()(y),onChange:a,expanded:t&&!b,doExpand:o,doCollapse:r,onExpandEvent:n},i().createElement("img",{src:(0,$e.getFirstIcon)(l),alt:""}),s.indexOf("link")>=0&&i().createElement($e.DropdownOption,{onClick:this.forceExpandAndShowModal,className:et()("rdw-link-dropdownoption",f.className),title:f.title||u["components.controls.link.link"]},i().createElement("img",{src:f.icon,alt:""})),s.indexOf("unlink")>=0&&i().createElement($e.DropdownOption,{onClick:this.removeLink,disabled:!c.link,className:et()("rdw-link-dropdownoption",p.className),title:p.title||u["components.controls.link.unlink"]},i().createElement("img",{src:p.icon,alt:""}))),t&&b?this.renderAddLinkModal():void 0)}},{key:"render",value:function(){return this.props.config.inDropdown?this.renderInDropDown():this.renderInFlatList()}}]),n}(o.Component);st(yt,"propTypes",{expanded:Qe().bool,doExpand:Qe().func,doCollapse:Qe().func,onExpandEvent:Qe().func,config:Qe().object,onChange:Qe().func,currentState:Qe().object,translations:Qe().object,modalHandler:Qe().any});const mt=yt;function bt(e){return bt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},bt(e)}function vt(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,St(r.key),r)}}function gt(e,t){return gt=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},gt(e,t)}function ht(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Ot(e){return Ot=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Ot(e)}function wt(e,t,n){return(t=St(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function St(e){var t=function(e,t){if("object"!==bt(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!==bt(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===bt(t)?t:String(t)}function Et(e,t,n){e.findEntityRanges((function(e){var t=e.getEntity();return null!==t&&"LINK"===n.getEntity(t).getType()}),t)}function jt(e){var t,n=e.showOpenOptionOnHover;return t=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&gt(e,t)}(c,e);var t,r,o,a,l=(o=c,a=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=Ot(o);if(a){var n=Ot(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return function(e,t){if(t&&("object"===bt(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return ht(e)}(this,e)});function c(){var e;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,c);for(var t=arguments.length,r=new Array(t),o=0;o<t;o++)r[o]=arguments[o];return wt(ht(e=l.call.apply(l,[this].concat(r))),"state",{showPopOver:!1}),wt(ht(e),"openLink",(function(){var t=e.props,n=t.entityKey,r=t.contentState.getEntity(n).getData().url,o=window.open(r,"blank");o&&o.focus()})),wt(ht(e),"toggleShowPopOver",(function(){var t=!e.state.showPopOver;e.setState({showPopOver:t})})),wt(ht(e),"renderDecorator",(function(){var t=e.props,r=t.children,o=t.entityKey,a=t.contentState.getEntity(o).getData(),l=a.url,c=a.targetOption,u=a.attributes,s=e.state.showPopOver;return u&&u["data-geostory-interaction-type"]?i().createElement("span",{className:"rdw-link-decorator-wrapper"},i().createElement("a",{"data-geostory-interaction-type":u["data-geostory-interaction-type"],"data-geostory-interaction-params":u["data-geostory-interaction-params"]},r)):i().createElement("span",{className:"rdw-link-decorator-wrapper",onMouseEnter:e.toggleShowPopOver,onMouseLeave:e.toggleShowPopOver},i().createElement("a",{href:l,target:c},r),s&&n?i().createElement("img",{src:$e.openlink,alt:"",onClick:e.openLink,className:"rdw-link-decorator-icon"}):void 0)})),e}return t=c,(r=[{key:"render",value:function(){return this.renderDecorator()}}])&&vt(t.prototype,r),Object.defineProperty(t,"prototype",{writable:!1}),c}(o.Component),wt(t,"propTypes",{entityKey:Qe().string.isRequired,children:Qe().array,contentState:Qe().object}),t}const Pt=function(e){return{strategy:Et,component:jt(e)}};var Tt=n(689265),Ct=n.n(Tt),kt=n(717247),It=n.n(kt),At=function(e){var t=void 0;if(e instanceof HTMLAnchorElement){var n={};if(e.dataset&&void 0!==e.dataset.mention)n.url=e.href,n.text=e.innerHTML,n.value=e.dataset.value,t=Ke.Entity.__create("MENTION","IMMUTABLE",n);else{n.url=e.getAttribute&&e.getAttribute("href")||e.href,n.title=e.innerHTML,n.targetOption=e.target;var r=e.getAttribute&&e.getAttribute("data-geostory-interaction-type"),o=e.getAttribute&&e.getAttribute("data-geostory-interaction-params"),i=e.getAttribute&&e.getAttribute("data-geostory-interaction-name"),a={};i&&o&&r&&(a["data-geostory-interaction-type"]=r,a["data-geostory-interaction-params"]=o,a["data-geostory-interaction-name"]=i),n.attributes=a,t=Ke.Entity.__create("LINK","MUTABLE",n)}}return t},Dt=function(e,t){if("MENTION"===e.type)return'< href="'.concat(e.data.url,'" class="wysiwyg-mention" data-mention data-value="').concat(e.data.value,'">').concat(t,"</a>");if("LINK"===e.type){var n=e.data.targetOption||"_self",r=e.data.attributes;return r&&r["data-geostory-interaction-type"]?'<a data-geostory-interaction-name="'.concat(r["data-geostory-interaction-name"],'" data-geostory-interaction-type="').concat(r["data-geostory-interaction-type"],'" data-geostory-interaction-params="').concat(r["data-geostory-interaction-params"],"\" onclick=\"__geostory_interaction(type='scrollTo', '").concat(r["data-geostory-interaction-params"],"')\">").concat(t,"</a>"):'<a href="'.concat(e.data.url,'" target="').concat(n,'">').concat(t,"</a>")}if("IMAGE"===e.type){var o=e.data.alignment,i=o&&"none"!==o?"float: ".concat(o,";"):"display: block; margin: 0 auto 0 auto;";return'<img src="'.concat(e.data.src,'" alt="').concat(e.data.alt,'" style="height: ').concat(e.data.height,"; width: ").concat(e.data.width,"; ").concat(i,'" />')}return"EMBEDDED_LINK"===e.type?'<iframe width="'.concat(e.data.width,'" height="').concat(e.data.height,'" src="').concat(e.data.src,'" frameBorder="0"></iframe>'):t};function xt(e){return xt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},xt(e)}function Mt(){return Mt=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Mt.apply(this,arguments)}function Rt(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Nt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Lt(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Nt(Object(n),!0).forEach((function(t){Zt(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Nt(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Zt(e,t,n){return(t=function(e){var t=function(e,t){if("object"!==xt(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!==xt(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===xt(t)?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var _t=(0,xe.compose)((0,xe.withProps)((function(e){var t=e.storyFonts,n=void 0===t?[]:t,r=e.placeholder,o=e.toolbarStyle,i=void 0===o?{}:o,a=e.className,l=void 0===a?"ms-text-editor":a,c=e.toolbar,u=void 0===c?{}:c;return{editorRef:function(e){return setTimeout((function(){return e&&e.focus&&e.focus()}),100)},stripPastedStyles:!0,placeholder:r,toolbarStyle:i,toolbar:Lt({options:["fontFamily","blockType","fontSize","inline","textAlign","colorPicker","list","link","remove"],fontFamily:{options:n.length>0?n:f.Km,className:void 0,component:void 0,dropdownClassName:void 0},link:{inDropdown:!1,className:void 0,component:void 0,popupClassName:void 0,dropdownClassName:void 0,showOpenOptionOnHover:!0,defaultTargetOption:"_self",options:["link","unlink"],link:{icon:void 0,className:void 0},unlink:{icon:void 0,className:void 0},linkCallback:void 0},blockType:{inDropdown:!0,options:["Normal","H1","H2","H3","H4","H5","H6","Blockquote","Code"],className:void 0,component:void 0,dropdownClassName:void 0},inline:{options:["bold","italic","underline","strikethrough","monospace"],bold:{className:"".concat(l,"-toolbar-btn")},italic:{className:"".concat(l,"-toolbar-btn")},underline:{className:"".concat(l,"-toolbar-btn")},strikethrough:{className:"".concat(l,"-toolbar-btn")},code:{className:"".concat(l,"-toolbar-btn")}},textAlign:{left:{className:"".concat(l,"-toolbar-btn")},center:{className:"".concat(l,"-toolbar-btn")},right:{className:"".concat(l,"-toolbar-btn")},justify:{className:"".concat(l,"-toolbar-btn")}},colorPicker:{className:"".concat(l,"-toolbar-btn")},remove:{className:"".concat(l,"-toolbar-btn")}},u),toolbarClassName:"".concat(l,"-toolbar"),wrapperClassName:"".concat(l,"-wrapper"),editorClassName:"".concat(l,"-main")}})),(0,xe.renderComponent)($e.Editor)),Ft=(0,xe.compose)((0,xe.lifecycle)({componentWillUnmount:function(){var e=this.props,t=e.editorState,n=e.save;(void 0===n?function(){}:n)(function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";if(e){var n=1!==(0,Ke.convertToRaw)(e.getCurrentContent()).blocks.length||(0,Ke.convertToRaw)(e.getCurrentContent()).blocks[0].text,r=Ct()((0,Ke.convertToRaw)(e.getCurrentContent()),null,null,Dt);return n?r:t}return t}(t,f.gg))}}),(0,xe.withHandlers)({onBlur:function(e){var t=e.toggleEditing,n=void 0===t?function(){}:t;return function(){n(!1)}}}),(0,xe.withProps)((function(e){var t=e.sections;return{availableStorySections:(void 0===t?[]:t).reduce((function(e,t){var n,r=[];return[f.ID.IMMERSIVE,f.ID.CAROUSEL].includes(t.type)?t.contents.forEach((function(e){r.push(e)})):r.push(t),[].concat(function(e){if(Array.isArray(e))return Rt(e)}(n=e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(n)||function(e,t){if(e){if("string"==typeof e)return Rt(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Rt(e,t):void 0}}(n)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}(),r)}),[])}})),(0,xe.withProps)((function(e){var t=e.availableStorySections,n=void 0===t?[]:t;return{toolbar:{link:{inDropdown:!1,className:void 0,component:function(e){return i().createElement(mt,Mt({},e,{availableStorySections:n}))},popupClassName:void 0,dropdownClassName:void 0,showOpenOptionOnHover:!0,defaultTargetOption:"_self",options:["link","unlink"],link:{icon:void 0,className:void 0},unlink:{icon:void 0,className:void 0},linkCallback:void 0,getLinkDecorator:Pt}}}})),_t);const Bt=(0,xe.compose)((0,xe.withState)("contentEditing","setContentEditing",!1),(0,xe.withState)("editorState","onEditorStateChange"),(0,xe.withHandlers)({toggleEditing:function(e){var t=e.bubblingTextEditing,n=void 0===t?function(){}:t,r=e.sectionType,o=e.onEditorStateChange,i=void 0===o?function(){}:o,a=e.setContentEditing,l=void 0===a?function(){}:a;return function(e,t){if(e){var o=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=It()(e,null,At),n=Ke.ContentState.createFromBlockArray(t.contentBlocks);return Ke.EditorState.createWithContent(n)}(t);if(r===f.ID.TITLE&&"unstyled"===Ke.RichUtils.getCurrentBlockType(o)){var a=o.getCurrentContent();a=Ke.Modifier.setBlockType(a,Ke.EditorState.createWithContent(a).getSelection(),"header-one"),o=Ke.EditorState.createWithContent(a)}i(o),l(!0),n(!0)}else l(!1),n(!1)}}}),(0,xe.branch)((function(e){return!!e.contentEditing}),Ft)),Ut=(0,xe.compose)((0,xe.withHandlers)({save:function(e){var t=e.update,n=void 0===t?function(){}:t;return function(e){return n("html",e)}}}),(0,xe.branch)((function(e){return e.mode===f.nl.EDIT}),Bt),(0,xe.compose)((0,xe.withPropsOnChange)(["sectionType"],(function(e){var t=e.sectionType;return{placeholder:f.ID.TITLE===t?"geostory.builder.defaults.htmlTitlePlaceholder":"geostory.builder.defaults.htmlPlaceholder",placeholderTag:f.ID.TITLE===t?"h1":"p"}})),(0,Xe.Z)("placeholder")))((function(e){var t=e.placeholder,n=e.placeholderTag,r=void 0===n?"p":n,o=e.id,a=e.toggleEditing,l=void 0===a?function(){}:a,c=e.html,u=e.mode;return i().createElement("div",{className:"ms-text-wrapper"},c!==f.gg&&i().createElement("div",{id:o,onClick:function(){return l(!0,c)},dangerouslySetInnerHTML:{__html:c}}),(!c||c===f.gg)&&u===f.nl.EDIT&&i().createElement("div",{className:"ms-text-placeholder",id:"placeholder"+o,onClick:function(){return l(!0,c===f.gg?"":c)},dangerouslySetInnerHTML:{__html:"<".concat(r,">").concat(t,"</").concat(r,">")}}))}));var Gt=n(882017),Wt=n(807472),zt=n(757588);function Ht(e){return Ht="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ht(e)}var Vt=["show","style","modal","draggable","closeGlyph","closable","onClose","title","header","footer","children"];function qt(){return qt=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},qt.apply(this,arguments)}function Yt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Qt(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Yt(Object(n),!0).forEach((function(t){Xt(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Yt(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Xt(e,t,n){return(t=function(e){var t=function(e,t){if("object"!==Ht(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!==Ht(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===Ht(t)?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const Kt=function(e){var t=e.show,n=e.style,r=void 0===n?{}:n,o=e.modal,a=e.draggable,l=void 0!==a&&a,c=e.closeGlyph,u=void 0===c?"1-close":c,s=e.closable,f=void 0===s||s,p=e.onClose,d=void 0===p?function(){}:p,y=e.title,m=e.header,b=e.footer,v=e.children,g=function(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}(e,Vt);return t?i().createElement(Wt.Z,qt({modal:o,onClickOut:f&&o?function(){return d()}:null,style:Qt(Qt({},r),{},{display:t?"block":"none"}),draggable:l},g),i().createElement("span",{role:"header"},y||m||i().createElement("span",null," "),f?i().createElement("button",{onClick:function(){return d()},className:"settings-panel-close close"},i().createElement(zt.Glyphicon,{glyph:u})):null),i().createElement("span",{role:"body"},v),b?i().createElement("span",{role:"footer"},b):null):null};var $t=n(282467),Jt=n(805346),en=n(399534),tn=(0,xe.branch)((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.src,n=void 0===t?"":t,r=e.viewHeight,o=e.size;return!n||!r||!o}),(0,Be.Z)((function(){return!0}),(function(){return{glyph:"code"}})));const nn=(0,xe.compose)(tn)((function(e){var t=e.src,n=e.size,r=e.viewHeight;return i().createElement("div",{className:"ms-webpage-wrapper"},i().createElement("iframe",{src:t,height:"".concat((0,f.t4)(n,r),"px")}))}));var rn=n(611847),on=n(737275),an=n(748759),ln=n(23279),cn=n.n(ln);function un(e){return un="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},un(e)}function sn(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function fn(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?sn(Object(n),!0).forEach((function(t){pn(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):sn(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function pn(e,t,n){return(t=function(e){var t=function(e,t){if("object"!==un(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!==un(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===un(t)?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function dn(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var yn=function(e){var t,n,r=e.id,a=e.onLoad,l=e.loading,c=e.debounceTime,u=e.children,s=e.loaderComponent,f=e.loaderStyle,p=(t=(0,an.YD)(),n=2,function(e){if(Array.isArray(e))return e}(t)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i,a,l=[],c=!0,u=!1;try{if(i=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=i.call(n)).done)&&(l.push(r.value),l.length!==t);c=!0);}catch(e){u=!0,o=e}finally{try{if(!c&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}(t,n)||function(e,t){if(e){if("string"==typeof e)return dn(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?dn(e,t):void 0}}(t,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),d=p[0],y=p[1],m=(0,o.useRef)(null),b=s;return(0,o.useEffect)((function(){return m.current=cn()((function(e){a(e)}),c),function(){m.current.cancel()}}),[]),(0,o.useEffect)((function(){y&&l&&m.current(r),!y&&l&&m.current.cancel()}),[y,l,r]),i().createElement("div",{ref:d,className:"ms-visibility-container"},l?b?i().createElement(b,{style:fn({},f)}):null:(0,o.cloneElement)(u,{inView:y}))};yn.propTypes={id:Qe().string,debounceTime:Qe().number,loading:Qe().bool,onLoad:Qe().func,loaderComponent:Qe().oneOfType([Qe().element,Qe().func])},yn.defaultProps={id:"",debounceTime:300,loading:!0,onLoad:function(){},loaderComponent:null};const mn=yn;var bn=n(532425);function vn(e){return vn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},vn(e)}function gn(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,En(r.key),r)}}function hn(e,t){return hn=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},hn(e,t)}function On(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function wn(e){return wn=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},wn(e)}function Sn(e,t,n){return(t=En(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function En(e){var t=function(e,t){if("object"!==vn(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!==vn(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===vn(t)?t:String(t)}var jn=function(){return i().createElement("div",{className:"ms-media-loader"},i().createElement(bn.Z,{size:52}))},Pn=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&hn(e,t)}(l,e);var t,n,r,o,a=(r=l,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=wn(r);if(o){var n=wn(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return function(e,t){if(t&&("object"===vn(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return On(e)}(this,e)});function l(){var e;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,l);for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return Sn(On(e=a.call.apply(a,[this].concat(n))),"state",{url:e.props.src||"",error:!1,loading:!0}),Sn(On(e),"updateURL",(function(t){var n=t.target.value;e.setState({url:n})})),Sn(On(e),"save",(function(){var t=e.state.url,n=!(0,rn.K2)(t,(0,on.u8)("GeoStoryValidIframeURLRegex"));e.setState({error:n}),n||e.props.onChange(t)})),e}return t=l,(n=[{key:"render",value:function(){var e=this,t=this.props,n=t.onClose,r=t.editURL,o=this.state,a=o.url,l=o.error;return i().createElement(i().Fragment,null,i().createElement(en.Z,null,i().createElement(Kt,{modal:!0,show:r,onClickOut:function(e){return e.preventDefault()&&e.stopPropagation()},title:i().createElement(Jt.Z,{msgId:"geostory.webPageCreator.title"}),onClose:n,id:"web-page-creator",footer:i().createElement($t.Z,{bsSize:"small",onClick:this.save},i().createElement(Jt.Z,{msgId:"geostory.webPageCreator.saveButton"}))},l&&i().createElement("div",{className:"dropzone-errorBox alert-danger"},i().createElement(Jt.Z,{msgId:"geostory.webPageCreator.error"})),i().createElement(zt.FormGroup,{controlId:"WEBPAGE_URL",validationState:l&&"error"},i().createElement(zt.ControlLabel,null,i().createElement(Jt.Z,{msgId:"geostory.webPageCreator.url.label"})),i().createElement(zt.FormControl,{label:"URL",type:"text",value:a,onChange:this.updateURL,required:!0})))),this.props.lazy?i().createElement(mn,{key:this.props.id,id:this.props.id,debounceTime:this.props.debounceTime,loading:this.state.loading,onLoad:function(){return e.setState({loading:!1})},loaderComponent:jn},i().createElement(nn,this.props)):i().createElement(nn,this.props))}}])&&gn(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),l}(i().PureComponent);Sn(Pn,"propTypes",{editURL:Qe().bool,onClose:Qe().func,onChange:Qe().func,src:Qe().string,id:Qe().string,debounceTime:Qe().number,lazy:Qe().bool}),Sn(Pn,"defaultProps",{lazy:!0});var Tn=(0,xe.compose)((0,xe.withHandlers)({onClose:function(e){var t=e.update,n=void 0===t?function(){}:t;return function(){return n("editURL",!1,"merge")}}}))(Pn);const Cn=(0,a.connect)(null,{onChange:y.YM})(Tn);var kn=["type"];function In(){return In=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},In.apply(this,arguments)}var An=function(e){var t=e.type;return i().createElement("div",{className:"ms-content ms-content-unknown"},'warning: unknown content type "'.concat(t,'"'))};const Dn=function(e){var t=e.type,n=function(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}(e,kn),r=function(e){switch(e){case f.bT.TEXT:return Ut;case f.bT.MEDIA:case f.Tr.IMAGE:case f.Tr.MAP:case f.Tr.VIDEO:return Gt.ZP;case f.bT.WEBPAGE:return Cn;default:return An}}(t);return i().createElement(r,In({type:t},n))};var xn=n(725288),Mn=n(80717),Rn=["onClick"];function Nn(e){return Nn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Nn(e)}function Ln(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Zn(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ln(Object(n),!0).forEach((function(t){Un(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ln(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function _n(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,Gn(r.key),r)}}function Fn(e,t){return Fn=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},Fn(e,t)}function Bn(e){return Bn=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Bn(e)}function Un(e,t,n){return(t=Gn(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Gn(e){var t=function(e,t){if("object"!==Nn(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!==Nn(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===Nn(t)?t:String(t)}var Wn=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Fn(e,t)}(l,e);var t,n,r,o,a=(r=l,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=Bn(r);if(o){var n=Bn(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return function(e,t){if(t&&("object"===Nn(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,e)});function l(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,l),a.apply(this,arguments)}return t=l,n=[{key:"UNSAFE_componentWillReceiveProps",value:function(e){!this.trigger||e.containerWidth===this.props.containerWidth&&e.containerHeight===this.props.containerHeight||this.trigger.hide()}},{key:"render",value:function(){var e=this;return i().createElement(xn.Z,{className:"add-bar",popoverClassName:"add-bar-popover",content:i().createElement(Mn.Z,{btnDefaultProps:{className:"square-button btn-tray"},buttons:this.props.buttons.map((function(t){var n=t.onClick,r=void 0===n?function(){}:n;return Zn(Zn({},function(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}(t,Rn)),{},{onClick:function(){for(var t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];r.apply(void 0,n),e.trigger.hide(),n[0]&&n[0].preventDefault&&n[0].preventDefault()}})}))}),ref:function(t){t&&(e.trigger=t.trigger)},placement:"top"},i().createElement($t.Z,{className:this.props.addButtonClassName},i().createElement(zt.Glyphicon,{glyph:"plus"})))}}],n&&_n(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),l}(i().Component);Un(Wn,"propTypes",{id:Qe().string,type:Qe().string,buttons:Qe().array,containerWidth:Qe().oneOfType([Qe().number,Qe().string]),containerHeight:Qe().oneOfType([Qe().number,Qe().string]),addButtonClassName:Qe().string}),Un(Wn,"defaultProps",{id:"",type:"",buttons:[],containerWidth:0,containerHeight:0,addButtonClassName:""});const zn=Wn;function Hn(e){return Hn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Hn(e)}var Vn=["id"];function qn(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Yn(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Qn(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Yn(Object(n),!0).forEach((function(t){Xn(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Yn(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Xn(e,t,n){return(t=function(e){var t=function(e,t){if("object"!==Hn(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!==Hn(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===Hn(t)?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Kn(){return Kn=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Kn.apply(this,arguments)}const $n=function(e){var t=e.viewWidth,n=e.viewHeight,r=e.className,o=e.contentProps,a=void 0===o?{}:o,l=e.addButtons,c=void 0===l?[]:l,u=e.tools,s=void 0===u?[]:u,p=e.contents,d=void 0===p?[]:p,y=e.ContentComponent,m=void 0===y?Dn:y,b=e.mode,v=e.sectionType,g=e.editMedia,h=void 0===g?function(){}:g,O=e.editWebPage,w=void 0===O?function(){}:O,S=e.add,E=void 0===S?function(){}:S,j=e.update,P=void 0===j?function(){}:j,T=e.remove,C=void 0===T?function(){}:T,k=e.bubblingTextEditing,I=void 0===k?function(){}:k,A=e.storyTheme,D=e.sections,x=void 0===D?[]:D,M=e.storyFonts,R=e.innerRef;return i().createElement("div",{ref:R,className:r},d.reduce((function(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],o=arguments.length>1?arguments[1]:void 0,l=o.id,u=function(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}(o,Vn),p=[i().createElement(m,Kn({id:l,key:"".concat(l,"-content"),mode:b,viewWidth:t,sectionType:v,viewHeight:n,editMedia:function(e){for(var t=e.path,n=void 0===t?"":t,r=arguments.length,o=new Array(r>1?r-1:0),i=1;i<r;i++)o[i-1]=arguments[i];return h.apply(void 0,[{path:'contents[{"id": "'.concat(l,'"}]')+n}].concat(o))},editWebPage:function(e){for(var t=e.path,n=void 0===t?"":t,r=arguments.length,o=new Array(r>1?r-1:0),i=1;i<r;i++)o[i-1]=arguments[i];return w.apply(void 0,[{path:'contents[{"id": "'.concat(l,'"}]')+n}].concat(o))},add:function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return E.apply(void 0,['contents[{"id": "'.concat(l,'"}].')+e].concat(n))},update:function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return P.apply(void 0,['contents[{"id": "'.concat(l,'"}].')+e].concat(n))},remove:function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return C.apply(void 0,['contents[{"id": "'.concat(l,'"}]')+(e?"."+e:"")].concat(n))}},a,u,{storyTheme:A,storyFonts:M,bubblingTextEditing:I,tools:s&&s[u.type],sections:x}))];return b===f.nl.EDIT&&c.length>0&&p.push(i().createElement(zn,{key:"".concat(l,"-content-add-buttons"),containerWidth:t,containerHeight:n,buttons:c.map((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Qn(Qn({},e),{},{onClick:function(){return E("contents",l,e.template)}})}))})),[].concat(function(e){if(Array.isArray(e))return qn(e)}(e=r)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return qn(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?qn(e,t):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}(),p)}),[]))};n(966337);var Jn=["onVisibilityChange","rootSelector"],er=["intersectionObserverOptions","onVisibilityChange"];function tr(){return tr=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},tr.apply(this,arguments)}function nr(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}const rr=function(e){return(0,xe.compose)((0,xe.withHandlers)({onVisibilityChange:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.id,n=e.onVisibilityChange,r=void 0===n?function(){}:n;return function(e,n){return r({id:t,visible:e,entry:n})}}}),function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.onVisibilityChange,n=(e.rootSelector,nr(e,Jn));return function(e){return function(r){var o=r.intersectionObserverOptions,a=void 0===o?{}:o,l=r.onVisibilityChange,c=nr(r,er),u=t||l;return i().createElement(an.df,tr({},n,a,{onChange:u}),(function(t){var n=t.inView,r=t.ref,o=t.entry;return i().createElement(e,tr({},c,{inView:n,inViewRef:r,inViewEntry:o}))}))}}}(e))};var or=n(90085),ir=n(212610),ar=n(313311),lr=n.n(ar),cr=n(623560),ur=n.n(cr),sr=n(618446),fr=n.n(sr);function pr(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i,a,l=[],c=!0,u=!1;try{if(i=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=i.call(n)).done)&&(l.push(r.value),l.length!==t);c=!0);}catch(e){u=!0,o=e}finally{try{if(!c&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}(e,t)||function(e,t){if(e){if("string"==typeof e)return dr(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?dr(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function dr(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var yr=(0,ir.Z)(zt.DropdownButton);function mr(e){var t=e.value,n=e.options,r=void 0===n?[]:n,a=e.onSelect,l=void 0===a?function(){}:a,c=e.glyph,u=void 0===c?"":c,s=e.tooltipId,f=e.pullRight,p=void 0!==f&&f,d=e.className,y=void 0===d?"square-button-md no-border":d,m=e.disabled,b=e.noTooltipWhenDisabled,v=void 0!==b&&b,g=e.hideMenuItem,h=void 0===g?function(){return!1}:g,O=e.shouldClose,w=e.showSelectionInTitle,S=void 0===w||w,E=pr((0,o.useState)(!1),2),P=E[0],T=E[1],C=pr((0,o.useState)(!1),2),k=C[0],I=C[1],A=(lr()(r,(function(e){return fr()(e.value,t)}))||{}).glyph;return(0,o.useEffect)((function(){m&&T(!1)}),[m]),i().createElement(yr,{noCaret:!0,open:P,noTooltipWhenDisabled:v,tooltipId:s,pullRight:p,className:y,disabled:m,title:i().createElement(zt.Glyphicon,{glyph:S&&A||u}),onToggle:function(e,n,r){return k||"select"===(null==r?void 0:r.source)||O&&!O(t,n)?null:T(e)}},r.map((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=(null==e?void 0:e.Component)||zt.MenuItem;return h(t,e)?null:i().createElement(n,{key:e.value,selected:t,value:e.value,active:ur()(null==e?void 0:e.isActive)&&e.isActive(t)||!j()(t)&&t===e.value,onClick:null!=e&&e.Component?l:function(){return l(e.value)},onActive:function(e){return I(e)}},e.label)})))}var br=n(312122),vr=n(911766),gr=n(513218),hr=n.n(gr);function Or(e){return Or="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Or(e)}function wr(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Sr(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?wr(Object(n),!0).forEach((function(t){Er(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):wr(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Er(e,t,n){return(t=function(e){var t=function(e,t){if("object"!==Or(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!==Or(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===Or(t)?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function jr(){return jr=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},jr.apply(this,arguments)}function Pr(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var Tr=(0,br.Z)(or.Z),Cr={primary:"btn-primary",default:"btn-default"},kr=function(e){var t=e.editMap,n=void 0!==t&&t,r=e.align,o=e.sectionType,a=e.size,l=e.update,c=void 0===l?function(){}:l,u=e.filterOptions,s=e.pullRight,f=e.sizeType,p=function(e,t){var n,r,o="horizontal",i="",a=(n=e&&e.split(",")||[],r=2,function(e){if(Array.isArray(e))return e}(n)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i,a,l=[],c=!0,u=!1;try{if(i=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=i.call(n)).done)&&(l.push(r.value),l.length!==t);c=!0);}catch(e){u=!0,o=e}finally{try{if(!c&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}(n,r)||function(e,t){if(e){if("string"==typeof e)return Pr(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Pr(e,t):void 0}}(n,r)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),l=a[0],c=a[1],u=e,s="resize-horizontal";return t===o?(i="h-",u=l):"vertical"===t&&(i="v-",u=c,s="resize-vertical"),{sizeProp:function(e){return t?"".concat(t===o?e:l,",").concat("vertical"===t?e:c):e},pre:i,_size:u,glyph:s}}(a,f),d=p.pre,y=p._size,m=p.glyph,b=p.sizeProp;return i().createElement(mr,jr({value:y,noTooltipWhenDisabled:!0,disabled:n,glyph:m,pullRight:s||("right"===r||y==="".concat(d,"full")||y==="".concat(d,"large"))&&!o,tooltipId:"geostory.contentToolbar.contentSize",options:[{value:"".concat(d,"small"),glyph:"size-small",label:i().createElement(Jt.Z,{msgId:"geostory.contentToolbar.smallSizeLabel"})},{value:"".concat(d,"medium"),glyph:"size-medium",label:i().createElement(Jt.Z,{msgId:"geostory.contentToolbar.mediumSizeLabel"})},{value:"".concat(d,"large"),glyph:"size-large",label:i().createElement(Jt.Z,{msgId:"geostory.contentToolbar.largeSizeLabel"})},{value:"".concat(d,"full"),glyph:"size-extra-large",label:i().createElement(Jt.Z,{msgId:"geostory.contentToolbar.fullSizeLabel"})}].filter((function(e){return!u||u(e)})),onSelect:function(e){return c("size",b(e))}},f&&{showSelectionInTitle:!1}))},Ir=function(e){var t=e.editMap,n=void 0!==t&&t,r=e.align,o=e.sectionType,a=e.size,l=e.update,c=void 0===l?function(){}:l;return i().createElement(mr,{value:r,noTooltipWhenDisabled:!0,disabled:"full"===a||n,glyph:"align-center",pullRight:("right"===r||"full"===a||"large"===a)&&!o,tooltipId:"geostory.contentToolbar.contentAlign",options:[{value:"left",label:i().createElement(Jt.Z,{msgId:"geostory.contentToolbar.leftAlignLabel"}),glyph:"align-left"},{value:"center",label:i().createElement(Jt.Z,{msgId:"geostory.contentToolbar.centerAlignLabel"}),glyph:"align-center"},{value:"right",label:i().createElement(Jt.Z,{msgId:"geostory.contentToolbar.rightAlignLabel"}),glyph:"align-right"}],onSelect:function(e){return c("align",e)}})},Ar=function(e){var t=e.editMap,n=void 0!==t&&t,r=e.theme,o=e.storyTheme,a=e.align,l=e.sectionType,c=e.update,u=void 0===c?function(){}:c,s=e.themeProps,f=e.size;return i().createElement(mr,{value:r,noTooltipWhenDisabled:!0,pullRight:("right"===a||"full"===f||"large"===f)&&!l,glyph:"dropper",tooltipId:"geostory.contentToolbar.contentTheme",disabled:n,shouldClose:function(e,t){var n,r;return hr()(e)&&"ms-color-picker-cover"!==(null==t||null===(n=t.target)||void 0===n||null===(r=n.getAttribute)||void 0===r?void 0:r.call(n,"class"))||S()(e)||void 0===e},hideMenuItem:function(e,t){return"custom"===(null==e?void 0:e.value)&&"custom"!==(null==t?void 0:t.value)},options:[{value:"",isActive:function(e){return void 0===e||""===e||hr()(e)&&(void 0===e.value||""===e.value)},label:i().createElement(Jt.Z,{msgId:"geostory.contentToolbar.defaultThemeLabel"})},{value:"bright",isActive:function(e){return"bright"===(null==e?void 0:e.value)||"bright"===e},label:i().createElement(Jt.Z,{msgId:"geostory.contentToolbar.brightThemeLabel"})},{value:"dark",isActive:function(e){return"dark"===(null==e?void 0:e.value)||"dark"===e},label:i().createElement(Jt.Z,{msgId:"geostory.contentToolbar.darkThemeLabel"})},{value:"custom",Component:function(e){return i().createElement(vr.H,jr({},e,{disableBackgroundAlpha:null==s?void 0:s.disableBackgroundAlpha,disableShadow:null==s?void 0:s.disableShadow,disableTextColor:null==s?void 0:s.disableTextColor,onUpdate:u,storyTheme:o}))}}],onSelect:function(e){return u("theme",Sr(Sr({},hr()(r)&&r),{},{value:e}))}})},Dr=function(e){var t=e.editMap,n=void 0!==t&&t,r=e.forceDelBtnDisable,o=void 0!==r&&r,a=e.path,l=e.remove,c=void 0===l?function(){}:l,u=e.bsStyle;return i().createElement(Tr,{glyph:"trash",visible:!0,noTooltipWhenDisabled:!0,disabled:n||o,className:"".concat("square-button-md no-border"," ").concat(u&&Cr[u]),tooltipId:"geostory.contentToolbar.remove",confirmTitle:i().createElement(Jt.Z,{msgId:"geostory.contentToolbar.removeConfirmTitle"}),confirmContent:i().createElement(Jt.Z,{msgId:"geostory.contentToolbar.removeConfirmContent"}),onClick:function(){c(a)}})},xr=n(455877),Mr=n.n(xr);function Rr(e){return Rr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Rr(e)}var Nr=["editMap","map","update"],Lr=["tools","children"];function Zr(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function _r(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Zr(Object(n),!0).forEach((function(t){Fr(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Zr(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Fr(e,t,n){return(t=function(e){var t=function(e,t){if("object"!==Rr(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!==Rr(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===Rr(t)?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Br(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}var Ur={size:function(e){return{renderButton:i().createElement(kr,e)}},align:function(e){return{renderButton:i().createElement(Ir,e)}},theme:function(e){return{renderButton:i().createElement(Ar,e)}},fit:function(e){var t=e.editMap,n=void 0!==t&&t,r=e.fit,o=e.update,i=void 0===o?function(){}:o;return{value:r,glyph:"contain"===r?"fit-cover":"fit-contain",disabled:n,visible:!0,tooltipId:"contain"===r?"geostory.contentToolbar.cover":"geostory.contentToolbar.fit",onClick:function(){return i("fit","contain"===r?"cover":"contain")}}},cover:function(e){var t=e.editMap,n=void 0!==t&&t,r=e.cover,o=e.updateSection,i=void 0===o?function(){}:o;return{value:r,glyph:r?"height-auto":"height-view",visible:!0,disabled:n,tooltipId:r?"geostory.contentToolbar.contentHeightAuto":"geostory.contentToolbar.contentHeightView",onClick:function(){return i({cover:!r},"merge")}}},editMedia:function(e){var t=e.editMap,n=void 0!==t&&t,r=e.path,o=e.editMedia,i=void 0===o?function(){}:o,a=e.sectionType;return{glyph:"pencil","data-button":"pencil",visible:!0,disabled:n,tooltipId:"geostory.contentToolbar.editMedia",onClick:function(){i({path:r},r?a:"")}}},remove:function(e){return{renderButton:i().createElement(Dr,e)}},editMap:function(e){var t=e.editMap,n=void 0!==t&&t,r=e.map,o=e.update,i=void 0===o?function(){}:o,a=Br(e,Nr);return{glyph:"map-edit",visible:!0,disabled:n,bsStyle:n?"success":"default",tooltipId:"geostory.contentToolbar.editMap",onClick:function(){var e=null!=r?r:a,t=e.center,o=e.zoom,l=e.resolution;i("editMap",!n),!n&&i("map",{center:t,zoom:o,mapStateSource:Mr()(),resolution:l,resetPanAndZoom:!1},"merge")}}},editURL:function(e){var t=e.editURL,n=void 0!==t&&t,r=e.path,o=e.editWebPage,i=void 0===o?function(){}:o;return{glyph:"pencil",visible:!0,disabled:n,bsStyle:n?"success":"default",tooltipId:"geostory.contentToolbar.editURL",onClick:function(){i({path:r})}}},muted:function(e){var t=e.update,n=e.muted;return{glyph:n?"muted":"audio",visible:!0,active:!n,tooltipId:n?"geostory.contentToolbar.enableAudio":"geostory.contentToolbar.disableAudio",onClick:function(){t("muted",!n)}}},autoplay:function(e){var t=e.update,n=e.autoplay;return{glyph:"play-circle",visible:!("cover"===e.fit),active:n,tooltipId:n?"geostory.contentToolbar.disableAutoplay":"geostory.contentToolbar.enableAutoplay",onClick:function(){t("autoplay",!n)}}},loop:function(e){var t=e.update,n=e.loop;return{glyph:"loop",visible:!("cover"===e.fit),active:n,tooltipId:n?"geostory.contentToolbar.disableLoop":"geostory.contentToolbar.enableLoop",onClick:function(){t("loop",!n)}}},showCaption:function(e){var t=e.editMap,n=void 0!==t&&t,r=e.update,o=e.showCaption,i=e.caption,a=e.description;return{glyph:"caption",visible:!(!i&&!a),disabled:n,active:!(!o||n),tooltipId:o?"geostory.contentToolbar.hideCaption":"geostory.contentToolbar.showCaption",onClick:function(){r("showCaption",!o)}}},add:function(e){var t=e.editMap,n=void 0!==t&&t,r=e.addDisabled,o=void 0!==r&&r,i=e.add,a=void 0===i?function(){}:i,l=e.bsStyle;return{glyph:"plus",visible:!0,bsStyle:void 0===l?"default":l,tooltipId:"geostory.contentToolbar.add",disabled:n||o,onClick:a}},edit:function(e){var t=e.editMap,n=void 0!==t&&t,r=e.edit,o=void 0===r?function(){}:r,i=e.bsStyle;return{glyph:"pencil",visible:!0,bsStyle:void 0===i?"default":i,tooltipId:"geostory.contentToolbar.edit",disabled:n,onClick:o}},marker:function(e){var t=e.editMap,n=void 0!==t&&t,r=e.markerDisabled,o=void 0!==r&&r,i=e.marker,a=void 0===i?function(){}:i,l=e.bsStyle;return{glyph:"map-marker",visible:!0,tooltipId:"geostory.contentToolbar.marker",bsStyle:void 0===l?"default":l,disabled:n||o,onClick:a}},closeDraw:function(e){var t=e.editMap,n=void 0!==t&&t,r=e.bsStyle,o=void 0===r?"default":r,i=e.update,a=void 0===i?function(){}:i,l=e.onEnableDraw,c=void 0===l?function(){}:l;return{glyph:"1-close",visible:!0,tooltipId:"geostory.contentToolbar.closeMapEditing",bsStyle:o,disabled:!n,onClick:function(){c(null),a("editMap",!n)}}}};function Gr(e){var t=e.tools,n=void 0===t?[]:t,r=e.children,o=Br(e,Lr);return i().createElement("div",{className:"ms-content-toolbar"},i().createElement(Mn.Z,{btnDefaultProps:{className:"square-button-md no-border",noTooltipWhenDisabled:!0},buttons:n.filter((function(e){return(null==e?void 0:e.id)&&Ur[e.id]||Ur[e]})).map((function(e){return(null==e?void 0:e.id)&&Ur[e.id](_r(_r({},o),e))||Ur[e](o)}))}),r)}function Wr(e){return Wr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Wr(e)}var zr=["id","inViewRef","innerRef","children","type","contentWrapperStyle","contentToolbar","mode"];function Hr(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Vr(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Hr(Object(n),!0).forEach((function(t){qr(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Hr(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function qr(e,t,n){return(t=function(e){var t=function(e,t){if("object"!==Wr(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!==Wr(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===Wr(t)?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const Yr=function(e){var t=e.id,n=e.inViewRef,r=e.innerRef,o=e.children,a=e.type,l=e.contentWrapperStyle,c=e.contentToolbar,u=e.mode,s=function(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}(e,zr),p=c||Gr;return i().createElement("div",{id:t,ref:n,style:Vr(Vr({},l),s.hideContent&&{display:"none"}),className:"ms-content ms-content-".concat(a).concat((0,f.w)(s))},i().createElement("div",{className:"ms-content-body",ref:r,style:(0,f.cy)(s)},u===f.nl.EDIT&&i().createElement(p,s),o))};function Qr(e){return Qr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Qr(e)}function Xr(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Kr(e,t,n){return(t=function(e){var t=function(e,t){if("object"!==Qr(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!==Qr(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===Qr(t)?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var $r=(0,xe.compose)(function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return function(e){return xe.nest.apply(void 0,t.concat([e]))}}(Yr),(0,xe.setDisplayName)("ColumnContent"))(Dn),Jr=function(e){return function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Xr(Object(n),!0).forEach((function(t){Kr(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Xr(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({id:"size",filterOptions:function(e){return"full"!==e.value},pullRight:e},arguments.length>1&&void 0!==arguments[1]?arguments[1]:{})};const eo=(0,xe.compose)((0,xe.branch)((function(e){var t=e.type,n=e.sectionType;return[f.ID.IMMERSIVE,f.ID.CAROUSEL].includes(n)&&t===f.bT.COLUMN}),rr({threshold:[0,.25,.5,.75]})),function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return function(e){return xe.nest.apply(void 0,t.concat([e]))}}(Yr),(0,xe.setDisplayName)("SectionContent"),(0,xe.branch)((function(e){return e.type===f.bT.COLUMN}),(0,xe.renderComponent)((function(e){var t,n=e.viewWidth,r=e.viewHeight,o=e.contents,a=void 0===o?[]:o,l=e.mode,c=e.add,u=void 0===c?function(){}:c,s=e.editMedia,p=void 0===s?function(){}:s,d=e.editWebPage,y=void 0===d?function(){}:d,m=e.update,b=void 0===m?function(){}:m,v=e.remove,g=void 0===v?function(){}:v,h=e.bubblingTextEditing,O=void 0===h?function(){}:h,w=e.expandable,S=e.mediaViewer,E=e.contentToolbar,j=e.sections,P=void 0===j?[]:j,T=e.sectionType,C=e.overrideTools,k=void 0===C?function(e){return e}:C,I=e.storyFonts;return i().createElement($n,{className:"ms-column-contents",ContentComponent:$r,contents:a,mode:l,add:u,editMedia:p,editWebPage:y,update:b,remove:g,viewWidth:n,viewHeight:r,bubblingTextEditing:O,sectionType:T,contentProps:{expandable:w,mediaViewer:S,contentToolbar:E},sections:P,storyFonts:I,tools:k((t={},Kr(t,f.bT.TEXT,["remove"]),Kr(t,f.Tr.IMAGE,["editMedia",Jr(),"showCaption","remove"]),Kr(t,f.Tr.MAP,["editMedia","editMap",Jr(!0),"showCaption","remove"]),Kr(t,f.bT.WEBPAGE,[Jr(!0,{sizeType:"horizontal"}),"editURL",Jr(!0,{sizeType:"vertical",filterOptions:function(e){return"v-full"!==e.value}}),"remove"]),Kr(t,f.Tr.VIDEO,["editMedia","muted","autoplay","loop","showCaption","remove"]),t)),addButtons:[{glyph:"sheet",tooltipId:"geostory.addTextContent",template:f.bT.TEXT},{glyph:"picture",tooltipId:"geostory.addMediaContent",template:f.bT.MEDIA},{glyph:"webpage",tooltipId:"geostory.addWebPageContent",template:f.bT.WEBPAGE}]})}))))(Dn),to=(0,xe.compose)((0,xe.defaultProps)({ContentComponent:eo}),(0,xe.withHandlers)({editMedia:function(e){var t=e.editMedia,n=void 0===t?function(){}:t,r=e.sectionId;return function(e){for(var t=e.path,o=arguments.length,i=new Array(o>1?o-1:0),a=1;a<o;a++)i[a-1]=arguments[a];return n.apply(void 0,[{path:'sections[{"id": "'.concat(r,'"}].')+t}].concat(i))}},editWebPage:function(e){var t=e.editWebPage,n=void 0===t?function(){}:t,r=e.sectionId;return function(e){for(var t=e.path,o=arguments.length,i=new Array(o>1?o-1:0),a=1;a<o;a++)i[a-1]=arguments[a];return n.apply(void 0,[{path:'sections[{"id": "'.concat(r,'"}].')+t}].concat(i))}},add:function(e){var t=e.add,n=void 0===t?function(){}:t,r=e.sectionId;return function(e){for(var t=arguments.length,o=new Array(t>1?t-1:0),i=1;i<t;i++)o[i-1]=arguments[i];return n.apply(void 0,['sections[{"id": "'.concat(r,'"}].')+e].concat(o))}},update:function(e){var t=e.update,n=void 0===t?function(){}:t,r=e.sectionId;return function(e){for(var t=arguments.length,o=new Array(t>1?t-1:0),i=1;i<t;i++)o[i-1]=arguments[i];return n.apply(void 0,['sections[{"id": "'.concat(r,'"}].')+e].concat(o))}},remove:function(e){var t=e.remove,n=void 0===t?function(){}:t,r=e.sectionId;return function(e){for(var t=arguments.length,o=new Array(t>1?t-1:0),i=1;i<t;i++)o[i-1]=arguments[i];return n.apply(void 0,['sections[{"id": "'.concat(r,'"}].')+e].concat(o))}}}),(0,xe.setDisplayName)("SectionContents"))($n);var no=n(630998),ro=n.n(no),oo=n(84753),io=n.n(oo);function ao(e){return ao="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ao(e)}function lo(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function co(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function uo(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?co(Object(n),!0).forEach((function(t){so(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):co(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function so(e,t,n){return(t=function(e){var t=function(e,t){if("object"!==ao(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!==ao(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===ao(t)?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}(0,xe.setObservableConfig)(Me.Z);var fo=function(e,t){var n=ro()(e,{id:t});return e[-1!==n&&n?n:0]},po=(0,xe.withProps)((function(e){var t=e.id,n=e.backgroundId,r=e.contents,o=fo(void 0===r?[]:r,n)||{},i=o&&o.id;return{background:A()(o,"background")||{type:"none"},contentId:i,sectionId:t,path:'sections[{"id": "'.concat(t,'"}].contents[{"id": "').concat(i,'"}].background')}})),yo=(0,xe.withHandlers)({updateBackground:function(e){var t=e.sectionId,n=e.contentId,r=e.update,o=void 0===r?function(){}:r;return function(e){for(var r=arguments.length,i=new Array(r>1?r-1:0),a=1;a<r;a++)i[a-1]=arguments[a];return o.apply(void 0,['sections[{"id": "'.concat(t,'"}].contents[{"id": "').concat(n,'"}].background.')+e].concat(i))}},updateSection:function(e){var t=e.sectionId,n=e.update,r=void 0===n?function(){}:n;return function(){for(var e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return r.apply(void 0,['sections[{"id": "'.concat(t,'"}]')].concat(n))}}}),mo=(0,xe.compose)(po,yo),bo=(0,xe.mapPropsStream)((function(e){var t=(0,xe.createEventHandler)(),n=t.handler,r=t.stream;return b.Observable.combineLatest(e,function(e,t){var n=e.scan((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0,n=t.id,r=t.visible,o=t.entry;return uo(uo({},e),{},so({},n,{visible:r,entry:o}))}),{}).debounceTime(100).map((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{maxItem:io()(Object.keys(e),(function(t){return e[t].visible?A()(e[t],"entry.intersectionRatio"):-1/0})),items:e}}));return b.Observable.merge(n.pluck("maxItem").distinctUntilChanged().map((function(e){return{backgroundId:e}})),n.map((function(e){var t=e.maxItem,n=e.items;return 0===A()(n[t],"entry.intersectionRatio")?"EMPTY":t})).withLatestFrom(t.pluck("updateCurrentPage")).do((function(e){var t,n,r=(n=2,function(e){if(Array.isArray(e))return e}(t=e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i,a,l=[],c=!0,u=!1;try{if(i=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=i.call(n)).done)&&(l.push(r.value),l.length!==t);c=!0);}catch(e){u=!0,o=e}finally{try{if(!c&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}(t,n)||function(e,t){if(e){if("string"==typeof e)return lo(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?lo(e,t):void 0}}(t,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),o=r[0],i=r[1];return i&&i({columnId:o})})).ignoreElements())}(r,e).startWith({}),(function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return uo(uo({},t.reduce((function(){var e=arguments.length>1?arguments[1]:void 0;return uo(uo({},arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}),e)}),{})),{},{onVisibilityChange:n})}))}));const vo=(0,xe.compose)(bo,mo);var go=n(689438);function ho(e){return ho="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ho(e)}function Oo(){return Oo=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Oo.apply(this,arguments)}function wo(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function So(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?wo(Object(n),!0).forEach((function(t){Co(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):wo(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Eo(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,ko(r.key),r)}}function jo(e,t){return jo=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},jo(e,t)}function Po(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function To(e){return To=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},To(e)}function Co(e,t,n){return(t=ko(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function ko(e){var t=function(e,t){if("object"!==ho(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!==ho(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===ho(t)?t:String(t)}var Io=n(569334),Ao=n(683255),Do=n.n(Ao);function xo(e){return xo="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},xo(e)}function Mo(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Ro(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Mo(Object(n),!0).forEach((function(t){Fo(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Mo(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function No(){return No=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},No.apply(this,arguments)}function Lo(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,Bo(r.key),r)}}function Zo(e,t){return Zo=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},Zo(e,t)}function _o(e){return _o=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},_o(e)}function Fo(e,t,n){return(t=Bo(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Bo(e){var t=function(e,t){if("object"!==xo(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!==xo(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===xo(t)?t:String(t)}var Uo=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Zo(e,t)}(l,e);var t,n,r,o,a=(r=l,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=_o(r);if(o){var n=_o(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return function(e,t){if(t&&("object"===xo(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,e)});function l(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,l),a.apply(this,arguments)}return t=l,(n=[{key:"render",value:function(){var e=(0,f.cy)(this.props),t=!this.props.disableToolbarPortal&&this.refs&&this.refs.div&&this.refs.div.parentNode,n=this.props.sectionType===f.ID.TITLE?["editMedia","cover"]:["editMedia"],r=this.props.contentToolbar||Gr,o=i().createElement(r,No({},this.props,{themeProps:{disableBackgroundAlpha:!0,disableTextColor:!0,disableShadow:!0},tools:this.props.tools&&this.props.type&&this.props.tools[this.props.type]||this.props.sectionType===f.ID.BANNER&&[].concat(n,["cover","remove"])||n}),this.props.contentToolbarChildren),a="".concat(this.props.sectionId||"ms","-media-").concat(this.props.id||this.props.resourceId);return i().createElement("div",{ref:"div",className:"ms-section-background",style:Ro({},this.props.style)},i().createElement("div",{className:"ms-section-background-container".concat((0,f.w)(this.props)),ref:this.props.innerRef,style:Ro(Ro({height:this.props.height},e),null!==Gt.Ln&&void 0!==Gt.Ln&&Gt.Ln[this.props.type]?{}:this.props.backgroundPlaceholder)},i().createElement(Gt.ZP,No({id:a},this.props,{enableFullscreen:!1,descriptionEnabled:!1,mediaViewer:this.props.mediaViewer,containerInView:this.props.inView}),this.props.children),this.props.mode===f.nl.EDIT&&(t?i().createElement(Io.h_,{container:t},o):o)))}}])&&Lo(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),l}(o.Component);Fo(Uo,"propTypes",{id:Qe().string,resourceId:Qe().string,sectionId:Qe().string,mode:Qe().string,fit:Qe().string,size:Qe().string,path:Qe().string,credits:Qe().string,description:Qe().string,height:Qe().number,width:Qe().number,tools:Qe().object,style:Qe().object,add:Qe().func,editMedia:Qe().func,update:Qe().func,updateSection:Qe().func,remove:Qe().func,type:Qe().oneOf(f.lg.MediaTypes),disableToolbarPortal:Qe().bool,backgroundPlaceholder:Qe().object,sectionType:Qe().string,src:Qe().string,theme:Qe().string,mediaViewer:Qe().func,contentToolbar:Qe().func,inView:Qe().bool,sections:Qe().array,innerRef:Qe().oneOfType([Qe().func,Qe().object]),contentToolbarChildren:Qe().node}),Fo(Uo,"defaultProps",{height:0,size:"full",width:0,style:{},backgroundPlaceholder:{background:"url(".concat(Do(),")"),backgroundSize:"256px auto"}});const Go=(Wo=Uo,zo=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&jo(e,t)}(l,e);var t,n,r,o,a=(r=l,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=To(r);if(o){var n=To(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return function(e,t){if(t&&("object"===ho(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return Po(e)}(this,e)});function l(){var e;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,l);for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return Co(Po(e=a.call.apply(a,[this].concat(n))),"state",{style:{}}),Co(Po(e),"update",(function(t){if(e._stickybits){var n=document.querySelector(t);-1===e._stickybits.definePosition().indexOf("sticky")&&n&&(e._stickybits.update(),setTimeout((function(){var t=n.getBoundingClientRect(),r=t.top,o=t.left;e.setState({style:{top:r,left:o,width:n.scrollWidth-2}})})))}})),e}return t=l,(n=[{key:"componentDidMount",value:function(){this._stickybits=this._node&&(0,go.Z)(this._node,{scrollEl:this.props.scrollContainerSelector,noStyles:!0,useGetBoundingClientRect:!0}),this.update(this.props.scrollContainerSelector)}},{key:"componentWillReceiveProps",value:function(e){!this._stickybits||e.viewWidth===this.props.viewWidth&&e.viewHeight===this.props.viewHeight||this.update(e.scrollContainerSelector)}},{key:"componentWillUnmount",value:function(){this._stickybits&&this._stickybits.cleanup()}},{key:"render",value:function(){var e=this;return i().createElement(Wo,Oo({ref:function(t){t&&t.refs&&t.refs[e.props.refId]&&(e._node=t.refs[e.props.refId])},style:So({},this.state.style)},this.props),this.props.children)}}])&&Eo(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),l}(o.Component),Co(zo,"propTypes",{scrollContainerSelector:Qe().string,height:Qe().number,width:Qe().number,refId:Qe().string}),Co(zo,"defaultProps",{scrollContainerSelector:"body",height:0,width:0,refId:"div"}),zo);var Wo,zo,Ho=n(911636),Vo=n.n(Ho);function qo(e){return qo="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},qo(e)}function Yo(){return Yo=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Yo.apply(this,arguments)}function Qo(e,t,n){return(t=function(e){var t=function(e,t){if("object"!==qo(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!==qo(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===qo(t)?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const Xo=(0,xe.compose)(vo,(0,xe.withStateHandlers)({textEditorActive:!1},{bubblingTextEditing:function(){return function(e){return{textEditorActiveClass:e?" ms-text-editor-active":""}}}}))((function(e){var t,n=e.add,r=void 0===n?function(){}:n,o=e.editMedia,a=void 0===o?function(){}:o,l=e.editWebPage,c=void 0===l?function(){}:l,u=e.onVisibilityChange,s=void 0===u?function(){}:u,p=e.update,d=void 0===p?function(){}:p,y=e.updateBackground,m=void 0===y?function(){}:y,b=e.updateCurrentPage,v=void 0===b?function(){}:b,g=e.remove,h=void 0===g?function(){}:g,O=e.id,w=e.background,S=void 0===w?{}:w,E=e.path,j=e.contents,P=void 0===j?[]:j,T=e.mode,C=e.sectionType,k=e.inViewRef,I=e.viewWidth,D=e.viewHeight,x=e.focusedContent,M=e.contentId,R=e.bubblingTextEditing,N=void 0===R?function(){}:R,L=e.textEditorActiveClass,Z=void 0===L?"":L,_=e.expandableMedia,F=void 0!==_&&_,B=e.storyTheme,U=e.mediaViewer,G=e.contentToolbar,W=e.inView,z=e.sections,H=void 0===z?[]:z,V=e.storyFonts,q=x&&x.hideContent&&A()(x,"target.id")===M,Y=q?"hidden":"visible",Q=F&&S&&"map"===S.type?" ms-expandable-background":"",X=(null==B?void 0:B.overlay)||{},K=(null==B?void 0:B.general)||{};return i().createElement("section",{className:"ms-section ms-section-immersive".concat(Q),id:O,ref:k},i().createElement(Go,Yo({},S,{mode:T,disableToolbarPortal:!0,tools:(t={},Qo(t,f.Tr.IMAGE,["editMedia","fit","size","align","theme"]),Qo(t,f.Tr.MAP,["editMedia","editMap","size","align","theme"]),Qo(t,f.Tr.VIDEO,["editMedia","fit","size","align","theme","muted","autoplay","loop"]),t),scrollContainerSelector:"#ms-sections-container",add:r,editMedia:a,expandable:F,path:E,update:m,updateCurrentPage:v,remove:h,sectionType:C,sectionId:O,backgroundId:S.id,key:S.id,width:I,height:D,backgroundPlaceholder:{background:"url(".concat(Vo(),")"),backgroundSize:"600px auto"},storyTheme:K,mediaViewer:U,contentToolbar:G,inView:W})),i().createElement(to,{tools:Qo({},f.bT.COLUMN,["size","align","theme"]),className:"ms-section-contents".concat(Z),contents:P,mode:T,add:r,updateCurrentPage:v,editMedia:a,editWebPage:c,update:d,remove:h,sectionId:O,viewWidth:I,viewHeight:D,contentProps:{onVisibilityChange:s,contentWrapperStyle:{minHeight:D,visibility:Y},expandable:F,mediaViewer:U,contentToolbar:G},focusedContent:x,bubblingTextEditing:N,sectionType:C,storyTheme:X,sections:H,storyFonts:V}),T===f.nl.EDIT&&!q&&i().createElement(zn,{containerWidth:I,containerHeight:D,buttons:[{glyph:"story-title-section",tooltipId:"geostory.addTitleSection",onClick:function(){r("sections",O,f.ID.TITLE)}},{glyph:"story-banner-section",tooltipId:"geostory.addBannerSection",onClick:function(){r("sections",O,f.ID.BANNER)}},{glyph:"story-paragraph-section",tooltipId:"geostory.addParagraphSection",onClick:function(){r("sections",O,f.ID.PARAGRAPH)}},{glyph:"story-immersive-content",tooltipId:"geostory.addImmersiveContent",onClick:function(){r('sections[{"id": "'.concat(O,'"}].contents'),void 0,f.bT.COLUMN,"geostory.builder.defaults.titleImmersiveContent")}},{glyph:"story-carousel-section",tooltipId:"geostory.addGeocarouselSection",onClick:function(){r("sections",O,f.ID.CAROUSEL)}},{glyph:"story-media-section",tooltipId:"geostory.addMediaSection",onClick:function(){r("sections",O,f.tQ.MEDIA)}},{glyph:"story-webpage-section",tooltipId:"geostory.addWebPageSection",onClick:function(){r("sections",O,f.tQ.WEBPAGE)}}]}))}));function Ko(e){return Ko="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ko(e)}function $o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Jo(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?$o(Object(n),!0).forEach((function(t){ei(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):$o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function ei(e,t,n){return(t=function(e){var t=function(e,t){if("object"!==Ko(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!==Ko(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===Ko(t)?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const ti=function(e){var t=e.id,n=e.contents,r=e.mode,o=e.add,a=void 0===o?function(){}:o,l=e.update,c=void 0===l?function(){}:l,u=e.editMedia,s=void 0===u?function(){}:u,p=e.editWebPage,d=void 0===p?function(){}:p,y=e.remove,m=void 0===y?function(){}:y,b=e.inViewRef,v=e.viewWidth,g=e.viewHeight,h=e.expandableMedia,O=e.mediaViewer,w=e.contentToolbar,S=e.sections,E=void 0===S?[]:S,j=e.sectionType,P=e.storyFonts;return i().createElement("section",{className:"ms-section ms-section-paragraph",id:t,ref:b},i().createElement(to,{className:"ms-section-contents",contents:n,mode:r,add:a,editMedia:s,editWebPage:d,update:c,remove:m,sectionId:t,viewWidth:v,viewHeight:g,sectionType:j,contentProps:{expandable:h,mediaViewer:O,contentToolbar:w,overrideTools:function(e){return Jo(Jo({},e),{},ei({},f.bT.TEXT,[(!0,{id:"size",filterOptions:function(e){return"full"!==e.value},pullRight:true}),"remove"]))}},sections:E,storyFonts:P}),r===f.nl.EDIT&&i().createElement(zn,{containerWidth:v,containerHeight:g,buttons:[{glyph:"story-title-section",tooltipId:"geostory.addTitleSection",onClick:function(){a("sections",t,f.ID.TITLE)}},{glyph:"story-banner-section",tooltipId:"geostory.addBannerSection",onClick:function(){a("sections",t,f.ID.BANNER)}},{glyph:"story-paragraph-section",tooltipId:"geostory.addParagraphSection",onClick:function(){a("sections",t,f.ID.PARAGRAPH)}},{glyph:"story-immersive-section",tooltipId:"geostory.addImmersiveSection",onClick:function(){a("sections",t,f.ID.IMMERSIVE)}},{glyph:"story-carousel-section",tooltipId:"geostory.addGeocarouselSection",onClick:function(){a("sections",t,f.ID.CAROUSEL)}},{glyph:"story-media-section",tooltipId:"geostory.addMediaSection",onClick:function(){a("sections",t,f.tQ.MEDIA)}},{glyph:"story-webpage-section",tooltipId:"geostory.addWebPageSection",onClick:function(){a("sections",t,f.tQ.WEBPAGE)}}]}))};var ni=n(875492),ri=n.n(ni);function oi(e){return oi="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},oi(e)}function ii(){return ii=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},ii.apply(this,arguments)}function ai(e,t,n){return(t=function(e){var t=function(e,t){if("object"!==oi(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!==oi(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===oi(t)?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const li=(0,xe.compose)(mo,(0,xe.withStateHandlers)({textEditorActive:!1},{bubblingTextEditing:function(){return function(e){return{textEditorActiveClass:e?" ms-text-editor-active":""}}}}))((function(e){var t=e.id,n=e.background,r=void 0===n?{}:n,o=e.contents,a=void 0===o?[]:o,l=e.mode,c=e.contentId,u=e.path,s=e.sectionType,p=e.cover,d=e.viewWidth,y=e.viewHeight,m=e.inViewRef,b=e.add,v=void 0===b?function(){}:b,g=e.update,h=void 0===g?function(){}:g,O=e.updateSection,w=void 0===O?function(){}:O,S=e.remove,E=void 0===S?function(){}:S,j=e.updateBackground,P=void 0===j?function(){}:j,T=e.editMedia,C=void 0===T?function(){}:T,k=e.focusedContent,I=e.bubblingTextEditing,D=void 0===I?function(){}:I,x=e.textEditorActiveClass,M=void 0===x?"":x,R=e.expandableMedia,N=void 0!==R&&R,L=e.storyTheme,Z=e.mediaViewer,_=e.contentToolbar,F=e.inView,B=e.sections,U=void 0===B?[]:B,G=e.storyFonts,W=A()(k,"target.id")===c,z=W?"hidden":"visible",H=N&&r&&"map"===r.type?" ms-expandable-background":"",V=(null==L?void 0:L.overlay)||{},q=(null==L?void 0:L.general)||{};return i().createElement("section",{ref:m,className:"ms-section ms-section-title".concat(H),id:t},i().createElement(De.Z,null,(function(e){var t,n=e.height;return i().createElement(Go,ii({},r,{scrollContainerSelector:"#ms-sections-container",key:r.id,mode:l,id:c,path:u,update:P,add:v,editMedia:C,expandable:N,updateSection:w,cover:p,remove:E,width:d,sectionType:s,backgroundPlaceholder:{background:"url(".concat(p?Do():ri(),")"),backgroundSize:"".concat(p?64:600,"px auto")},tools:(t={},ai(t,f.Tr.IMAGE,["editMedia","cover","fit","size","align","theme"]),ai(t,f.Tr.MAP,["editMedia","cover","editMap","size","align","theme"]),ai(t,f.Tr.VIDEO,["editMedia","cover","fit","size","align","theme","muted","autoplay","loop"]),t),height:n>=y?y:n,storyTheme:q,mediaViewer:Z,contentToolbar:_,inView:F}))})),i().createElement(to,{className:"ms-section-contents".concat(M),contents:a,mode:l,add:v,sectionType:s,update:h,remove:E,sectionId:t,contentProps:{contentWrapperStyle:p?{minHeight:y,visibility:z}:{visibility:z},mediaViewer:Z,contentToolbar:_},tools:ai({},f.bT.TEXT,["size","align","theme","remove"]),focusedContent:k,bubblingTextEditing:D,storyTheme:V,sections:U,storyFonts:G}),l===f.nl.EDIT&&!W&&i().createElement(zn,{containerWidth:d,containerHeight:y,buttons:[{glyph:"story-title-section",tooltipId:"geostory.addTitleSection",onClick:function(){v("sections",t,f.ID.TITLE)}},{glyph:"story-banner-section",tooltipId:"geostory.addBannerSection",onClick:function(){v("sections",t,f.ID.BANNER)}},{glyph:"story-paragraph-section",tooltipId:"geostory.addParagraphSection",onClick:function(){v("sections",t,f.ID.PARAGRAPH)}},{glyph:"story-immersive-section",tooltipId:"geostory.addImmersiveSection",onClick:function(){v("sections",t,f.ID.IMMERSIVE)}},{glyph:"story-carousel-section",tooltipId:"geostory.addGeocarouselSection",onClick:function(){v("sections",t,f.ID.CAROUSEL)}},{glyph:"story-media-section",tooltipId:"geostory.addMediaSection",onClick:function(){v("sections",t,f.tQ.MEDIA)}},{glyph:"story-webpage-section",tooltipId:"geostory.addWebPageSection",onClick:function(){v("sections",t,f.tQ.WEBPAGE)}}]}))}));function ci(e){return ci="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ci(e)}function ui(){return ui=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},ui.apply(this,arguments)}function si(e,t,n){return(t=function(e){var t=function(e,t){if("object"!==ci(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!==ci(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===ci(t)?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const fi=(0,xe.compose)(mo,(0,xe.withStateHandlers)({textEditorActive:!1}))((function(e){var t=e.id,n=e.background,r=void 0===n?{}:n,o=e.mode,a=e.contentId,l=e.path,c=e.sectionType,u=void 0===c?f.ID.BANNER:c,s=e.cover,p=e.viewWidth,d=e.viewHeight,y=e.inViewRef,m=e.add,b=void 0===m?function(){}:m,v=e.updateSection,g=void 0===v?function(){}:v,h=e.remove,O=void 0===h?function(){}:h,w=e.updateBackground,S=void 0===w?function(){}:w,E=e.editMedia,j=void 0===E?function(){}:E,P=e.focusedContent,T=e.expandableMedia,C=void 0!==T&&T,k=e.storyTheme,I=e.mediaViewer,D=e.contentToolbar,x=e.inView,M=A()(P,"target.id")===a,R=C&&r&&"map"===r.type?" ms-expandable-background":"",N=l.replace(".background","");return i().createElement("section",{ref:y,className:"ms-section ms-section-banner".concat(R),id:t},i().createElement(De.Z,null,(function(e){var t,n=e.height;return i().createElement(Go,ui({},r,{scrollContainerSelector:"#ms-sections-container",key:r.id,mode:o,id:a,path:l,update:S,add:b,editMedia:j,expandable:C,updateSection:g,cover:s,remove:function(){return O(N)},width:p,sectionType:u,backgroundPlaceholder:{background:"url(".concat(s?Do():ri(),")"),backgroundSize:"".concat(s?64:600,"px auto")},tools:(t={},si(t,f.Tr.IMAGE,["editMedia","cover","fit","size","align","theme","remove"]),si(t,f.Tr.MAP,["editMedia","cover","editMap","size","align","theme","remove"]),si(t,f.Tr.VIDEO,["editMedia","cover","fit","size","align","theme","muted","autoplay","loop","remove"]),t),height:n>=d?d:n,storyTheme:k,mediaViewer:I,contentToolbar:D,inView:x}))})),i().createElement("div",{style:{minHeight:s?d:300,pointerEvents:"none"}}),o===f.nl.EDIT&&!M&&i().createElement(zn,{containerWidth:p,containerHeight:d,buttons:[{glyph:"story-title-section",tooltipId:"geostory.addTitleSection",onClick:function(){b("sections",t,f.ID.TITLE)}},{glyph:"story-banner-section",tooltipId:"geostory.addBannerSection",onClick:function(){b("sections",t,f.ID.BANNER)}},{glyph:"story-paragraph-section",tooltipId:"geostory.addParagraphSection",onClick:function(){b("sections",t,f.ID.PARAGRAPH)}},{glyph:"story-immersive-section",tooltipId:"geostory.addImmersiveSection",onClick:function(){b("sections",t,f.ID.IMMERSIVE)}},{glyph:"story-carousel-section",tooltipId:"geostory.addGeocarouselSection",onClick:function(){b("sections",t,f.ID.CAROUSEL)}},{glyph:"story-media-section",tooltipId:"geostory.addMediaSection",onClick:function(){b("sections",t,f.tQ.MEDIA)}},{glyph:"story-webpage-section",tooltipId:"geostory.addWebPageSection",onClick:function(){b("sections",t,f.tQ.WEBPAGE)}}]}))}));var pi=n(771335),di=n(694745);function yi(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i,a,l=[],c=!0,u=!1;try{if(i=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=i.call(n)).done)&&(l.push(r.value),l.length!==t);c=!0);}catch(e){u=!0,o=e}finally{try{if(!c&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}(e,t)||function(e,t){if(e){if("string"==typeof e)return mi(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?mi(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function mi(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var bi=(0,Xe.Z)("placeholder")(zt.FormControl);const vi=function(e){var t,n,r,a=yi((0,o.useState)([]),2),l=a[0],c=a[1],u=yi((0,o.useState)({data:null==e||null===(t=e.thumbnail)||void 0===t?void 0:t.image}),2),s=u[0],f=u[1],p=yi((0,o.useState)(null==e?void 0:e.title),2),d=p[0],y=p[1];return i().createElement(di.Z,{fitContent:!0,title:i().createElement(Jt.Z,{msgId:e.editing?"geostory.carouselEditTitle":"geostory.carouselAddTitle"}),show:!0,fade:!0,clickOutEnabled:!1,bodyClassName:"ms-flex modal-properties-container background-dialog",onClose:e.onClose,buttons:e.loading?[]:[{text:i().createElement(Jt.Z,{msgId:e.editing?"save":"backgroundDialog.add"}),bsStyle:"primary",onClick:function(){e.update("thumbnail",{image:s.data}),e.update("title",d),e.onClose()}}]},i().createElement(zt.Form,{style:{width:"100%"}},(r={FORMAT:i().createElement(Jt.Z,{msgId:"map.errorFormat"}),SIZE:i().createElement(Jt.Z,{msgId:"map.errorSize"})},l.length>0?i().createElement("div",{className:"dropzone-errorBox alert-danger"},i().createElement("p",null,i().createElement(Jt.Z,{msgId:"map.error"})),l.map((function(e){return i().createElement("div",{id:"error"+e,key:"error"+e,className:"error"+e},r[e])}))):null),i().createElement(pi.Z,{onUpdate:function(e,t){return f({data:e,url:t})},onError:function(e){return c(e)},message:i().createElement(Jt.Z,{msgId:"backgroundDialog.thumbnailMessage"}),suggestion:"",map:{newThumbnail:A()(s,"url")||(null===(n=e.thumbnail)||void 0===n?void 0:n.image)||"NODATA"}}),i().createElement(zt.FormGroup,null,i().createElement(zt.ControlLabel,null,i().createElement(Jt.Z,{msgId:"layerProperties.title"})),i().createElement(bi,{value:d,placeholder:"backgroundDialog.titlePlaceholder",onChange:function(e){return y(e.target.value)}}))))};var gi=n(625311),hi=n(245567),Oi=n(773723),wi=n.n(Oi),Si=n(615402);const Ei=function(e){return t=e.type,n="",r="","addMap"===t?(n="ms-carousel-map-info",r="geostory.carouselAddMapInfo"):"addMarker"===t?(n="ms-carousel-marker-info",r="geostory.carouselPlaceMarkerInfo"):(n="ms-carousel-add-info",r="geostory.carouselAddItemInfo"),i().createElement("div",{className:n},i().createElement(Si.Z,{msgId:r}));var t,n,r};var ji=n(81593);function Pi(e){return Pi="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Pi(e)}var Ti=["title","thumbnail","index","isSelected"],Ci=["onSort","sectionId","contents","onEnableDraw","isEditMap","isDrawEnabled"];function ki(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Ii(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ki(Object(n),!0).forEach((function(t){Ai(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ki(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Ai(e,t,n){return(t=function(e){var t=function(e,t){if("object"!==Pi(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!==Pi(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===Pi(t)?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Di(){return Di=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Di.apply(this,arguments)}function xi(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i,a,l=[],c=!0,u=!1;try{if(i=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=i.call(n)).done)&&(l.push(r.value),l.length!==t);c=!0);}catch(e){u=!0,o=e}finally{try{if(!c&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}(e,t)||function(e,t){if(e){if("string"==typeof e)return Mi(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Mi(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Mi(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Ri(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}var Ni=(0,gi.Z)((function(e){var t=e.title,n=e.thumbnail,r=e.index,o=e.isSelected,a=Ri(e,Ti),l=i().createElement("div",{className:et()("ms-geo-carousel-item",{"ms-geo-carousel-item-selected":o}),onClick:a.onClick},i().createElement("div",{className:"ms-geo-carousel-item-inner-wrapper",style:{backgroundImage:"url(".concat((null==n?void 0:n.image)||wi(),")")}},i().createElement("span",{className:"ms-geo-carousel-item-inner"},t||"Item ".concat(r+1)),i().createElement("span",{className:"ms-geo-carousel-item-inner-index"},r+1)));return a.isDraggable&&a.connectDragSource?a.connectDragSource(l):l})),Li=(0,hi.Z)((function(e){var t=e.mode,n=e.add,r=e.update,a=void 0===r?function(){}:r,l=e.remove,c=e.sectionId,u=e.isMapBackground,s=e.contentId,p=e.items,d=e.contentToolbar,y=void 0===d?Gr:d,m=e.cardComponent,b=e.containerWidth,v=e.isDrawEnabled,g=e.onEnableDraw,h=e.isEditMap,O=e.innerRef,w=e.deltaSwipeSize,S=void 0===w?200:w,E=e.transition,j=void 0===E?300:E,P=e.style,T=e.controlStyle,C=xi((0,o.useState)(!1),2),k=C[0],I=C[1],A=xi((0,o.useState)(void 0),2),D=A[0],x=A[1],M=xi((0,o.useState)(""),2),N=M[0],L=M[1],Z=xi((0,o.useState)({}),2),_=Z[0],F=Z[1],B=(0,ji.Z)({direction:"horizontal",width:b,deltaScroll:S,transition:j},[p.length]),U=B.isStartControlActive,G=B.isEndControlActive,W=B.containerPropsHandlers,z=B.contentPropsHandlers,H=B.itemPropsHandlers,V=B.moveToDeltaSize,q=B.moveItemInViewById,Y=t===f.nl.EDIT;(0,o.useEffect)((function(){s&&q(s,{margin:32})}),[s]);var Q=!(u&&!lr()(p,(function(e){var t;return 0===((null==e||null===(t=e.features)||void 0===t?void 0:t.length)||0)})));return i().createElement(i().Fragment,null,i().createElement("div",{ref:O,style:P,className:"ms-geo-carousel"},Y&&1===p.length&&Q&&!h&&i().createElement(Ei,{type:"addInfo"}),h&&Y&&v&&!!lr()(p,(function(e){var t;return e.id===s&&0===((null==e||null===(t=e.features)||void 0===t?void 0:t.length)||0)}))&&i().createElement(Ei,{type:"addMarker"}),Y&&i().createElement(y,{addDisabled:Q,add:n,editMap:h,remove:function(){return l('sections[{"id":"'.concat(c,'"}]'))},tools:["add","remove"]}),i().createElement("div",Di({},W(),{className:"ms-horizontal-menu"}),i().createElement("div",z(),p.map((function(e,t){var r=H({id:e.id,onClick:h?void 0:function(){a('sections[{"id":"'.concat(c,'"}].contents[{"id":"').concat(e.id,'"}].carouselToggle'),!0)}});return i().createElement("div",Di({key:t},r,{className:"ms-geo-carousel-item-wrapper",style:h?{pointerEvents:"none"}:{}}),Y&&i().createElement(y,{editMap:h,markerDisabled:!u||(null==e?void 0:e.id)!==s,edit:function(t){t.stopPropagation(),function(e){x(null==e?void 0:e.id),I(!0),F(null==e?void 0:e.thumbnail),L(null==e?void 0:e.title)}(e)},remove:function(){var n,r,o,i;return o=null==e?void 0:e.id,i=0===t&&p.length>0?null===(n=p[t+1])||void 0===n?void 0:n.id:null===(r=p[t-1])||void 0===r?void 0:r.id,l('sections[{"id":"'.concat(c,'"}].contents[{"id":"').concat(o,'"}]')),void(s===o&&a('sections[{"id":"'.concat(c,'"}].contents[{"id":"').concat(i,'"}].hideContent'),!1))},forceDelBtnDisable:(null==e?void 0:e.id)===s,add:n,marker:function(t){t.stopPropagation(),g(e)},tools:["edit","remove","marker"]}),i().createElement(m,Di({key:t,index:t,items:p,update:a,sectionId:c,selectedId:s,isSelected:(null==e?void 0:e.id)===s},e)))}))),U&&i().createElement($t.Z,{className:"square-button-md no-border ms-geo-carousel-control",style:Ii(Ii({},T),{},{position:"absolute"}),onClick:function(){return V(S)}},i().createElement(zt.Glyphicon,{glyph:"chevron-left"})),G&&i().createElement($t.Z,{className:"square-button-md no-border ms-geo-carousel-control",style:Ii(Ii({},T),{},{position:"absolute",right:0}),onClick:function(){return V(-S)}},i().createElement(zt.Glyphicon,{glyph:"chevron-right"})))),k&&i().createElement(vi,{title:N,thumbnail:_,update:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:D,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"replace",o=R()(e)?"":".".concat(e);a('sections[{"id":"'.concat(c,'"}].contents[{"id":"').concat(n,'"}]')+o,t,r)},onClose:function(){return I(!1)}}))}));const Zi=function(e){var t=e.onSort,n=e.sectionId,r=e.contents,o=void 0===r?[]:r,a=e.onEnableDraw,l=void 0===a?function(){}:a,c=e.isEditMap,u=e.isDrawEnabled,s=Ri(e,Ci);return i().createElement(Li,Di({containerId:n,isDraggable:s.mode===f.nl.EDIT,onSort:function(e,r,o,i){if(o.containerId===i.containerId){var a='sections[{ "id": "'.concat(n,'" }].contents[{"id":"').concat(i.id,'"}]'),l='sections[{ "id": "'.concat(n,'" }].contents'),c=e,u=Mr()();t(a,l,c,u,'sections[{ "id": "'.concat(n,'" }].contents[{"id":"').concat(u,'"}]'))}}},Ii(Ii({},s),{},{sectionId:n}),{cardComponent:Ni,items:o.map((function(e){var t=e.id,n=e.thumbnail;return{id:t,thumbnail:void 0===n?{}:n,features:e.features,title:e.title}})),isDrawEnabled:u,onEnableDraw:l,isEditMap:c}))};var _i=n(743837),Fi=n(240986);const Bi=function(e){var t=e.currentIndex,n=e.contents,r=void 0===n?[]:n,o=e.onTraverseCard,a=void 0===o?function(){}:o;return i().createElement(i().Fragment,null,i().createElement($t.Z,{className:"ms-carousel-slider left-arrow",disabled:0===t,onClick:function(){return a()}},i().createElement(zt.Glyphicon,{style:{fontSize:22},glyph:"chevron-left"})),i().createElement($t.Z,{className:"ms-carousel-slider right-arrow",onClick:function(){return a("right")},disabled:t===r.length-1},i().createElement(zt.Glyphicon,{style:{fontSize:22},glyph:"chevron-right"})))};function Ui(e){return Ui="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ui(e)}function Gi(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i,a,l=[],c=!0,u=!1;try{if(i=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=i.call(n)).done)&&(l.push(r.value),l.length!==t);c=!0);}catch(e){u=!0,o=e}finally{try{if(!c&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}(e,t)||function(e,t){if(e){if("string"==typeof e)return Wi(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Wi(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Wi(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function zi(){return zi=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},zi.apply(this,arguments)}function Hi(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Vi(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Hi(Object(n),!0).forEach((function(t){qi(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Hi(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function qi(e,t,n){return(t=function(e){var t=function(e,t){if("object"!==Ui(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!==Ui(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===Ui(t)?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const Yi=(0,xe.compose)(bo,(function(e){return function(t){var n=fo(t.contents||[],t.backgroundId)||{},r=n&&n.id,o=uo(uo({},t),{},{contentId:r,sectionId:t.id,path:'sections[{"id": "'.concat(t.id,'"}].background')});return i().createElement(e,o)}}),(function(e){return function(t){var n=uo(uo({},t),{},{updateBackground:function(e){for(var n=arguments.length,r=new Array(n>1?n-1:0),o=1;o<n;o++)r[o-1]=arguments[o];return t.update.apply(t,['sections[{"id": "'.concat(t.sectionId,'"}].background.')+e].concat(r))},updateSection:function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return t.update.apply(t,['sections[{"id": "'.concat(t.sectionId,'"}]')].concat(n))}});return i().createElement(e,n)}}),(function(e){return function(t){var n=Gi((0,o.useState)(""),2),r=n[0],a=n[1];return i().createElement(e,zi({},t,{textEditorActiveClass:r,bubblingTextEditing:function(e){return a(e?" ms-text-editor-active":"")}}))}}))((function(e){var t,n,r,a=e.add,l=void 0===a?function(){}:a,c=e.editMedia,u=void 0===c?function(){}:c,s=e.editWebPage,p=void 0===s?function(){}:s,d=e.onVisibilityChange,y=void 0===d?function(){}:d,m=e.update,b=void 0===m?function(){}:m,v=e.updateBackground,g=void 0===v?function(){}:v,h=e.updateCurrentPage,O=void 0===h?function(){}:h,w=e.remove,S=void 0===w?function(){}:w,E=e.id,j=e.background,P=void 0===j?{}:j,T=e.path,C=e.contents,k=void 0===C?[]:C,I=e.mode,D=e.sectionType,x=e.inViewRef,M=e.viewWidth,R=e.viewHeight,N=e.focusedContent,L=e.contentId,Z=e.bubblingTextEditing,_=void 0===Z?function(){}:Z,F=e.textEditorActiveClass,B=void 0===F?"":F,U=e.expandableMedia,G=void 0!==U&&U,W=e.storyTheme,z=e.mediaViewer,H=e.contentToolbar,V=e.inView,q=e.sections,Y=void 0===q?[]:q,Q=e.storyFonts,X=e.onSort,K=void 0===X?function(){}:X,$=e.onEnableDraw,J=void 0===$?function(){}:$,ee=e.isDrawEnabled,te=e.defaultMarkerStyle,ne=void 0===te?{iconColor:"cyan",iconShape:"circle"}:te,re=e.highlightedMarkerStyle,oe=void 0===re?{iconColor:"green",iconShape:"circle"}:re,ie=(0,o.useRef)(),ae=(0,o.useRef)(),le=(0,o.useRef)();function ce(e,t){return t-(e.left+e.right)<128?{top:0,left:0,bottom:0,right:0}:e}var ue=N&&N.hideContent&&A()(N,"target.id")===E,se=ue?"hidden":"visible",fe=G&&P&&"map"===P.type?" ms-expandable-background":"",pe=Vi(Vi({},null==W?void 0:W.overlay),I===f.nl.VIEW&&{maxHeight:R-350,overflowY:"auto"})||{},de=(null==W?void 0:W.general)||{},ye=R-(I===f.nl.EDIT?220:200),me=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=(lr()(k,{id:L})||{}).contents,n=void 0===t?[]:t;return e.filter((function(e){return f.ID.CAROUSEL===D&&1===n.length?"remove"!==e:e}))},be=(null==P?void 0:P.type)===f.Tr.MAP,ve=(k.find((function(e){return e.id===L}))||{}).features,ge=void 0===ve?[]:ve,he=ro()(k,(function(e){var t=e.id;return L===t})),Oe=(0,f.Yh)({id:E,contents:k.filter((function(e){return e.id!==L})),featureStyle:function(e){var t=e.content,n=e.feature;return(0,f.c0)(ne,k,t,L,n)}}),we=(0,f.Yh)({id:"".concat(E,"-highlighted"),contents:k.filter((function(e){return e.id===L})),featureStyle:function(e){var t=e.content,n=e.feature;return(0,f.c0)(oe,k,t,L,n)}});return i().createElement("section",{className:"ms-section ms-section-carousel".concat(fe),id:E,ref:x},i().createElement(Go,zi({},P,{mode:I,innerRef:ie,disableToolbarPortal:!0,tools:(t={},qi(t,f.Tr.IMAGE,["editMedia","fit","size","align","theme"]),qi(t,f.Tr.MAP,["editMedia","editMap","size","align","theme"].concat(ee?"closeDraw":[])),qi(t,f.Tr.VIDEO,["editMedia","fit","size","align","theme","muted","autoplay","loop"]),t),scrollContainerSelector:"#ms-sections-container",add:l,editMedia:u,expandable:G,path:T,update:g,updateCurrentPage:O,remove:S,sectionType:D,sectionId:E,backgroundId:P.id,key:P.id,width:M,height:R,backgroundPlaceholder:{background:"url(".concat(Vo(),")"),backgroundSize:"600px auto"},storyTheme:de,mediaViewer:z,contentToolbar:H,inView:V,layers:[Oe,we],isDrawEnabled:ee,onEnableDraw:J,contentToolbarChildren:!be&&I===f.nl.EDIT&&i().createElement(Ei,{type:"addMap"})}),i().createElement(_i.Z,{active:ee,features:ge,method:"Point",onChange:function(e,t){b('sections[{"id":"'.concat(E,'"}].contents[{"id":"').concat(L,'"}].features'),t)}}),i().createElement(Fi.Z,{active:!(ee||null!=P&&P.editMap),geometry:null==ge||null===(n=ge[0])||void 0===n||null===(r=n.geometry)||void 0===r?void 0:r.coordinates,padding:function(){var e={top:0,left:0,bottom:0,right:0},t=ie.current&&ie.current.querySelector(".ms-media-map"),n=ae.current&&ae.current.querySelector("[id='".concat(L,"']"));if(t&&n){var r=ie.current.getBoundingClientRect()||{},o=t.getBoundingClientRect()||{},i=n.getBoundingClientRect()||{};if(le.current){var a=le.current.getBoundingClientRect()||{};e.bottom=r.height-(a.top-r.top)}var l=o.left-r.left,c=l+o.width,u=i.left-r.left,s=u+i.width;if(u>=l&&s<=c){var f=u-l,p=c-s;return p>=f?e.left=f+i.width:e.right=p+i.width,ce(e,o.width)}if(s>=l&&s<=c)return e.left=s-l,ce(e,o.width);if(u>=l&&u<=c)return e.right=c-u,ce(e,o.width)}return e}(),fixedZoom:!0,duration:300})),i().createElement(to,{innerRef:ae,tools:qi({},f.bT.COLUMN,["size","align","theme"]),className:"ms-section-contents".concat(B),contents:k,mode:I,add:l,updateCurrentPage:O,editMedia:u,editWebPage:p,update:b,remove:S,sectionId:E,viewWidth:M,viewHeight:R,contentProps:{onVisibilityChange:y,contentWrapperStyle:{minHeight:ye,visibility:se},expandable:G,mediaViewer:z,contentToolbar:H,overrideTools:function(e){return Object.fromEntries(Object.entries(e).map((function(e){var t=Gi(e,2),n=t[0],r=t[1];return[n,me(r)]})))}},focusedContent:N,bubblingTextEditing:_,sectionType:D,storyTheme:pe,sections:Y,storyFonts:Q}),i().createElement(Zi,{innerRef:le,style:null!=W&&W.overlay?Vi({},W.overlay):{},controlStyle:de?Vi({},de):{},sectionId:E,contentId:L,contents:k,update:b,remove:S,expandable:G,add:function(){return e=Vi(Vi({},(0,f.nq)(f.bT.COLUMN)),{},{title:"Item "+(k.length+1),background:{}}),l('sections[{"id": "'.concat(E,'"}].contents'),void 0,e,"geostory.builder.defaults.titleGeocarouselContent"),void b('sections[{"id":"'.concat(E,'"}].contents[{"id":"').concat(L,'"}].hideContent'),!0);var e},contentToolbar:H,mode:I,onSort:K,isMapBackground:be,isEditMap:null==P?void 0:P.editMap,containerWidth:M,isDrawEnabled:ee,onEnableDraw:function(e){b('sections[{"id":"'.concat(E,'"}].background.editMap'),!0,"replace"),J({contentId:e.id,sectionId:E})}}),I===f.nl.VIEW&&!G&&i().createElement(Bi,{currentIndex:he,contents:k,onTraverseCard:function(){var e,t,n;e="left"===(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"left")?null==k||null===(t=k[0===he?0:he-1])||void 0===t?void 0:t.id:null==k||null===(n=k[he===k.length-1?he:he+1])||void 0===n?void 0:n.id,b('sections[{"id":"'.concat(E,'"}].contents[{"id":"').concat(e,'"}].carouselToggle'),!0)}}),I===f.nl.EDIT&&!ue&&i().createElement(zn,{containerWidth:M,containerHeight:R,buttons:[{glyph:"story-title-section",tooltipId:"geostory.addTitleSection",onClick:function(){l("sections",E,f.ID.TITLE)}},{glyph:"story-banner-section",tooltipId:"geostory.addBannerSection",onClick:function(){l("sections",E,f.ID.BANNER)}},{glyph:"story-paragraph-section",tooltipId:"geostory.addParagraphSection",onClick:function(){l("sections",E,f.ID.PARAGRAPH)}},{glyph:"story-immersive-section",tooltipId:"geostory.addImmersiveSection",onClick:function(){return l("sections",E,f.ID.IMMERSIVE)}},{glyph:"story-carousel-section",tooltipId:"geostory.addGeocarouselSection",onClick:function(){l("sections",E,f.ID.CAROUSEL)}},{glyph:"story-media-section",tooltipId:"geostory.addMediaSection",onClick:function(){l("sections",E,f.tQ.MEDIA)}},{glyph:"story-webpage-section",tooltipId:"geostory.addWebPageSection",onClick:function(){l("sections",E,f.tQ.WEBPAGE)}}]}))}));var Qi;function Xi(e){return Xi="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Xi(e)}function Ki(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,na(r.key),r)}}function $i(e,t){return $i=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},$i(e,t)}function Ji(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function ea(e){return ea=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},ea(e)}function ta(e,t,n){return(t=na(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function na(e){var t=function(e,t){if("object"!==Xi(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!==Xi(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===Xi(t)?t:String(t)}var ra=(ta(Qi={},f.ID.IMMERSIVE,Xo),ta(Qi,f.ID.CAROUSEL,Yi),ta(Qi,f.ID.PARAGRAPH,ti),ta(Qi,f.tQ.MEDIA,ti),ta(Qi,f.tQ.WEBPAGE,ti),ta(Qi,f.ID.TITLE,li),ta(Qi,f.ID.BANNER,fi),ta(Qi,"UNKNOWN",(function(e){var t=e.type,n=e.inViewRef;return i().createElement("div",{ref:n,className:"ms-section ms-section-unknown"},"WARNING: unknown session of type ",t)})),Qi),oa=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&$i(e,t)}(l,e);var t,n,r,o,a=(r=l,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=ea(r);if(o){var n=ea(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return function(e,t){if(t&&("object"===Xi(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return Ji(e)}(this,e)});function l(){var e;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,l);for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return ta(Ji(e=a.call.apply(a,[this].concat(n))),"state",{height:0}),e}return t=l,(n=[{key:"render",value:function(){var e=ra[this.props.type]||ra.UNKNOWN;return i().createElement(e,{sectionType:this.props.type,id:this.props.id,add:this.props.add,update:this.props.update,inViewRef:this.props.inViewRef,editMedia:this.props.editMedia,expandableMedia:this.props.expandableMedia,editWebPage:this.props.editWebPage,updateCurrentPage:this.props.updateCurrentPage,remove:this.props.remove,mode:this.props.mode,cover:this.props.cover,contents:this.props.contents,viewWidth:this.props.viewWidth,viewHeight:this.props.viewHeight,focusedContent:this.props.focusedContent,storyTheme:this.props.storyTheme,mediaViewer:this.props.mediaViewer,contentToolbar:this.props.contentToolbar,inView:this.props.inView,sections:this.props.sections,storyFonts:this.props.storyFonts,onSort:this.props.onSort,isDrawEnabled:this.props.isDrawEnabled,background:this.props.background,onEnableDraw:this.props.onEnableDraw,defaultMarkerStyle:this.props.defaultMarkerStyle,highlightedMarkerStyle:this.props.highlightedMarkerStyle})}}])&&Ki(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),l}(i().Component);ta(oa,"propTypes",{id:Qe().string,type:Qe().oneOf(f.lg.SectionTypes),storyType:Qe().oneOf(f.lg.StoryTypes),add:Qe().func,update:Qe().func,editMedia:Qe().func,editWebPage:Qe().func,remove:Qe().func,updateCurrentPage:Qe().func,mode:Qe().oneOf(f.lg.Modes),contents:Qe().array,viewHeight:Qe().number,viewWidth:Qe().number,inViewRef:Qe().func,excludeClassName:Qe().string,cover:Qe().bool,focusedContent:Qe().object,expandableMedia:Qe().bool,storyTheme:Qe().object,mediaViewer:Qe().func,contentToolbar:Qe().func,inView:Qe().bool,sections:Qe().array,storyFonts:Qe().array,onSort:Qe().func,isDrawEnabled:Qe().bool,onEnableDraw:Qe().func,background:Qe().object,defaultMarkerStyle:Qe().object,highlightedMarkerStyle:Qe().object}),ta(oa,"defaultProps",{id:"",add:function(){},update:function(){},editMedia:function(){},editWebPage:function(){},updateCurrentPage:function(){},remove:function(){},onSort:function(){},storyType:f.Ln.CASCADE,viewHeight:0,viewWidth:0,mode:f.nl.VIEW,expandableMedia:!1,sections:[],storyFonts:[],onEnableDraw:function(){}});const ia=rr({threshold:[0,.25,.5,.75,1],rootMargin:"-200px 0px 0px 0px"})(oa);function aa(e){return aa="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},aa(e)}function la(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,pa(r.key),r)}}function ca(e,t){return ca=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},ca(e,t)}function ua(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function sa(e){return sa=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},sa(e)}function fa(e,t,n){return(t=pa(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function pa(e){var t=function(e,t){if("object"!==aa(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!==aa(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===aa(t)?t:String(t)}var da=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&ca(e,t)}(l,e);var t,n,r,o,a=(r=l,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=sa(r);if(o){var n=sa(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return function(e,t){if(t&&("object"===aa(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return ua(e)}(this,e)});function l(){var e;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,l);for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return fa(ua(e=a.call.apply(a,[this].concat(n))),"getAdjustedSelector",(function(){return(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"").replace(/#\d|^#-\d/g,(function(e,t){return t?"#\\"+t[1]+t[2]:"#\\3"+e[1]+" "}))})),fa(ua(e),"getFocusedTarget",(function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:e.props.targets,n=e.props.padding,r=void 0===n?{}:n;return t.map((function(t){var n=t.selector,o=null;try{var i=window.document.querySelector(e.getAdjustedSelector(n));if(i){var a=i.getBoundingClientRect(),l=a.top,c=a.right,u=a.bottom,s=a.left;o={x:s-r,y:l-r,w:c-s+2*r,h:u-l+2*r}}}catch(e){console.warn(e)}finally{return o}})).filter((function(e){return e}))})),fa(ua(e),"getHolePath",(function(t){var n=t.x,r=t.y,o=t.w,i=t.h,a=e.props.borderRadius,l=void 0===a?8:a;return"M ".concat(n," ").concat(r+l," q 0 -").concat(l," ").concat(l," -").concat(l," h ").concat(o-2*l," q ").concat(l," 0 ").concat(l," ").concat(l," v ").concat(i-2*l," q 0 ").concat(l," -").concat(l," ").concat(l," h-").concat(o-2*l," q -").concat(l," 0 -").concat(l," -").concat(l," v-").concat(i-2*l)})),fa(ua(e),"getPath",(function(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e.getFocusedTarget();return"M 0 0 h ".concat(n," v ").concat(t," h -").concat(n," v -").concat(t)+r.map(e.getHolePath).join(" ")})),e}return t=l,(n=[{key:"render",value:function(){var e=this,t=this.props,n=t.onMaskClicked,r=t.stopEventsOnTargets,o=void 0!==r&&r,a=t.targets,l=this.getFocusedTarget(a.filter((function(e){var t=e.stopEventsOnTarget;return o||t})));return i().createElement("div",{style:{position:"fixed",height:"100vh",width:"100vw",top:0,left:0,zIndex:1e6,pointerEvents:"none"}},i().createElement(De.Z,null,(function(t){var r=t.width,o=t.height;return i().createElement("svg",{width:r,height:o,xmlns:"http://www.w3.org/2000/svg"},i().createElement("path",{d:e.getPath(o,r),fill:"rgba(0,0,0,0.7)",fillRule:"evenodd",pointerEvents:"visiblePainted",onClick:n}),l.map((function(t,n){return i().createElement("path",{key:n,d:e.getHolePath(t),fill:"transparent",pointerEvents:"visiblePainted"})})))})))}}])&&la(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),l}(i().Component);function ya(e){return ya="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ya(e)}function ma(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function ba(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ma(Object(n),!0).forEach((function(t){va(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ma(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function va(e,t,n){return(t=function(e){var t=function(e,t){if("object"!==ya(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!==ya(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===ya(t)?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}fa(da,"propTypes",{targets:Qe().arrayOf(Qe().shape({selector:Qe().string,stopEventsOnTarget:Qe().bool})),padding:Qe().number,borderRadius:Qe().number,onMaskClicked:Qe().func,stopEventsOnTargets:Qe().bool}),fa(da,"defaultProps",{targets:[],padding:0,borderRadius:8,onMaskClicked:function(){},stopEventsOnTargets:!1});var ga=(0,Be.Z)((function(e){var t=e.sections;return 0===(void 0===t?[]:t).length}),(function(e){var t=e.add,n=void 0===t?function(){}:t;return{iconFit:!1,style:{position:"relative",width:"50%",top:"50%",left:"50%",transform:"translate(-50%, -50%)"},glyph:"geostory",title:i().createElement(Jt.Z,{msgId:"geostory.emptyTitle"}),description:i().createElement(Jt.Z,{msgId:"geostory.emptyDescription"}),content:i().createElement(zn,{addButtonClassName:"square-button-md",containerWidth:"100%",containerHeight:"100%",buttons:[{glyph:"story-title-section",tooltipId:"geostory.addTitleSection",onClick:function(){n("sections",0,f.ID.TITLE)}},{glyph:"story-banner-section",tooltipId:"geostory.addBannerSection",onClick:function(){n("sections",0,f.ID.BANNER)}},{glyph:"story-paragraph-section",tooltipId:"geostory.addParagraphSection",onClick:function(){n("sections",0,f.ID.PARAGRAPH)}},{glyph:"story-immersive-section",tooltipId:"geostory.addImmersiveContent",onClick:function(){n("sections",0,f.ID.IMMERSIVE)}},{glyph:"story-carousel-section",tooltipId:"geostory.addGeocarouselContent",onClick:function(){n("sections",0,f.ID.CAROUSEL)}},{glyph:"story-media-section",tooltipId:"geostory.addMediaSection",onClick:function(){n("sections",0,f.tQ.MEDIA)}},{glyph:"code",tooltipId:"geostory.addWebPageSection",onClick:function(){n("sections",0,f.tQ.WEBPAGE)}}]})}}))(De.Z),ha=function(e){var t=e.width;return e.mode===f.nl.EDIT?"":t<640?"sm":t>=640&&t<1024?"md":""};const Oa=(0,xe.compose)(Fe,qe,function(e){var t=e.showFocusMask,n=void 0===t?function(){}:t,r=e.defaultTargets,o=void 0===r?{selector:".ms-geostory-map-editor"}:r,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},l=a.padding,c=void 0===l?0:l,u=a.borderRadius,s=void 0===u?8:u,f=a.stopEventsOnTargets,p=void 0!==f&&f,d=a.onMaskClicked,y=void 0===d?function(){}:d;return(0,xe.branch)(n,(function(e){return(0,xe.nest)((function(e){var t=e.focusedContent,n=e.children;return i().createElement(i().Fragment,null,n,i().createElement(da,{targets:[t,o],padding:c,borderRadius:s,stopEventsOnTargets:p,onMaskClicked:y}))}),e)}))}({showFocusMask:function(e){var t=e.focusedContent,n=(void 0===t?{}:t).target;return(void 0===n?{}:n).id}}))((function(e){var t=e.mode,n=void 0===t?f.nl.VIEW:t,r=e.sections,o=void 0===r?[]:r,a=e.add,l=void 0===a?function(){}:a,c=e.onVisibilityChange,u=void 0===c?function(){}:c,s=e.updateCurrentPage,p=void 0===s?function(){}:s,d=e.editMedia,y=void 0===d?function(){}:d,m=e.editWebPage,b=void 0===m?function(){}:m,v=e.update,g=void 0===v?function(){}:v,h=e.remove,O=void 0===h?function(){}:h,w=e.focusedContent,S=e.isContentFocused,E=void 0!==S&&S,j=e.getSize,P=void 0===j?ha:j,T=e.theme,C=void 0===T?{}:T,k=e.mediaViewer,I=e.contentToolbar,A=e.storyFonts,D=e.onSort,x=void 0===D?function(){}:D,M=e.isDrawEnabled,R=void 0!==M&&M,N=e.onEnableDraw,L=void 0===N?function(){}:N,Z=e.defaultMarkerStyle,_=e.highlightedMarkerStyle;return i().createElement(Ae.Z,{className:"ms-cascade-story ms-".concat(n)},i().createElement(ga,{sections:o,add:l},(function(e){var t,r=e.width,a=e.height,c=P({width:r,height:a,mode:n}),s=c?" ms-".concat(c):"",f="sm"===c,d=C&&hr()(C)&&C||{};return i().createElement("div",{id:"ms-sections-container",className:"ms-sections-container".concat(s," ms-sections-hyperlinks"),style:ba(ba({},null==d?void 0:d.general),E&&{overflow:"hidden"})},(null==d||null===(t=d.link)||void 0===t?void 0:t.color)&&i().createElement("style",{dangerouslySetInnerHTML:{__html:"\n            .ms-sections-hyperlinks .ms-text-editor-main a,\n            .ms-sections-hyperlinks .ms-text-wrapper a,\n            .ms-sections-hyperlinks .ms-text-editor-main a:link,\n            .ms-sections-hyperlinks .ms-text-wrapper a:link,\n            .ms-sections-hyperlinks .ms-text-editor-main a:visited,\n            .ms-sections-hyperlinks .ms-text-wrapper a:visited,\n            .ms-sections-hyperlinks .ms-text-editor-main a:active,\n            .ms-sections-hyperlinks .ms-text-wrapper a:active {\n                color: ".concat(d.link.color,";\n                opacity: 1;\n            }\n            .ms-sections-hyperlinks .ms-text-editor-main a:hover,\n            .ms-sections-hyperlinks .ms-text-wrapper a:hover {\n                color: ").concat(d.link.color,";\n                opacity: 0.75;\n            }\n        ")}}),o.map((function(e){var t=e.contents,c=void 0===t?[]:t,s=e.id,m=e.type,v=e.cover,h=e.background;return i().createElement(ia,{focusedContent:w,onVisibilityChange:u,add:l,editMedia:y,expandableMedia:f,editWebPage:b,updateCurrentPage:p,update:g,remove:O,key:s,id:s,viewHeight:a,viewWidth:r,type:m,mode:n,contents:c,cover:v,storyTheme:d,mediaViewer:k,contentToolbar:I,sections:o,storyFonts:A,onSort:x,isDrawEnabled:R,onEnableDraw:L,background:h,defaultMarkerStyle:Z,highlightedMarkerStyle:_})})))})))}));var wa=n(648860),Sa=["id"];function Ea(e){return Ea="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ea(e)}function ja(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Pa(){return Pa=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Pa.apply(this,arguments)}function Ta(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Ca(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ta(Object(n),!0).forEach((function(t){ka(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ta(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function ka(e,t,n){return(t=function(e){var t=function(e,t){if("object"!==Ea(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!==Ea(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===Ea(t)?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Ia=(0,br.Z)(or.Z);const Aa=(0,xe.compose)((0,a.connect)((0,l.P1)(H.jq,H.z7,(function(e,t){return{resources:e,isContentFocused:t}}))),(0,xe.withProps)((function(e){var t=e.resources,n=e.resourceId,r=e.map,o=void 0===r?{}:r,i=Ca(Ca({},o),{},{layers:(o.layers||[]).map((function(e){return e||void 0}))}),a=lr()(t,{id:n})||{};return{map:(0,f.oH)(a.data,i)}})));var Da=(0,xe.compose)((0,a.connect)((0,l.P1)(H.GC,(function(){return{focusedEl:arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}}}))),(0,xe.withProps)((function(e){var t=e.focusedEl,n=void 0===t?{}:t,r=n.resourceId,o=n.map;return{map:o||{},resourceId:r,disableReset:!o}}))),xa=(0,xe.withHandlers)({onChangeMap:function(e){var t=e.update,n=e.focusedContent,r=void 0===n?{}:n;return function(e,n){t("".concat(r.path,".map.").concat(e),n,"merge")}},onChange:function(e){var t=e.update,n=e.focusedContent,r=void 0===n?{}:n;return function(e,n){t(r.path+".".concat(e),n,"merge")}}}),Ma=(0,xe.compose)((0,a.connect)(null,{toggleAdvancedEditing:Q.$Z}),(0,xe.withHandlers)({toggleAdvancedEditing:function(e){var t=e.toggleAdvancedEditing,n=void 0===t?function(){}:t,r=e.map,o=void 0===r?{}:r;return function(){var e=o.id,t=function(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}(o,Sa);n("inlineEditor",{data:t,id:e})}}})),Ra=(0,xe.withHandlers)({toggleEditing:function(e){var t=e.editMap,n=e.update,r=e.focusedContent;return function(){return n(r.path+".editMap",!t)}},onReset:function(e){var t=e.update,n=e.focusedContent,r=(void 0===n?{}:n).path,o=void 0===r?"":r;return function(){t(o+".map",void 0)}}}),Na=function(e){return i().createElement(Ia,Pa({glyph:"repeat",bsStyle:"primary",className:"square-button-md no-border",tooltipId:"geostory.contentToolbar.resetMap",confirmTitle:i().createElement(Jt.Z,{msgId:"geostory.contentToolbar.resetMapConfirm"}),confirmContent:i().createElement(Jt.Z,{msgId:"geostory.contentToolbar.resetConfirmContent"})},e))},La=(0,xe.compose)((0,xe.withProps)((function(e){var t=e.disableReset,n=e.onReset,r=e.toggleAdvancedEditing,o=void 0===r?function(){}:r;return{buttons:[{renderButton:i().createElement(Na,{disabled:t,onClick:n})},{glyph:"pencil",tooltipId:"geostory.contentToolbar.advancedMapEditor",onClick:o}]}})),wa.Z,(0,xe.withStateHandlers)((function(){return{editNode:void 0}}),{setEditNode:function(){return function(e){return{editNode:e}}},closeNodeEditor:function(){return function(){return{editNode:void 0}}}}),(0,xe.branch)((function(e){return!!e.editNode}),(0,xe.withProps)((function(e){var t=e.selectedNodes,n=void 0===t?[]:t,r=e.closeNodeEditor,o=void 0===r?function(){}:r;return{buttons:[{visible:1===n.length,tooltipId:"close",glyph:"1-close",onClick:o}]}})),(0,xe.withProps)((function(e){var t,n=e.selectedNodes,r=void 0===n?[]:n,o=e.setEditNode,i=void 0===o?function(){}:o,a=e.buttons,l=void 0===a?[]:a;return{buttons:[{visible:1===r.length,glyph:"wrench",tooltipId:"toc.toolLayerSettingsTooltip",onClick:function(){i(r[0])}}].concat((t=l,function(e){if(Array.isArray(e))return ja(e)}(t)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(t)||function(e,t){if(e){if("string"==typeof e)return ja(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?ja(e,t):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()))}})))),Za=(0,xe.compose)((0,xe.withPropsOnChange)(["focusedContent"],(function(e){var t=e.map,n=e.focusedEl;return{contentMap:(void 0===n?{}:n).map,lastSavedMap:t}})),(0,xe.withPropsOnChange)(["map"],(function(e){var t=e.map,n=e.lastSavedMap;return{pendingChanges:!fr()(n,t)}}))),_a=(0,xe.compose)((0,xe.withProps)((function(e){var t=e.toggleEditing;return{CloseBtn:function(e){return i().createElement(or.Z,Pa({onClick:t},e))}}}))),Fa=(0,xe.mapPropsStream)((function(e){var t=(0,xe.createEventHandler)(),n=t.stream,r=t.handler;return e.pluck("map").distinctUntilChanged((function(e,t){return fr()(e,t)})).switchMap((function(e){return n.map((function(t){return{map:Ca(Ca({},e),t)}})).startWith({map:e})})).combineLatest(e,(function(){var e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).map;return Ca(Ca({},arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}),{},{onMapViewLocalChanges:r,map:e})}))})),Ba=function(e,t){return void 0!==e&&void 0!==t&&e.toFixed(12)-t.toFixed(12)==0},Ua=(0,xe.withHandlers)({onMapViewChanges:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.update,n=e.editMap,r=void 0!==n&&n,o=e.onMapViewLocalChanges,i=e.map,a=void 0===i?{}:i,l=a.center,c=void 0===l?{}:l,u=a.zoom,s=a.mapStateSource,f=a.resolution,p=a.resetPanAndZoom;return function(e){var n=e.center,i=void 0===n?{}:n,a=e.zoom,l=e.mapStateSource,d=e.resolution,y=Ba(c.x,i.x)&&Ba(c.y,i.y);!r||y&&u===a?p?t("map",{center:c,zoom:u,mapStateSource:s,resolution:f,resetPanAndZoom:!1},"merge"):o({center:i,zoom:a,mapStateSource:l,resolution:d}):t("map",{center:i,zoom:a,mapStateSource:Mr()(),resolution:d,resetPanAndZoom:!1},"merge")}}}),Ga=n(5993),Wa=n(75927),za=n(651768),Ha=n(815135),Va=["tabs","activeTab","width","setActiveTab"];function qa(){return qa=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},qa.apply(this,arguments)}var Ya=(0,Ha.Z)(zt.NavItem);var Qa=n(979105),Xa=n(743129),Ka=n(145869),$a=n(487320),Ja=(0,Xe.Z)(["placeholder","options"])(Xa.ZP);const el=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.map,n=void 0===t?{zoomControl:!0,mapInfoControl:!1}:t,r=e.onChangeMap,o=void 0===r?function(){}:r,a=n&&n.mapOptions||{},l=(0,f.kn)({mapOptions:a,zoomControl:!!j()(n.zoomControl)||n.zoomControl,mapInfoControl:!j()(n.mapInfoControl)&&n.mapInfoControl});return i().createElement(zt.Form,{className:"ms-geostory-map-controls"},i().createElement(zt.FormGroup,null,i().createElement(zt.ControlLabel,null,i().createElement(Jt.Z,{msgId:"geostory.mapEditor.zoom"})),i().createElement(Ka.Z,{onChange:function(){var e=!l.zoomControl;o("zoomControl",e),o("mapOptions.interactions",{doubleClickZoom:e,shiftDragZoom:e,pinchZoom:e})},className:"ms-geostory-map-controls-switch",checked:l.zoomControl}),i().createElement(Ja,{options:[{label:"geostory.mapEditor.topLeft",value:"topLeft"},{label:"geostory.mapEditor.topRight",value:"topRight"},{label:"geostory.mapEditor.bottomLeft",value:"bottomLeft"},{label:"geostory.mapEditor.bottomRight",value:"bottomRight"}],wrapperStyle:{marginTop:"10px"},value:l.mapOptions&&l.mapOptions.zoomPosition||"topLeft",clearable:!1,disabled:!l.zoomControl,onChange:function(e){return o("mapOptions.zoomPosition",e&&e.value?e.value:"topLeft")},placeholder:"geostory.builder.settings.titlePlaceholder"})),i().createElement(zt.FormGroup,null,i().createElement(zt.ControlLabel,null,i().createElement(Jt.Z,{msgId:"geostory.mapEditor.pan"})),i().createElement(Ka.Z,{onChange:function(){var e=!(l.mapOptions&&l.mapOptions.interactions&&l.mapOptions.interactions.dragPan);o("mapOptions.interactions",{dragPan:e,keyboardPan:e})},className:"ms-geostory-map-controls-switch",checked:l.mapOptions&&l.mapOptions.interactions&&l.mapOptions.interactions.dragPan})),i().createElement(zt.FormGroup,null,i().createElement(zt.ControlLabel,null,i().createElement(Jt.Z,{msgId:"geostory.mapEditor.identify"})),i().createElement(Ka.Z,{onChange:function(){var e=!l.mapInfoControl;o("mapInfoControl",e)},className:"ms-geostory-map-controls-switch",checked:l.mapInfoControl}),l.mapInfoControl&&i().createElement($a.Z,{disabled:!l.mapInfoControl,popoverMessage:"geostory.builder.settings.templateTooltip",infoFormat:l.mapOptions&&l.mapOptions.mapInfoFormat||"application/json",onInfoFormatChange:function(e){return o("mapOptions.mapInfoFormat",e)},selectProps:{wrapperStyle:{marginTop:10}}})))};var tl=n(616701),nl=(0,xe.withProps)((function(e){return{tabs:e.tabs||[{id:"toc",titleId:"geostory.mapEditor.toc",tooltipId:"geostory.mapEditor.toc",glyph:"1-layer",visible:!0,Component:tl.Z},{id:"settings",titleId:"geostory.mapEditor.settings",tooltipId:"geostory.mapEditor.settings",glyph:"wrench",visible:!0,Component:el}]}}));const rl=(0,xe.compose)((0,Qa.Z)("activeTab","setActiveTab","toc"),nl);var ol=(0,xe.compose)(za.Z,(0,xe.withProps)((function(e){var t=e.selectedNode;return{title:t&&t.title}})),(0,Ga.Z)("title"))((function(e){var t=e.title,n=e.description;return i().createElement("div",{className:"text-center"},i().createElement("div",{className:"mapstore-step-title"},t),i().createElement("div",{className:"mapstore-step-description"},n))})),il=(0,za.Z)(Wa.Z),al=rl((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.tabs,n=void 0===t?[]:t,r=e.activeTab,o=(e.width,e.setActiveTab),a=void 0===o?function(){}:o,l=function(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}(e,Va);return i().createElement("div",{key:"ms-geostory-map-settings-navbar",className:"ms-row-tab"},i().createElement("div",null,i().createElement(zt.Nav,{bsStyle:"tabs",activeKey:r,justified:!0},n.map((function(e){return i().createElement(Ya,{key:"ms-tab-settings-"+e.id,tooltipId:e.tooltipId,eventKey:e.id,onClick:function(){return a(e.id)}},i().createElement(zt.Glyphicon,{glyph:e.glyph}))})))),i().createElement("div",null,n.filter((function(e){return e.id&&e.id===r})).filter((function(e){return e.Component})).map((function(e){return i().createElement(e.Component,qa({},l,{key:"ms-geostory-tab-settings-body-"+e.id}))}))))}));const ll=(0,xe.branch)((function(e){var t=e.focusedContent;return(void 0===t?{}:t).path}),(0,xe.compose)((0,xe.defaultProps)({isFocused:!0,editMap:!0}),Da,Aa,Za,xa,Ra,Ma,La,_a))((function(e){var t=e.mode,n=void 0===t?f.nl.VIEW:t,r=e.isFocused,o=void 0!==r&&r,a=e.map,l=void 0===a?{}:a,c=e.onChange,u=void 0===c?function(){}:c,s=e.onChangeMap,p=void 0===s?function(){}:s,d=e.onNodeSelect,y=void 0===d?function(){}:d,m=e.selectedNodes,b=e.buttons,v=void 0===b?[]:b,g=e.editNode,h=e.closeNodeEditor,O=e.CloseBtn,w=void 0===O?function(){return null}:O,S=e.isDrawEnabled;return n===f.nl.EDIT&&o?i().createElement("div",{key:"left-column",style:{order:-1,width:400,position:"relative"}},!S&&i().createElement(Ae.Z,{className:"ms-geostory-map-editor",header:i().createElement("div",{className:"ms-geostory-map-editor-header text-center"},i().createElement(zt.Row,null,i().createElement(zt.Col,{md:12,className:"text-center",style:{overflow:"hidden",lineHeight:"52px"}},i().createElement(w,{glyph:"1-close",className:"pull-left on-close-btn square-button no-border ",tooltipId:"geostory.contentToolbar.closeMapEditing"}),i().createElement("div",{className:"mapstore-step-title"},i().createElement(Jt.Z,{msgId:"geostory.mapEditor.configureMapOptions"})))),i().createElement(Mn.Z,{transitionProps:!1,btnGroupProps:{className:"ms-geostory-map-editor-toolbar"},btnDefaultProps:{className:"square-button-md no-border",bsStyle:"primary",noTooltipWhenDisabled:!0},buttons:v}))},!!g&&[i().createElement(ol,{map:l,editNode:g}),i().createElement(il,{closeNodeEditor:h,editNode:g,map:l,onChange:u})]||[i().createElement(al,{map:l,onChange:u,onChangeMap:p,selectedNodes:m,onSelect:y})])):null}));var cl=n(264721),ul=n.n(cl),sl=n(916788),fl=n(437034),pl=n(452826),dl=n(624262);function yl(e){return yl="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},yl(e)}function ml(){return ml=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},ml.apply(this,arguments)}function bl(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function vl(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?bl(Object(n),!0).forEach((function(t){gl(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):bl(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function gl(e,t,n){return(t=function(e){var t=function(e,t){if("object"!==yl(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!==yl(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===yl(t)?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const hl=function(e){var t=function(){return i().createElement("div",{className:"ms-media-error"},i().createElement(zt.Glyphicon,{glyph:"exclamation-sign"}))},n=function(e){var t=e.style,n=void 0===t?{}:t;return i().createElement("div",{style:n,className:"ms-media-loader"},i().createElement(bn.Z,{size:52}))};return function(r){var o={},a=r.sectionType;if((a===f.ID.PARAGRAPH||a===f.ID.IMMERSIVE||a===f.ID.CAROUSEL)&&r.type===f.Tr.IMAGE){var l=((null==r?void 0:r.imgHeight)||9)/((null==r?void 0:r.imgWidth)||16)*100;o={paddingTop:"".concat(l,"%")}}return r.lazy?i().createElement(mn,{key:r.loadingId,id:r.loadingId,debounceTime:r.debounceTime,loading:r.isLoading,onLoad:function(e){return r.onLoad(vl(vl({},r.loading),{},gl({},e,!1)))},loaderComponent:n,loaderStyle:o},i().createElement(e,ml({},r,{type:r.type,loaderComponent:n,loaderStyle:o,errorComponent:t}))):i().createElement(e,ml({},r,{key:r.id,type:r.mediaType||r.type,loaderComponent:n,errorComponent:t}))}};var Ol=n(507848),wl=n(819983),Sl=n(323010),El=["autoplay"],jl=["type"];function Pl(e){return Pl="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Pl(e)}function Tl(){return Tl=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Tl.apply(this,arguments)}function Cl(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}function kl(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Il(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?kl(Object(n),!0).forEach((function(t){Al(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):kl(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Al(e,t,n){return(t=function(e){var t=function(e,t){if("object"!==Pl(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!==Pl(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===Pl(t)?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Dl=(0,xe.branch)((function(e){return e.resourceId}),(0,xe.compose)((0,a.connect)((0,l.P1)(H.jq,(function(e){return{resources:e}}))),(0,xe.withProps)((function(e){var t=e.resources,n=e.resourceId;return(lr()(t,{id:n})||{}).data}))),(0,Be.Z)((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.src,n=void 0===t?"":t,r=e.sectionType;return!n&&r!==f.ID.TITLE&&!ul()([f.ID.IMMERSIVE,f.ID.CAROUSEL],r)}),(function(){return{glyph:"picture"}})))(hl(sl.Z)),xl=(0,xe.compose)((0,xe.branch)((function(e){return e.resourceId}),Aa),(0,xe.withProps)((function(e){var t=e.map,n=void 0===t?{}:t;return{map:Il(Il({},n),{},{layers:n.layers&&n.layers.map((function(e){if(e.tileMatrixSet&&n.sources){var t=(0,dl.gv)(n.sources,e);return Il(Il({},e),t)}return e}))})}})),Ol.Z,wl.Z,Fa,Ua,Sl.dV)(hl(fl.Z)),Ml={image:Dl,map:xl,video:(0,xe.branch)((function(e){return e.resourceId}),(0,xe.compose)((0,a.connect)((0,l.P1)(H.jq,(function(e){return{resources:e}}))),(0,xe.withProps)((function(e){var t=e.resources,n=e.resourceId,r=e.autoplay,o=(lr()(t,{id:n})||{}).data||{},i=o.autoplay;return Il(Il({},Cl(o,El)),{},{autoplay:void 0!==r?r:i})}))),(0,Be.Z)((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.src,n=void 0===t?"":t,r=e.sectionType;return!n&&r!==f.ID.TITLE&&!ul()([f.ID.IMMERSIVE,f.ID.CAROUSEL],r)}),(function(){return{glyph:"play"}})))(hl(pl.Z))};const Rl=function(e){var t=e.type,n=Cl(e,jl),r=Ml[t];return r?i().createElement(r,Tl({type:t},n)):null};var Nl=["resources"];function Ll(){return Ll=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Ll.apply(this,arguments)}const Zl=(0,a.connect)((0,l.P1)(H.jq,(function(e){return{resources:e}})))((function(e){var t=e.resources,n=function(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}(e,Nl);if(n.resourceId){var r=(lr()(t,{id:n.resourceId})||{}).data||{};return i().createElement(Gr,Ll({},r,n))}return i().createElement(Gr,n)}));var _l=["story","mode","onAdd","messages","fontFamilies","storyFonts","webFont","onUpdate","onBasicError","onUpdateMediaEditorSetting","mediaEditorSettings"];function Fl(){return Fl=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Fl.apply(this,arguments)}var Bl=function(e){var t=e.story,n=e.mode,r=void 0===n?f.nl.VIEW:n,a=e.onAdd,l=e.messages,c=e.fontFamilies,s=void 0===c?[]:c,d=e.storyFonts,y=void 0===d?[]:d,m=e.webFont,b=void 0===m?u():m,v=e.onUpdate,g=void 0===v?function(){}:v,h=e.onBasicError,O=void 0===h?function(){}:h,w=e.onUpdateMediaEditorSetting,S=e.mediaEditorSettings,E=function(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}(e,_l),j=(0,o.useCallback)((function(e){return(0,p.S$)(l,e)}),[l]),P=function(e,t,n,r){return a(e,t,n,r?j(r):j)};return(0,o.useEffect)((function(){window.__geostory_interaction=function(e,t){"scrollTo"===e&&(0,f.M1)(t,{behavior:"smooth"})}}),[]),(0,o.useEffect)((function(){g("settings.theme.fontFamilies",s,"merge"),S&&w(S)}),[]),(0,o.useEffect)((function(){y.length>0&&y.filter((function(e){var t=e.src;return t&&!document.head.querySelector("link[href='".concat(t,"']"))})).length>0&&b.load((0,f.bm)(y,(function(){}),(function(){return O({message:"geostory.builder.settings.webFontLoadError"})})))}),[y]),i().createElement(Ae.Z,{className:"ms-geostory",columns:[i().createElement(ll,Fl({},E,{add:P,update:g,mode:r}))]},i().createElement(Oa,Fl({},t,E,{storyFonts:(0,f._R)(y),add:P,update:g,mode:r,mediaViewer:Rl,contentToolbar:Zl})))};Bl.defaultProps={storyFonts:[],fontFamilies:[],onUpdateMediaEditorSetting:function(){}};const Ul=(0,s.rx)("GeoStory",{component:(0,a.connect)((0,l.zB)({mode:H.eK,story:H.Kg,messages:ke.Ps,focusedContent:H.FW,isContentFocused:H.z7,theme:function(e){var t;return(null===(t=(0,H.TQ)(e))||void 0===t?void 0:t.theme)||{}},storyFonts:H.mm,isDrawEnabled:H.HB}),{onAdd:y.IH,onUpdate:y.Vx,updateCurrentPage:y.RZ,onUpdateSetting:y.m7,remove:y.Od,onSort:y.pB,editMedia:m.Ql,editWebPage:y.o2,onBasicError:d.d,onUpdateMediaEditorSetting:y.Fu,onEnableDraw:y.EE})(Bl),reducers:{geostory:Ie.Z},epics:r})},107501:(e,t,n)=>{"use strict";n.d(t,{hp:()=>d,cM:()=>y,Qi:()=>m,TU:()=>b,IQ:()=>v,hb:()=>g,HL:()=>h,dq:()=>O,Iy:()=>w,Qd:()=>S,ER:()=>E,Gi:()=>j,mA:()=>P,jR:()=>T,mD:()=>C,XG:()=>k,B6:()=>I,f5:()=>A,gW:()=>D});var r=n(227361),o=n.n(r),i=n(313311),a=n.n(i),l=n(22222),c=n(624262);function u(e){return u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},u(e)}function s(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function f(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?s(Object(n),!0).forEach((function(t){p(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):s(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function p(e,t,n){return(t=function(e){var t=function(e,t){if("object"!==u(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!==u(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===u(t)?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var d=function(e){return o()(e,"mediaEditor.open")},y=function(e){return o()(e,"mediaEditor.saveState.editing",!1)},m=function(e){return o()(e,"mediaEditor.saveState.addingMedia",!1)},b=function(e){return o()(e,"mediaEditor.saveState")},v=function(e){return o()(e,"mediaEditor.settings.sourceId")},g=function(e){return o()(e,"mediaEditor.settings.mediaType")},h=function(e){return o()(e,"mediaEditor.settings.sources")},O=function(e){return o()(h(e),v(e),{})},w=function(e){return function(e){return o()(function(e){return o()(e,"mediaEditor.settings.mediaTypes")}(e),"".concat(g(e),".sources"),[])}(e).map((function(t){return{id:t,name:(n=t,function(e){return o()(h(e),"".concat(n),{})})(e).name};var n}))},S=function(e){return o()(e,'mediaEditor.data["'.concat(g(e),'"]["').concat(v(e),'"].resultData'))},E=function(e){return o()(e,'mediaEditor.data["'.concat(g(e),'"]["').concat(v(e),'"].params'))},j=function(e){return o()(S(e),"resources")},P=function(e){return o()(S(e),"totalCount")},T=function(e){return o()(e,"mediaEditor.selected")},C=function(e){return o()(e,"mediaEditor.loadingSelected")},k=function(e){return o()(e,"mediaEditor.loadingList")},I=(0,l.P1)(j,T,(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0,n=a()(e,{id:t});return n&&"map"===n.type&&n.data.layers?f(f({},n),{},{data:f(f({},n.data),{},{layers:n.data.layers.map((function(e){if(e.tileMatrixSet&&n.data.sources){var t=(0,c.gv)(n.data.sources,e);return f(f({},e),t)}return e}))})}):n})),A=function(e){return o()(e,"mediaEditor.disabledMediaType",[])},D=function(e){return A(e).length&&!I(e)&&"map"===g(e)}},902870:(e,t,n)=>{"use strict";n.d(t,{Qo:()=>d,jg:()=>y,oH:()=>m});var r=n(227361),o=n.n(r),i=n(453005),a=n(986267),l=n(552259);function c(e){return c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},c(e)}function u(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function s(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?u(Object(n),!0).forEach((function(t){f(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):u(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function f(e,t,n){return(t=function(e){var t=function(e,t){if("object"!==c(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!==c(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===c(t)?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function p(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var d=function(e,t){var n=e.format,r=e.queryParams,o=void 0===r?{}:r;return o.info_format||o.outputFormat||n&&i.O7[n]||t.format},y=function(e){return!!o()(e,"layer.search.url")},m=function(e,t){var n,r,i,c=o()(e,"latlng.lng"),u=o()(e,"latlng.lat"),f=(0,a.reproject)([c,u],"EPSG:4326",t),d=(0,l.getHook)(l.GET_PIXEL_FROM_COORDINATES_HOOK);if(d){var y=(r=d([f.x,f.y]),i=2,function(e){if(Array.isArray(e))return e}(r)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i,a,l=[],c=!0,u=!1;try{if(i=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=i.call(n)).done)&&(l.push(r.value),l.length!==t);c=!0);}catch(e){u=!0,o=e}finally{try{if(!c&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}(r,i)||function(e,t){if(e){if("string"==typeof e)return p(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?p(e,t):void 0}}(r,i)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}());n={x:y[0],y:y[1]}}else n=e.pixel;var m=(0,l.getHook)(l.GET_COORDINATES_FROM_PIXEL_HOOK),b=(0,a.calculateCircleRadiusFromPixel)(m,n,f,5),v={type:"geometry",enabled:!0,value:{geometry:{center:[f.x,f.y],coordinates:(0,a.calculateCircleCoordinates)(f,b,12),extent:[f.x-b,f.y-b,f.x+b,f.y+b],projection:t,radius:b,type:"Polygon"},method:"Circle",operation:"INTERSECTS"}};return s(s({},e),{},{pixel:n,geometricFilter:v})}},510284:(e,t,n)=>{"use strict";n.d(t,{sw:()=>b,oB:()=>v});var r=n(49977),o=n.n(r),i=n(227361),a=n.n(i),l=n(505055),c=n(507526);function u(e){return u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},u(e)}function s(e){var t="function"==typeof Map?new Map:void 0;return s=function(e){if(null===e||(n=e,-1===Function.toString.call(n).indexOf("[native code]")))return e;var n;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==t){if(t.has(e))return t.get(e);t.set(e,r)}function r(){return f(e,arguments,y(this).constructor)}return r.prototype=Object.create(e.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),d(r,e)},s(e)}function f(e,t,n){return f=p()?Reflect.construct.bind():function(e,t,n){var r=[null];r.push.apply(r,t);var o=new(Function.bind.apply(e,r));return n&&d(o,n.prototype),o},f.apply(null,arguments)}function p(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function d(e,t){return d=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},d(e,t)}function y(e){return y=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},y(e)}n(324384);var m=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&d(e,t)}(i,e);var t,n,r,o=(n=i,r=p(),function(){var e,t=y(n);if(r){var o=y(this).constructor;e=Reflect.construct(t,arguments,o)}else e=t.apply(this,arguments);return function(e,t){if(t&&("object"===u(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,e)});function i(e,t){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(n=o.call(this,e)).name="OGCError",n.code=t,n}return t=i,Object.defineProperty(t,"prototype",{writable:!1}),t}(s(Error)),b=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{tagNameProcessors:[c.stripPrefix],explicitArray:!1,mergeAttrs:!0};return o().Observable.bindNodeCallback((function(e,n){return(0,l.parseString)(e,t,n)}))(e)},v=function(e){return e.switchMap((function(e){return"string"==typeof e.data&&e.data.indexOf("ExceptionReport")>0?o().Observable.bindNodeCallback((function(e,t){return(0,l.parseString)(e,{tagNameProcessors:[c.stripPrefix],explicitArray:!1,mergeAttrs:!0},t)}))(e.data).map((function(e){var t=a()(e,"ExceptionReport.Exception.ExceptionText");throw new m(t||"Undefined OGC Service Error",a()(e,"ExceptionReport.Exception.exceptionCode"))})):o().Observable.of(e)}))}},683255:(e,t,n)=>{e.exports=n.p+"grid.svg"},911636:(e,t,n)=>{e.exports=n.p+"world.svg"},773723:(e,t,n)=>{e.exports=n.p+"MapStore2/web/client/components/geostory/contents/carousel/img/default.jpg"},875492:(e,t,n)=>{e.exports=n.p+"MapStore2/web/client/components/geostory/layouts/sections/patterns/dots.png"},51205:e=>{e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACkAAAApCAYAAACoYAD2AAAC5ElEQVRYw+2YW4/TMBCF45S0S1luXZCABy5CgLQgwf//S4BYBLTdJLax0fFqmB07nnQfEGqkIydpVH85M+NLjPe++dcPc4Q8Qh4hj5D/AaQJx6H/4TMwB0PeBNwU7EGQAmAtsNfAzoZkgIa0ZgLMa4Aj6CxIAsjhjOCoL5z7Glg1JAOkaicgvQBXuncwJAWjksLtBTWZe04CnYRktUGdilALppZBOgHGZcBzL6OClABvMSVIzyBjazOgrvACf1ydC5mguqAVg6RhdkSWQFj2uxfaq/BrIZOLEWgZdALIDvcMcZLD8ZbLC9de4yR1sYMi4G20S4Q/PWeJYxTOZn5zJXANZHIxAd4JWhPIloTJZhzMQduM89WQ3MUVAE/RnhAXpTycqys3NZALOBbB7kFrgLesQl2h45Fcj8L1tTSohUwuxhy8H/Qg6K7gIs+3kkaigQCOcyEXCHN07wyQazhrmIulvKMQAwMcmLNqyCVyMAI+BuxSMeTk3OPikLY2J1uE+VHQk6ANrhds+tNARqBeaGc72cK550FP4WhXmFmcMGhTwAR1ifOe3EvPqIegFmF+C8gVy0OfAaWQPMR7gF1OQKqGoBjq90HPMP01BUjPOqGFksC4emE48tWQAH0YmvOgF3DST6xieJgHAWxPAHMuNhrImIdvoNOKNWIOcE+UXE0pYAnkX6uhWsgVXDxHdTfCmrEEmMB2zMFimLVOtiiajxiGWrbU52EeCdyOwPEQD8LqyPH9Ti2kgYMf4OhSKB7qYILbBv3CuVTJ11Y80oaseiMWOONc/Y7kJYe0xL2f0BaiFTxknHO5HaMGMublKwxFGzYdWsBF174H/QDknhTHmHHN39iWFnkZx8lPyM8WHfYELmlLKtgWNmFNzQcC1b47gJ4hL19i7o65dhH0Negbca8vONZoP7doIeOC9zXm8RjuL0Gf4d4OYaU5ljo3GYiqzrWQHfJxA6ALhDpVKv9qYeZA8eM3EhfPSCmpuD0AAAAASUVORK5CYII="},438097:e=>{e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAXCAYAAABqBU3hAAABIUlEQVRIS+3UsYoCMRDG8f8q+EBid5WNnc019la2Vr6Ala1g4SvY+RTXiVdcJQgHV9jJIdhKZCNx2GwyibCNW4bd+X47k6Sg4adoOJ83wNcBsz4CvoGfF4zpEzgCO1mrCmDWpsAC+Af6wD4DMQGWwBUYAF9uLQlww1vli+cMhA1vl7UuEuECqsItNgUhw22tJ4QLGANrwP657LoG4Qt3EV3g4ALMfLZAp2beMYhQuCn/B/SAk9wDQ2CTgYgN/wB+jaTqFKQi1OE+gFnXIpLC6wAaxAqYAfaoVW0hM/NH2+vuAflxTCdCd5Q3PNQBWzgHURseC4gdh+xEMFwD0CKiwrWAWER0eAoghFCFpwJ8CHV4DkAiksJzARYxL2/O+92ufW42SVMYbhcsEwAAAABJRU5ErkJgggAA"}}]);